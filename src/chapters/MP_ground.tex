%======================================================================
%   Zak Webb
%   Ph. D. Thesis
%   Department of Physics and Astronomy
%   University of Waterloo
% 
%   Ground energy of multi-particle quantum walk
%======================================================================


\documentclass[../thesis-main/thesis-main]{subfiles}
\begin{document}

\chapter{Ground energy of multi-particle quantum walk}
\label{chap:MP_ground}


%\section{Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

With our proof that the ground state problem for a single-particle quantum walk is \QMA-complete, we would now like to examine the corresponding problem for the multi-particle quantum walk.  The similarities between the two systems make us expect that very similar results will hold for the multi-particle case, but we will again need to examine the problem in a lot of detail.

In particular, the \QMA-completeness for the single particle walk was relatively straightforward, in that there is really only one particle to deal with.  Because of this, we understand the dynamics and can exactly analyze the system on which things interact, leading to exact solutions for the energies of the resulting Hamiltonian.  With the MPQW, a full analysis is currently beyond our knowledge, and our universality construction relied on a reduction to the cases with at most two interacting particles.  In order to show that finding the ground energy of a MPQW is \QMA-complete using our techniques, we'd need to again reduce to the case of a small number of particles.

To make this reduction, we will show that the problem is \QMA-hard when restricted to the problem where the interaction term adds (almost) no energy to the ground state, so that the ground state is contained within the span of single-particle states that don't overlap.  With this restriction, we will still have correlations between many particles, but we will be able to analyze the correlations and determine the corresponding ground energy.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{MPQW Hamiltonian ground-energy problem}

In order to make things precise, we will fix a particular finite-range interaction, and show that with this fixed interaction, the resulting question is \QMA-complete to solve.  In particular let $\mathcal{U}$ be an interaction with finite support and no negative coefficients.  For a particular graph $G$, we can then define a Hamiltonian on such a graph as
\todo{find a correct way to define $\mathcal{U}$}
\begin{equation}
H_{f,G} = \sum_{(i,j)\in E(G)} a_ia_j + a_j a_i + \sum_{i,j\in V(G)} U_{d(i,j)}(n_i,n_j) = H_{G,\text{move}} + H_{G,\text{int}}.
\end{equation}
Note that because of the positivity restrictions placed on $\mathcal{U}$, we have that $H_{G,\text{int}}$ is positive semi-definite, and thus the ground energy of $H_{f,G}$ is at least the ground energy of $H_{G,\text{move}}$.

With this particular interaction, we can then construct the corresponding problem. 

Note that these Hamiltonians actually act on an infinite dimensional Hilbert space, in that the number of particles is unbounded.  In order to reduce the complexity of these problems to a reasonable amount, we restrict our attention to a particular number of particles.  Once again, as each term in the Hamiltonian preserves the number of particles, we have that $H_{\mathcal{U},G}$ decomposes into blocks with a particular particle number, and we represent these blocks as $\overline{H}_{\mathcal{U},G}^N$.  

\begin{problem}[$\mathcal{U}$-interaction MPQW Hamiltonion]
  Given as input a $K$-vertex graph $G$, a number of particles $N$, a real number $c$, and a precision parameter $\epsilon = 1/T$, where the positive integers $N$ and $T$ are given in unary, and the graph $G$ is given as its adjacency matrix (a $K\times K$ symmetric $0$-$1$ matrix), the $\mathcal{U}$-interaction MPQW Hamiltonian problem is to determine whether the smallest eigenvalue of $\overline{H}_{\mathcal{U},G}^N$ is at most $c$ or is at least $c+\epsilon$, with a promise that one of these two cases hold.
\end{problem}


%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{MPQW Hamiltonian is contained in \QMA}
\label{sec:containment_in_QMA}

To prove that $\mathcal{U}$-interaction MPQW Hamiltonian problem is contained in \QMA, we provide a verification algorithm satisfying the requirements of \defn{QMA}. In the Definition this algorithm is specified by a circuit involving only one measurement of the output qubit at the end of the computation. The procedure we describe below, which contains intermediate measurements in the computational basis, can be converted into a verification circuit of the desired form by standard techniques.

We are given an instance specified by $G$, $N$, $c$, and $\epsilon$. We are also given an input state $|\phi\rangle$ of $n_{\text{input}}$ qubits, where $n_{\text{input}}=\lceil \log_{2}D_{N}\rceil $ and $D_{N}$ is the dimension of $\mathcal{Z}_{N}(G)$ as given in equation \eq{DN}. Note, using the inequality $\binom{a}{b} \leq a^{b}$ in equation \eq{DN}, that $n_{\text{input}}=\mathcal{O}(K\log\left(N+K\right))$, where $K=|V|$ is the number of vertices in the graph $G$. We embed $\mathcal{Z}_{N}(G)$ into the space of $n_{\text{input}}$ qubits straightforwardly as the subspace spanned by the first $D_{N}$ standard basis vectors (with lexicographic ordering, say). The first step of the verification procedure is to measure the projector onto this space $\mathcal{Z}_{N}(G)$. If the measurement outcome is $1$ then the resulting state $|\phi^{\prime}\rangle$ is in $\mathcal{Z}_{N}(G)$ and we continue; otherwise we reject.

In the second step of the verification procedure, the goal is to measure $\bar{H}_{G}^{N}$ in the state $|\phi^{\prime}\rangle$. The Hamiltonian $\bar{H}_{G}^{N}$ is sparse and efficiently row-computable, with norm
\begin{equation}
\left\Vert \bar{H}_{G}^{N}\right\Vert \leq\left\Vert H_{G}^{N}\right\Vert \leq N\left\Vert A(G)\right\Vert +\left\Vert \sum_{k\in V}\hat{n}_{k}\left(\hat{n}_{k}-1\right)\right\Vert \leq NK+N^{2}.
\end{equation}
We use phase estimation (see for example \cite{CEMM98}) to estimate the energy of $|\phi^{\prime}\rangle$, using sparse Hamiltonian simulation \cite{AT03} to approximate evolution according to $\bar{H}_{G}^{N}$. We choose the parameters of the phase estimation so that, with probability at least $\frac{2}{3}$, it produces an approximation $E$ of the energy with error at most $\frac{\epsilon}{4}$. This can be done in time $\poly(N,K,\frac{1}{\epsilon})$. If $E\leq c+\frac{\epsilon}{2}$ then we accept; otherwise we reject.

We now show that this verification procedure satisfies the completeness and soundness requirements of \defn{QMA}. For a yes instance, an eigenvector of $\bar{H}_{G}^{N}$ with eigenvalue $e\leq c$ is accepted by this procedure as long as the energy $E$ computed in the phase estimation step has the desired precision. To see this, note that we measure $\left|E-e\right|\leq\frac{\epsilon}{4}$, and hence $E\leq c+\frac{\epsilon}{4}$, with probability at least $\frac{2}{3}$.  For a no instance, write $|\phi^{\prime}\rangle\in\mathcal{Z}_{N}(G)$ for a state obtained after passing the first step. The value $E$ computed by the subsequent phase estimation step satisfies $E\geq c+\frac{3\epsilon}{4}$ with probability at least $\frac{2}{3}$, in which case the state is rejected. From this we see that the probability of accepting a no instance is at most $\frac{1}{3}$.



%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Frustration-free}


While showing that this problem is contained in \QMA is relatively easy, in our proof of \QMA-hardness we will want to impose additional structure on the problem.  In particular, we will want the problem to have the extra promise that if the particular instance is a yes instance, then the interaction term will essentially add no energy to the ground state.  In particular, we will want the ground state of the system to be a ground state for each term in the Hamilonian individually, which is usually a statement that the Hamiltonian is frustration-free.

The reason that this helps us is that it actually allows us to determine the actual ground energies of various Hamiltonians, and lets us convert the problem to one of adding positive semi-definite matrices.  This allows us to use our Nullspace Projection Lemma (\lem{NPL}), and give strong bounds on the resulting eigenvalue gaps.  Additionally, the guarantee that certain Hamilonians are frustration-free will allow us to give some additional results on various spin systems.



\todo{does this work for both bosons and fermions?.  I think it will, but I'm not sure.  It might not be worth it to discuss fermions right now.}

With all of this, let $G$ be a graph, and let us assume that the interaction is $\mathcal{U}$.  If we then restrict to the $N$-particle sector, we have that the Hamiltonian is given by
\begin{align}
  H_{\mathcal{U},G}^N &= \sum_{(i,j) \in E(G)} (a_i^\dag a_j + a_j^\dag a_i) + \sum_{i,j\in V(G)} \mathcal{U}_{d(i,j)}(n_i,n_j)\\
    &= \sum_{w=1}^N A(G)^{(w)} + \sum_{i,j\in V(G)} \mathcal{U}_{d(i,j)} (\hat{n}_i,\hat{n}_j)\label{eq:MPQW_Hamiltonian}
\end{align}
where
\begin{equation}
  \hat{n}_i = \sum_{w=1}^N \ketbra{i}{i}^{(w)}.
\end{equation}
Additionally, we will again assume that 
\begin{equation}
  H_{G,\text{move}}^N = \sum_{w=1}^N A(G)^{(w)}
  \label{eq:MPQW_Hamiltonian_move}
\end{equation}
is the movement term of the Hamiltonian, and that
\begin{equation}
  H_{\mathcal{U},G,\text{int}}^{N} =  \sum_{i,j\in V(G)} \mathcal{U}_{d(i,j)} (\hat{n}_i,\hat{n}_j)
  \label{eq:MPQW_Hamiltonian_int}
\end{equation}
is the interaction term of the Hamiltonian.


While $H_{\mathcal{U},G}^N$ acts on the entire $|V|^N$ dimensional system of distinguishable particles, we want to deal with indistinguishable particles (and in particular bosonic particles).  As such, we will want to look at the restriction of $H_{\mathcal{U},G}^N$ to the bosonic subspace:
\begin{equation}
  \overline{H}_{\mathcal{U},G}^N := H_{\mathcal{U},G}^N \big|_{\mathcal{Z}_N(G)}
\end{equation}

\todo{check boson/fermion}

At this point, it will be extremely useful to add a term proportional to the identity in order to make a positive semidefinite operator. In particular, if we let $\mu(G)$ be the smallest eigenvalue of $A(G)$, we can consider 
\begin{equation}
  H_{\mathcal{U}}(G,N) = \overline{H}_{\mathcal{U},G}^n - N \mu(G)
\end{equation}
which is a positive-semidefinite matrix.  Additionally, as $\mu(G)$ can be efficiently computed using a classical polynomial-time algorithm, we have that the complexity of approximating the ground energy of $H_{\mathcal{U}}(G,N)$ is equivalent to the complexity of approximating the ground energy of $\overline{H}_{\mathcal{U},G}^N$.  

We shall write
\begin{equation}
  0 \leq \lambda_N^1(G) \leq \lambda_N^2(G) \leq \cdots \leq \lambda_N^{D_N} (G)
\end{equation}
for the eigenvalues of $H_{\mathcal{U}}(G,N)$ and $\{\ket{\lambda_N^j(G)}\}$ for the associated eigenvectors.

Note that when $\lambda_N^1(G) = 1$, the ground energy of the $N$-particle MPQW Hamiltonian $\overline{H}_{\mathcal{U},G}^N$ is equal to $N$ times the single-particle ground energy $\mu(G)$.  In this case, we say that the $N$-particle MPQW Hamiltonian is frustration free, as the ground state minimizes both the movement term and the interaction term.  We also define frustration freeness for $N$-particle states.
\begin{definition}[Frustration-free state]  
If $\ket{\psi}\in \mathcal{Z}_{N}(G)$ satisfies $H_{\mathcal{U}}(G,N) \ket{\psi} = 0$, then we say that $\ket{\psi}$ is an $N$-particle frustration-free state for $\mathcal{U}$ on $G$.
\end{definition}

%%%%%
\subsubsection{Basic properties}

We now give some basic properties of $H_{\mathcal{U}}(G,N)$.  In particular we will want to understand how the eigenvalues of the Hamiltonian change when we increase the number of particles, as well as understand such a system when looking at many disconnected copies of graphs.

\begin{lemma}
  For all $N>1$, $\lambda_{N+1}^1(G) \geq \lambda_{N}^1(G)$.
\end{lemma}
\begin{proof}
\todo{Fix this for an arbitrary interaciton}
Let $\widehat{n}_{i}^{N}$ be the number operator \eq{n_hat} defined in the $N$-particle space and let $\widehat{n}_{i}^{N+1}$ be the corresponding operator in the $\left(N+1\right)$-particle space. Note that
\begin{equation}
\widehat{n}_{i}^{N+1} = \widehat{n}_{i}^{N}\otimes\II+|i\rangle\langle i|^{(N+1)} \geq \widehat{n}_{i}^{N}\otimes\II.
\end{equation}
Using this and the fact that $A(G)\geq\mu(G)$, we get 
\begin{equation}
H_{G}^{N+1}-\left(N+1\right)\mu(G)\geq\left(H_{G}^{N}-N\mu(G)\right)\otimes\II.
\end{equation}
Hence 
\begin{align}
  \lambda_{N+1}^{1}(G) & =\min_{|\psi\rangle\in\mathcal{Z}_{N+1}(G)\colon \langle\psi|\psi\rangle=1}\langle\psi|H_{G}^{N+1}-\left(N+1\right)\mu(G)|\psi\rangle\\
 & \geq\min_{|\psi\rangle\in\mathcal{Z}_{N}(G)\otimes\CC^{|V|}\colon \langle\psi|\psi\rangle=1}\langle\psi|\left(H_{G}^{N}-N\mu(G)\right)\otimes\II |\psi\rangle\\
 & =\lambda_{N}^{1}(G)
\end{align}
(using the fact that $\mathcal{Z}_{N+1}(G)\subset\mathcal{Z}_{N}(G)\otimes\CC^{|V|}$). 
\end{proof}
We will encounter graphs $G$ with more than one component. In the cases of interest, the smallest eigenvalue of the adjacency matrix for each component is the same. The following Lemma shows that the eigenvalues of $H(G,N)$ on such a graph can be written as sums of eigenvalues for the components. In this Lemma (and throughout the paper), we let $[k] = \{1,2,\ldots,k\}$.

\begin{lemma}
\label{lem:BH_disconnected_graphs}
Suppose $G=\bigcup_{i=1}^{k}G_{i}$ with $\mu(G_{1})=\mu(G_{2})=\cdots=\mu(G_{k})$. The eigenvalues of $H(G,N)$ are 
\begin{equation}
\sum_{i\in[k]\colon N_{i}\neq0}\lambda_{N_{i}}^{y_{i}}(G_{i})
\end{equation}
where $N_{1},\ldots,N_{k}\in\{0,1,2,\ldots\}$ with $\sum_{i}N_{i}=N$ and $y_{i}\in[D_{N_{i}}].$ The corresponding eigenvectors are (up to normalization) 
\begin{equation}
\Sym\Bigg(\prod_{i\in[k]\colon N_{i}\neq0}|\lambda_{N_{i}}^{y_{i}}(G_{i})\rangle\Bigg).
\label{eq:eigvecs_disconnected}
\end{equation}
\end{lemma}

\begin{proof}
Recall that the action of $H_{G}-N\mu(G)$ on the Hilbert space \eq{occupation_num_states} is the same as the action of $H(G,N)$ on the Hilbert space $\mathcal{Z}_{N}(G)$. States in these Hilbert spaces are identified via the mapping described in equation \eq{occup_num_symmetrized}. It is convenient to prove the Lemma by working with the second-quantized Hamiltonian $H_{G}$. We then translate our results into the first-quantized picture to obtain the stated claims.

For a graph with $k$ components, equation \eq{Bose-Hubbard_Ham} gives 
\begin{equation}
H_{G}=\sum_{i=1}^{k}H_{G_{i}}\label{eq:H_G_disconnected}
\end{equation}
where $[H_{G_{i}},H_{G_{j}}]=0.$ Label each vertex of $G$ by $(a,b)$ where $b\in[k]$ and $a\in[|V_{b}|]$, where $V_{b}$ is the vertex set of the component $G_{b}$. An occupation number basis state \eq{occupation_num_states} can be written 
\begin{equation}
|l_{1,1},\ldots,l_{|V_{1}|,1}\rangle|l_{1,2},\ldots,l_{|V_{2}|,2}\rangle\ldots|l_{1,k},\ldots,l_{|V_{k}|,k}\rangle.\label{eq:prod_basis_occ_num}
\end{equation}
The Hamiltonian $H_{G}-N\mu(G)$ conserves the number of particles $N_{b}$ in each component $b$. Within the sector corresponding to a given set $N_{1},\ldots,N_{k}$ with $\sum_{i \in [k]} N_i=N$, we have
\begin{align}
& \left(H_{G}-N\mu(G)\right)|l_{1,1},\ldots,l_{|V_{1}|,1}\rangle|l_{1,2},\ldots,l_{|V_{2}|,2}\rangle\ldots|l_{1,k},\ldots,l_{|V_{k}|,k}\rangle\\
&\quad =\big(H_{G_1}-N_1\mu(G_1)|l_{1,1},\ldots,l_{|V_{1}|,1}\rangle\big)|l_{1,2},\ldots,l_{|V_{2}|,2}\rangle\ldots|l_{1,k},\ldots,l_{|V_{k}|,k}\rangle\\
&\qquad+|l_{1,1},\ldots,l_{|V_{1}|,1}\rangle\big(H_{G_2}-N_2\mu(G_2)|l_{1,2},\ldots,l_{|V_{2}|,2}\rangle\big)\ldots|l_{1,k},\ldots,l_{|V_{k}|,k}\rangle + \cdots\\
&\qquad+|l_{1,1},\ldots,l_{|V_{1}|,1}\rangle|l_{1,2},\ldots,l_{|V_{2}|,2}\rangle\ldots\big(H_{G_k}-N_k\mu(G_k)|l_{1,k},\ldots,l_{|V_{k}|,k}\rangle\big),
\end{align}
where we used the fact that $\mu(G_i)=\mu(G)$ for $i\in[k]$.  From this equation we see that the eigenstates of $H_{G}$ can be obtained as product states with $k$ factors in the basis \eq{prod_basis_occ_num}. In each such product state, the $i$th factor is an eigenstate of $H_{G_{i}}-N_{i}\mu(G_{i})=H_{G_{i}}-N_{i}\mu(G)$ in the $N_{i}$-particle sector, with eigenvalue $\lambda_{N_{i}}^{j_{i}}(G_{i})$. Rewriting this result in the ``first-quantized'' language, we obtain the Lemma. 
\end{proof}

%%%%%%%%%%%%
\subsubsection{\QMA-hard problem}

With all of these definitions floating around, it will then be useful to actually define the basic problem that we will show is \QMA-hard.  In particular, we have that for any positive integer $\alpha$, the following problem:

\begin{problem}[$\alpha$-frustration-free$\mathcal{U}$-interaction MPQW Hamiltonian]
  We are given as input a $K$-vertex simple graph $G$, a number of particles $N\leq K$, and a precision parameter $\epsilon = 1/T$, where the positive integers $N$ and $T \geq 4K$ are given in unary, and the graph $G$ is given as its adjacency matrix (a $K\times K$ symmetric $0$-$1$ matrix). We arp promised that either $\lambda_N^1(G) \leq \epsilon^\alpha$ (a yes instance), or else that $\lambda_N^1(G) \geq \epsilon + \epsilon^\alpha$ (a no instance) and we are asked to decide which is the case.
\end{problem}

Note that for each interaction type, this is an infinite family of problems.  The positive integer $\alpha$ parameterizes how much the yes cases can deviate from a true frustration-free case.  The reason that we define the problem in such a way is that it will facilitate the reduction found in \chap{spin_ground}.

Note that this is a special case of the $\mathcal{U}$-interaction MPQW Hamiltonian, with $c = N\mu(G) + \epsilon^\alpha$.  As such, if we show that the $\alpha$-frustration free $\mathcal{U}$-interaction MPQW Hamiltonian problem is \QMA-hard, we will also show that the non-frustration-free problem is \QMA-complete.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Useful graph primitives}\label{sec:graph_primitives}

At this point, we will want to construct a graph for which our \QMA-hardness result will hold.  As such, we will at this point restrict our attention to a particular interaction, $\mathcal{U}$.  While the idea behind the construction of these graphs will not change, the exact graph will depend on both the largest distance for which there is a non-zero interaction.  We will want to construct a foundational graph that does not have a two-particle ground state, and also we will want to ensure that our connections between these building blocks will not have multiple particles interacting except on specially chosen building blocks.

As such, let us assume that the minimum distance that the interaction $\mathcal{U}$ has non-zero interactions is $\dmin$, while the maximum distance is $\dmax$.  Our graph will only depend on $\dmax$, but it will be useful to also know $\dmin$.  We will also assume that $\mathcal{U}_{\dmin}^{(1,1)} > 0$, so that there is some energy penalty if two particles are at a distance $\dmin$ (assuming that $\dmin > 0$ --- otherwise we will assume that $\mathcal{U}_0^{2} > 0$).

Additionally, we will want the eventual graph to be a simple graph, so that there is always at most a single edge between two vertices and no self-loops.  Unfortunately, our proof strategy will involve adding many positive semi-definite terms to the adjacency matrix, which correspond to adding in edges and self-loops.  As such, we will instead force every vertex in the graph to contain a self-loop, so that by removing all of the self loops we only shift the energy levels by a constant amount.  Keep this in mind, as the eventual graph is defined.

With all of this said, however, this section will only define some useful foundational graphs that will be used in the final construction of the graph.  All of these graphs will be constant sized, and we will show a spanning set for their single-particle and two-particle ground states.  By construction, they will not have any three-particle frustration-free states.

%%%%%%%%%%%%%%%
\subsection{Gate graphs}\label{sec:gate_graphs}


\todo{rewrite this introduction}
In this section we define a class of graphs (\emph{gate graphs}) and a diagrammatic notation for them (\emph{gate diagrams}) that will allow us to construct the overall graph. We will also discuss the MPQW Hamiltonian acting on these graphs, with a particular emphasis on the low-energy states.

Every gate graph is constructed using a specific, finite-sized graph $g_{0}$ as a building block. This graph is shown in \fig{g_0} (for graphs with $\dmin <= 3$ and discussed in \sec{g_0_graph}).  These graphs are designed so that in the low energy sector, each copy of $g_0$ can only contain a single particle at a time, so that we can force particles to occupy certain states.  Additionally, the low energy states correspond to the history states of simple single-qubit circuits, we can use these to encode simple computations as described in \sec{gate_diagram}. 

In \sec{FF_State} we discuss the ground states of the Bose-Hubbard model on gate graphs. For any gate graph $G$, the smallest eigenvalue $\mu(G)$ of the adjacency matrix $A(G)$ satisfies $\mu(G)\geq-1-3\sqrt{2}$. It is convenient to define the constant
\begin{equation}
e_{1}=-1-3\sqrt{2}.\label{eq:e1_defn}
\end{equation}
When $\mu(G)=e_{1}$ we say $G$ is an $e_{1}$-gate graph. We focus on the frustration-free states of $e_1$-gate graphs (recall from \defn{FF_states} that $|\phi\rangle\in \mathcal{Z}_N(G)$ is frustration free iff $H(G,N)|\phi\rangle=0$). We show that all such states live in a convenient subspace (called $\mathcal{I}(G,N)$) of the $N$-particle Hilbert space. This subspace has the property that no two (or more) particles ever occupy vertices of the same copy of $g_{0}$. The restriction to this subspace makes it easier to analyze the ground space.

In \sec{Occupancy-constraints} we consider a class of subspaces that, like $\mathcal{I}(G,N)$, are defined by a set of constraints on the locations of $N$ particles in an $e_{1}$-gate graph $G$. We state an ``Occupancy Constraints Lemma'' (proven in \app{Occupancy-Constraints-Lemma}) that relates a subspace of this form to the ground space of the Bose-Hubbard model on a graph derived from $G$.


\subsubsection{The graph $g_0$}\label{sec:g_0_graph}

The graph $g_{0}$ shown in \fig{g_0} is constructed using the method of \chap{SP_ground}, with the single qubit circuit corresponding to a sequence of $H$ and $HT$ gates.  The idea is to force the ground state of the resulting graph to correspond to these computations while also spreading the wave-function over most of the vertices.  In this way, we can use the ground state to compute these single-particle unitaries while also forcing the graph to only have single-particle frustration free states.

In particular, let $k = 4 + 2 \lceil \frac{\dmax}{2}\rceil$, and then let us look at the single-qubit circuit $\mathcal{C}_0$ with $k$ gates $U_j$, for $j\in[k]$, where 
\begin{align}
U_{1}=HT\qquad U_{2}=\left(HT\right)^{\dagger}
\end{align}
and the rest of the $U_j=H$.  We will eventually use the first four of these time steps as computations in the eventual gadgets, while the remaining time steps act as padding to ensure that this computational steps occur at a distance at least $\dmax$ from each other.  As the circuit $\mathcal{C}_0$ implements an identity operation, we can easily concatenate these circuits and then output something using circular time as in the construction of \chap{SP_ground}.  For our purposes, we will want to use 8 copies of the circuit in series, as the eventual gadgets we use will have 8 possible locations for interactions with other copies of $g_0$.

In particular, we will have that the $0$-$1$ Hamiltonian corresponding to the eventual adjacency matrix of $g_0$ acts on the Hilbert space $\mathcal{H}(g_0) = \CC^{2}\otimes \CC^{8k} \otimes \CC^8$.  If we then remember that $B(U)$ is the operator that takes $\omega \mapsto S$, where $\omega = e^{i \pi/4}$ and  $S$ is the shift operator acting on $\CC^{8}$, we have that the component of the Hamiltonian corresponding to the circuit is
\begin{equation}
  H_{\text{prop}} = -\sqrt{2} \sum_{t=0}^{8k} B(V_{t})_{13} \otimes \ketbra{t+1}{t} + B(V_{t}^\dag)_{13} \otimes \ketbra{t}{t+1},
\end{equation}
where
\begin{equation}
  V_t = \begin{cases}
    HT & t = 0 \mod 8\\
    (HT)^{\dag} & t = 1 \mod 8\\
    H & \text{otherwise}.
  \end{cases}
\end{equation}
This term, along a penalty to the $\CC^8$ Hilbert space given by
\begin{equation}
  H_{\text{pen}} = \II_{\CC^2} \otimes \II_{\CC^{8k}} \otimes \big( S^3 + S^4 + S^3\big),
\end{equation}
which forces the third register into a particularly useful form, allows us to guarantee that the ground state is a history state.  Altogether, we then have that the adjacency matrix of $g(0)$ is given by
\begin{equation}
  A(g_0) = H_{\text{prop}} + H_{\text{pen}},
\end{equation}
where each vertex is labeled by a computational basis state in the Hilbert space, namely $(z,t,j)$ with $z\in \FF_2$, $t\in [8k]$, and $j\in[8]$.  The graph $g_0$ in the special case that $\dmax = 0$ is shown in \fig{g_0}.

%%%%%%%
\begin{figure}
  \centering
  \tikzsetnextfilename{MP_g_0}
  \input{../tikz/MP_G_0.tex}
  \caption{The graph $g_{0}$ for the case $\dmax = 0$.  Vertices are arranged with each ray corresponding to a specific time $t$ proceeding clockwise, with the outer 8 vertices corresponding to logical $0$ and the inner 8 corresponding to logical $1$, with the further breakdown into 8 vertices corresponding to the ancillary register.  The difference in color for some edges is an attempt to highlight those edges corresponding to the penalty term (bottom of the figure) and the circuit (top left of the figure).  \label{fig:g_0}}
\end{figure}

We can then use the results of \chap{SP_ground} to calculate the smallest eigenvalue of $A(g_0)$, the corresponding eigenvectors, and the eigenvalue gap.  In particular, we have that the smallest eigenvalue is 
\begin{equation}
  e_1 = -1 - 3 \sqrt{2} = -5.24\ldots, \label{eq:e_1},
\end{equation}
corresponding to a four dimensional ground space spanned by the states
\begin{align}
  \ket{\psi_{z,0}} &= \frac{1}{\sqrt{8k}}\sum_{t=0}^{8k-1} \big(V_t V_{t-1} \cdots V_1\big) \ket{z} \ket{t} \ket{\omega}= \frac{1}{\sqrt{8k}}\sum_{t'=0}^{4k-1} \ket{z} \ket{2t'}\ket{\omega} + V_{2t' + 1} \ket{z} \ket{2t'+1}\ket{\omega}\label{eq:psi0m}\\
  \ket{\psi_{z,1}} &= \frac{1}{\sqrt{8k}} \sum_{t'=0}^{4k-1} \ket{z}\ket{2t'} \ket{\overline{\omega}} + V_{2t'+1}* \ket{z} \ket{2t'+1} \ket{\overline{\omega}}\label{eq:psi1m},
\end{align}
where
\begin{align*}
  \ket{\omega} &= \frac{1}{\sqrt{8}} \sum_{j=0}^{7} e^{i \pi j/4} \ket{j} &\text{ and } &&
  \ket{\overline{\omega}} &= \frac{1}{\sqrt{8}} \sum_{j=0}^7 e^{-i \pi j/4} \ket{j}.
\end{align*}
Additionally, we have that the energy gap is at least 
\begin{equation}
  \lambda_1^2(g_0) \geq \sqrt{2} \cos\Big(\frac{\pi}{4k}\Big) \geq \frac{\pi\sqrt{2}}{16 k^2} = c_k,
\end{equation}
which is constant for constant interactions.



Note that the amplitudes of $|\psi_{z,0}\rangle$ in the above basis contain the result of computing either the identity, Hadamard, or $HT$ gate acting on the ``input'' state $|z\rangle$, while the amplitudes $\ket{\psi_{z,1}}$ corresponds to the result of the identity, Hadamard or $\overline{HT}$ gate acting on the ``input'' state.


With these bounds on the single particle eigenstates, we can now show that the graph $g_{0}$ has no two-particle frustration-free states. By \lem{increase_part_number}, it follows that $g_0$ has no $N$-particle frustration-free states for $N\geq 2$.  While we would like this to be true in general for all states, in the case of only onsite interactions ($\dmax =0$) no anti-symmetric state is penalized by the interaction.  As the ground space of $A(g_0)$ is degenerate, we then have that in this case there are two particle frustration-free states on $g_0$.  However, we show that this is the only case for which this is true.

\begin{lemma}
\label{lem:2particle}If $\dmax > 0$, then $\lambda_{2}^{1}(g_{0})>0$ for all states.  If $\dmax = 0$, then when restricted to symmetric states, $\lambda_2^{1}(g_0) >0$.
\end{lemma}

\begin{proof}
Suppose (for a contradiction) that $|Q\rangle\in \HHH(g_0)^{\otimes 2}$ is a nonzero vector in the nullspace of $H(g_{0},2)$, so 
\begin{equation}
  H_{g_{0}}^{2}|Q\rangle
    =\bigg(A(g_{0})\otimes\II+\II\otimes A(g_{0})+\sum_{i,j \in g_{0}}\mathcal{U}_{d(i,j)}(\hat{n}_i,\hat{n}_j)\bigg)|Q\rangle=2e_{1}|Q\rangle.
\end{equation}
This implies 
\begin{equation}
  A(g_{0})\otimes\II|Q\rangle=\II\otimes A(g_{0})|Q\rangle=e_{1}|Q\rangle
\end{equation}
since $A(g_0)$ has smallest eigenvalue $e_1$ and the interaction term is positive semidefinite. We can therefore write 
\begin{equation}
  |Q\rangle=\sum_{z,a,x,y\in \FF_2}Q_{za,xy}|\psi_{z,a}\rangle|\psi_{x,y}\rangle
\end{equation}
and 
\begin{equation}
  \mathcal{U}_{d(u,v)}(\hat{n}_u,\hat{n}_v)|Q\rangle=0
\end{equation}
for all vertices $u,v\in g_{0}.$ 


We then have by assumption that  $\mathcal{U}^{(1,1)}_{\dmax} >  0$ if $\dmax > 0$ or $\mathcal{U}^{2}_{0} > 0$ if $\dmax = 0$,  and thus for all vertices $u,v$ of distance $\dmax$, 
\begin{equation}
  \braket{u,v}{Q} = 0\label{eq:dmin_annihilate}.
\end{equation}
We will use this equation to show a contradiction, so that $\ket{Q}$ cannot exist.

Note that vertices of the form $(x,T,j)$ and $(z,T+t,k)$ are at least a distance $t$ apart for $t>0$ and $t\leq \dmax$, since edges only exist between vertices corresponding to times that differ by at most 1.  Further, as each unitary for $t\geq 2$ corresponds to a Hadamard, and only connects vertices with the same $j$ or $j$'s that differ by 4, we have that only vertices of the form $(x,2,j)$ and $(z,2+t,j)$ or $(x,2,j)$ and $(z,2+t,j+4)$ can be a distance $t$ apart; all other pairs of vertices must be at a distance of at least $t+1$.

With all of this in mind, let us assume that $\dmax$ is an even integer greater than zero.  We then have that the vertices $(0,2,j)$ and $(0,1+\dmax,j+4)$ are a distance $\dmax-1$ apart.  Further, we have that $(0,1+\dmax,j+4)$ is also connected to the vertices $(0,1+\dmax,j+1)$ and $(0,1+\dmax,j-1)$, and thus we have that the vertices $u = (0,2,j)$ and $v = (0,1+\dmax, j + \ell)$ are a distance $\dmax$ apart for all $j\in [8]$ and for $\ell = \pm 1$.  Using \eq{dmin_annihilate} with these pairs of vertices we then have that 
\begin{align}
  \braket{u,v}{Q} &= \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{0,2,j}{\psi_{x,a}}\braket{0,1+\dmax,j+\ell}{\psi_{zb}}\\
  &=\frac{1}{64 k} \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{0}{x} \bra{0} H \ket{z} \omega^{(-1)^a j+ (-1)^b (j+\ell)}\\
  &= \frac{1}{128 k} \big( (Q_{00,00} + Q_{00,10}) \omega^{2j + \ell} + (Q_{00,01} + Q_{00,11})\omega^{-\ell} \nonumber\\
  &\qquad \qquad + (Q_{01,00} + Q_{01,10})\omega^{\ell} + (Q_{01,01} + Q_{01,11})\omega^{-2j - \ell}\big),
\end{align}
and thus we have that $Q_{0a,0b} = - Q_{0a,1b}$ for all $a,b\in \FF_2$.  Using the same reasoning with vertices $u =(0,2,j)$ and $v =(1,1+\dmax, j+\ell)$ with $\ell =\pm 1$ then gives us ))
\begin{align}
  \braket{u,v}{Q} &= \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{0,2,j}{\psi_{x,a}}\braket{1,\dmax,j+\ell}{\psi_{zb}}\\
  &=\frac{1}{64 k} \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{0}{x} \bra{1} H \ket{z} \omega^{(-1)^a j+ (-1)^b (j+\ell)}\\
  &= \frac{1}{128 k} \big( (Q_{00,00} - Q_{00,10} \omega^{2j + \ell} + (Q_{00,01} - Q_{00,11})\omega^{-\ell} \nonumber\\
  &\qquad \qquad + (Q_{01,00} - Q_{01,10})\omega^{\ell} + (Q_{01,01} - Q_{01,11})\omega^{-2j - \ell}\big),
\end{align}
which combined with our previous results show that $Q_{0a,zb} = 0$ for all $a,b,z\in \FF_2$.  Again using the same reasoning with $u = (1,2,j)$ and $v= (1,1+\dmax, j+\ell)$ for $\ell =3$ or $\ell = 5$ gives us 
\begin{align}
  \braket{u,v}{Q} &= \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{1,2,j}{\psi_{x,a}}\braket{1,1+\dmax,j+\ell}{\psi_{zb}}\\
  &=\frac{1}{64 k} \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{1}{x} \bra{1} H \ket{z} \omega^{(-1)^a j+ (-1)^b (j+\ell)}\\
  &= \frac{1}{128 k} \big( (Q_{10,00} - Q_{10,10} \omega^{2j + \ell} + (Q_{10,01} - Q_{10,11})\omega^{-\ell} \nonumber\\
  &\qquad \qquad + (Q_{11,00} - Q_{11,10})\omega^{\ell} + (Q_{11,01} - Q_{11,11})\omega^{-2j - \ell}\big),
\end{align}
which forces $Q_{1a,0b} = Q_{1a,1b}$ for all $a,b\in \FF_2$.  Finally, using this same technique for $u = (1,2,j)$ and $v = (0,1+\dmax, j+\ell)$ with $\ell = \pm 1$ gives us
\begin{align}
  \braket{u,v}{Q} &= \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{1,2,j}{\psi_{x,a}}\braket{0,1+\dmax,j+\ell}{\psi_{zb}}\\
  &=\frac{1}{64 k} \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{1}{x} \bra{0} H \ket{z} \omega^{(-1)^a j+ (-1)^b (j+\ell)}\\
  &= \frac{1}{128 k} \big( (Q_{10,00} + Q_{10,10} \omega^{2j + \ell} + (Q_{10,01} + Q_{10,11})\omega^{-\ell} \nonumber\\
  &\qquad \qquad + (Q_{11,00} + Q_{11,10})\omega^{\ell} + (Q_{11,01} + Q_{11,11})\omega^{-2j - \ell}\big),
\end{align}
which combined with our previous results implies that $Q_{1a,zb} = 0$ for all $a,b,z\in\FF_2$.  Putting this together, we then have each $Q_{xa,zb} = 0$, and thus $\ket{Q}$ does not exist; in other words, if $\dmax >0$ is even, then the nullspace of $H(g_0,2)$ is empty.

Now let us assume that $\dmax$ is a positive odd integer.  For all such $\dmax$, we can then use equation \eq{dmin_annihilate} with vertices $u =(y,2,j)$ and $v =(y,1+\dmax,j+\ell)$ for $y\in \FF_2$, $j\in [8]$, and $\ell = \pm 1$ to see
\begin{align}
  \braket{u,v}{Q} &= \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{y,2,j}{\psi_{x,a}}\braket{y,1+\dmax,j+\ell}{\psi_{zb}}\\
  &=\frac{1}{64 k} \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{y}{x} \braket{y}{z} \omega^{(-1)^a j+ (-1)^b (j+\ell)}\\
  &= \frac{1}{64 k} \big( Q_{y0,y0}  \omega^{2j + \ell} + Q_{y0,y1}\omega^{-\ell} + Q_{y1,y0} \omega^{\ell} + Q_{y1,y1}\omega^{-2j - \ell}\big),
\end{align}
to see that $Q_{ya,yb} = 0$ for all $a,b,y\in \FF_2$.  With this result, let us now examine vertices at times that differ by $\dmax$.  Using equation \eq{dmin_annihilate} with $u = (0,2,j)$ and $v = (0,2+\dmax,j+4)$ gives us
\begin{align}
  \braket{u,v}{Q} &= \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{0,2,j}{\psi_{x,a}}\braket{0,2+\dmax,j+4}{\psi_{zb}}\\
  &=\frac{1}{64 k} \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{0}{x} \bra{0}H\ket{z} \omega^{(-1)^a j+ (-1)^b (j+4)}\\
  &= -\frac{1}{64 k\sqrt{2}} \big((Q_{00,00}+ Q_{00,10} )  \omega^{2j} + (Q_{01,01} + Q_{01,11})\omega^{-2j}\nonumber\\
  &\qquad\qquad+(Q_{01,00} + Q_{01,10} + Q_{00,01} + Q_{00,11})\big)\\
  &= -\frac{1}{64 k \sqrt{2}} \big(Q_{00,10} \omega^{2j} + Q_{01,11} \omega^{-2j} + (Q_{01,10} + Q_{00,11})\big)
\end{align}
where in the last line we used the fact that $Q_{za,zb} = 0$.  A similar result with $u = (0,2,j)$ and $v = (1,2+\dmax, j+4$ then gives us that $Q_{0a,zb} = 0$.  Finally, repeating this same procedure with $u = (1,2,j)$ and $v=(1,2+\dmax,j)$ and with $u = (1,2,j)$ and $v = (0,2+\dmax, j+4)$ gives us that $Q_{1a,zb} = 0$.  Putting this all together, we have that each $Q_{xa,zb} = 0$ and thus $\ket{Q}$ does not exist if $\dmax$ is an odd integer.

Finally, let us assume that $\dmax = 0$, and that the state $\ket{Q}$ is symmetric (so that $Q_{xa,zb} = Q_{zb,xa}$).  With these assumptions, let us examine equation \eq{dmin_annihilate} with $u=v = (y,0,j)$ for $y\in \FF_2$ and $j\in [8]$:
\begin{align}
  \braket{u,v}{Q} &= \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{y,0,j}{\psi_{x,a}}\braket{y,0,j}{\psi_{zb}}\\
  &=\frac{1}{64 k} \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{y}{x} \braket{y}{z} \omega^{(-1)^a j+ (-1)^b j}\\
  &= \frac{1}{64 k} \big(Q_{y0,y0}  \omega^{2j} + Q_{y1,y1} \omega^{-2j}+2 Q_{y1,y0} )\big).
\end{align}
Evaluating these equations together then gives us that $Q_{xa,xb} = 0$ for all $a,b,x \in \FF_2$.  If we now use equation \eq{dmin_annihilate} with $u=v=(0,3,j)$ for all $j\in [8]$, we find that
\begin{align}
  \braket{u,v}{Q} &= \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{0,3,j}{\psi_{x,a}}\braket{0,3,j}{\psi_{zb}}\\
  &=\frac{1}{64 k} \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \bra{0}H \ket{x} \bra{0}H\ket{z} \omega^{(-1)^a j+ (-1)^b j}\\
  &= \frac{1}{128 k} \big(2 Q_{00,10}  \omega^{2j} + 2 Q_{01,11} \omega^{-2j}+(2 Q_{01,10} + 2 Q_{00,11} )\big).
\end{align}
and thus $Q_{00,10} = Q_{01,11} = 0$ and $Q_{01,10} = - Q_{00,11}$.  If we now use \eq{dmin_annihilate} with the only remaining vertices leading to novel restrictions, namely $u = v = (0,1,0)$, we find 
\begin{align}
  \braket{u,v}{Q} &= \sum_{x,a,z,b\in \FF_2} Q_{xa,zb} \braket{0,1,j}{\psi_{x,a}}\braket{0,1,j}{\psi_{zb}}\\
  &=\frac{1}{64 k} \big( 2 Q_{01,10}\bra{0} \overline{HT} \ket{0} \bra{0} HT \ket{1}  + 2 Q_{00,11} \bra{0}HT \ket{0} \bra{0} \overline{HT} \ket{1}\big)\\
  &= \frac{1}{64 k} \big( Q_{01,10} \omega + Q_{00,11} \omega^{-1})\\
  &= \frac{Q_{01,10}}{ 64 k} ( \omega - \omega^{-1})
\end{align}
must be zero, and thus each $Q_{xa,zb} = 0$.  Hence, if $\dmax = 0$ no symmetric state $\ket{Q}$ is in the nullspace of $H(g_0,2)$.  

Combining all of this together, we have that if $\dmax > 0$, then the nullspace of $H(g_0,2)$ is empty and thus $\lambda_2^1(g_0) > 0$, and if $\dmax = 0$ then no symmetric state is in the nullspace of $H(g_0,2)$, and thus when restricted to symmetric states, $\lambda_2^1(g_0) > 0$.
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Diagram elements}\label{sec:diagram_elements}

We use several different graphs closely related to the graph $g_0$, with some depicted in \fig{diagram_elements}.  We call these figures \emph{diagram elements}, which are also the simplest examples of \emph{gate diagram}, which we will define shortly.  The idea behind these graphs is to encode a single qubit computation, complete with inputs and outputs. 

\todo{fix diagram element graphs}

\begin{figure}
\centering
%%%%%%%%%%%%%%%%%%%%% 
  \subfloat[][]{ 
%%%%%%%%% Hadamard %%%%%%%%%
  \tikzsetnextfilename{MP_diagram_elementH}
  \input{../tikz/MP_diagram_elementH}
  \label{fig:diagram_elementH}  
} 
\qquad
\subfloat[][]{
%%%%%%%%% Hadamard * T %%%%%%%%%
  \tikzsetnextfilename{MP_diagram_elementHT}
  \input{../tikz/MP_diagram_elementHT}
  \label{fig:diagram_elementHT}
} 
\qquad 
\subfloat[][]
{
%%%%%%%%% Identity %%%%%%%%%
  \tikzsetnextfilename{MP_diagram_element1}
  \input{../tikz/MP_diagram_element1}
  \label{fig:diagram_element1}
}
\caption{Diagram elements from which a gate diagram is constructed. Each diagram element is a schematic representation of the graph $g_{0}$ shown
in \fig{g_0}. 
\label{fig:diagram_elements}}
\end{figure}

Each diagram element corresponds to two copies of the graph $g_0$, along with self-loops and edges between the two copies to force the ground space into a particular form while also ensuring that almost all of the vertices of the two copies will have self-loops.  We need these additional self-loops and edges to ensure that the final graph that we construct has self-loops on all vertices. 

In particular, each diagram element will be labeled by the unitary it computes, along with four numbers between zero and two, corresponding to the number of inputs ``nodes'' and output ``nodes'' of the diagram.  Each such node will correspond to 16 vertices of the underlying graph representing one logical state and time of the two $g_0$ graphs.  These nodes are constructed so that the distance between two vertices in separate nodes will be at least $\dmax$.  

Explicitly, each diagram element will be labeled by a unitary $U\in \{\II, H, HT\}$, along with four integers $n_{0,\text{in}}$, $n_{0,\text{out}}$, $n_{1,\text{in}}$, and $n_{1,\text{out}}$ each between 0 and 2.  These numbers correspond to the number of nodes for each particular input or output.  We shall label such a diagram element a $U^{(n_{0,\text{in}},n_{1,\text{in}})}_{(n_{0,\text{out}},n_{1,\text{out}})}$ element.  The vertex set for the corresponding diagram element corresponds to two copies of $g_0$ (namely, $2\times 8k \times 8 \times 2$ vertices, labeled as $(z,t,j,d)$ for $z,d\in \FF_2$, $t\in [8k]$, and $j\in [8]$).  

For each node of the gate diagram, we will associate a time for which the underlying history state has computed the correct unitary.  Further, we will have these times each be a distance of at least $\dmax$ apart, to ensure that each node is at least a distance $\dmax$ apart.  Namely, for each logical input and output, we will associate two times:
\begin{itemize}
  \item $0$-input: $t_{0,1}^{\text{in}} = 0$ and $t_{0,2}^{\text{in}} = k$,
  \item $1$-input: $t_{1,1}^{\text{in}} = 2k$ and $t_{1,2}^{\text{in}} = 3k$,
  \item $0$-output: $t_{0,1}^{\text{out}} = 4k+\ell$ and $t_{0,2}^{\text{out}} = 5k+\ell$,
  \item $1$-output: $t_{1,1}^{\text{out}} = 4k+\ell$ and $t_{1,2}^{\text{out}} = 5k+\ell$,
\end{itemize}
where $\ell$ is $0$, $1$, or $3$, depending on whether the labeled unitary is $\II$, $HT$, or $H$, respectively.

For a diagram element $U^{(n_{0,\text{in}},n_{1,\text{in}})}_{(n_{0,\text{out}},n_{1,\text{out}})}$, let us define the set of logical states and corresponding times that will be associated with the nodes as $T\subset \FF_2 \times [8k]$. In particular, we have that 
\begin{equation}
  T =\cup_{z\in \FF_2} \{(z, t_{z,j}^{\text{in}} ): j \leq n_{z,\text{in}}\} \cup \{(z, t_{z,j}^{\text{out}}) : j \leq n_{z,\text{out}}\}.
\end{equation}
Note that $|S|$ corresponds to the number of nodes of the diagram element.

With $S$ defined, the adjacency matrix for the diagram element $U^{(a,b)}_{(c,d)}$ will be
\begin{align}
  A(G_U^{(a,b),(c,d)}) &= A(g_0) \otimes \II_{2} + \sum_{(z,t)\notin T,j\in[8]} \ketbra{z,t,j}{z,t,j} \otimes \sum_{a,b\in \FF_2} \ketbra{a}{b} \\
   &= A(g_0)\otimes \II_2 + 2 \Pi_{\lnot T} \otimes \II_{8} \otimes \ketbra{+}{+}
\label{eq:diagram_element}
\end{align}
In particular, the graph for $G_U^{(a,b),(c,d)}$ will simply correspond to two copies of $g_0$, along with a projector onto the equal superposition between the two graphs for each vertex not used as a node.

Because of the very similar form between $G_U^{(a,b),(c,d)}$ and $g_0$, their ground spaces and ground energies are closely related.  As the second term in \eq{diagram_element} is positive semi-definite, we have that the ground energy of $A(G_U^{(a,b),(c,d)})$ is at least that of $A(g_0)$. With more exact results, we have the following lemma:
\begin{lemma}
  Let $G_{U}^{(a,b),(c,d)}$ be the graph corresponding to a diagram element.  The ground space of $A(G_U^{(a,b),(c,d)})$ is
  \begin{equation}
    S = \spn\{ \ket{\psi_{z,a},-} : z,a\in \FF_2\}.
  \end{equation}
  \label{lem:diagram_element_ground}
\end{lemma}
\begin{proof}
  Note that $A(G_U^{(a,b),(c,d)})$ commutes with $\II_{2}\otimes \II_{8k} \otimes \II_8 \otimes \ketbra{+}{+}$, and thus there exists an eigenbasis for the adjacency matrix in which each vector is of the form $\ket{\phi}\ket{+}$ or $\ket{\phi}\ket{-}$.   For states of this latter form, the second term in \eq{diagram_element} vanishes, so  $\ket{\psi,-}$ is in the ground space of $A(g_U^{(a,b),(c,d)})$ if and only if $\ket{\psi}$ is in the ground space of $A(g_0)$, and thus we have that $S$ is a subspace of the nullspace.
  
  Now let us examine $\ket{\alpha,+}$ for any state $\ket{\alpha}$.  Since the first term of \eq{diagram_element} has no dependence on the state $\ket{+}$, we have that the ground energy of $A(G_U^{(a,b),(c,d)})$ is at least $e_1$.  Hence, if $\ket{\alpha,+}$ is in the ground space, then 
\begin{equation}
  \bigbra{\alpha,+} A\big(G_U^{(a,b),(c,d)}\big) \bigket{\alpha,+} = e_1 = \bra{\alpha} A(g_0) \ket{\alpha}
\end{equation}
and thus 
\begin{equation}
  \bra{\alpha} \Pi_{\lnot S}\otimes \II_8 \ket{\alpha} = 0,
\end{equation}
with $\ket{\alpha}$ in the ground space of $A(g_0)$.
  
  However, let $t^* = 2$, and note that for all diagram elements (and all $\dmax$), $(z,t^*)$ is not in $T$.  We then have that
  \begin{equation}
    \Pi_{\lnot S} \geq \II_2 \otimes \ketbra{t^*}{t^*} \otimes \II_8.
  \end{equation}
  Note that this operator is strictly positive when restricted to the ground space of $A(g_0)$:
  \begin{equation}
    \bra{\psi_{x,\gamma}} \II_2 \otimes \ketbra{t^*}{t^*} \otimes \II_8 \ket{\psi_{z,\delta}} = \frac{1}{8k} \delta_{\gamma,\delta} \delta_{x,z}.
  \end{equation}
  Hence, $\Pi_{\lnot S}$ is also strictly positive when restricted to the ground space of $A(g_0)$, and thus $\ket{\alpha,+}$ is not in the ground space of $A(G_U^{(a,b),(c,d)})$.
  
  Putting this together, we have that the ground space of $A(G_U^{(a,b),(c,d)})$ is $S$. 
\end{proof}

With this bound on the form of the ground space of $A(G_U^{(a,b),(c,d)})$, we can then use our knowledge of the two-particle interaction Hamiltonian on $g_0$ to relate this to the two-particle interaction Hamiltonian on $G_U^{(a,b),(c,d)}$.    Namely, we show that since there does not exist a two-particle frustration-free state on $g_0$, there also does not exists a two-particle frustration-free state on $G_U^{(a,b),(c,d)}$.

\begin{lemma}
  If $\dmax >0$, then $\lambda_2^1(g_U^{(a,b),(c,d)}) > 0$ for all states.  If $\dmax = 0$, then when restricted to symmetric states, $\lambda_2^1(G_U^{(a,b),(c,d)}) > 0$.
  \label{lem:2particle_element_bound}
\end{lemma}
\begin{proof}
  Note that using \lem{diagram_element_ground}, the ground space of $A(G_U^{(a,b),(c,d)})$ is in one-to-one correspondence with the ground space of $A(g_0)$, by the transformation
  \begin{equation}
    \ket{\phi_{x,a},-} \leftrightarrow \ket{\phi_{x,a}}\label{eq:phi_copy_transform}.
  \end{equation}
  Namely, by attaching (or removing) a second register in the $\ket{-}$ state, corresponding to having equal and opposite amplitudes between the two copies of $g_0$ present in $g_U^{(a,b),(c,d)}$, we can transform between these two ground spaces.
  
  We will use this relation, along with the fact that $\lambda_2^1(g_0) > 0$ from \lem{2particle}, to show that $\lambda_2^1(G_U^{(a,b),(c,d)}) > 0$ with the same assumptions.

  Let us then look at any two-particle state that minimizes the movement term.  In particular, it takes the form
  \begin{equation}
    \ket{\overline{\phi}} = \sum_{\alpha,\beta,x,z\in \FF_2} Q_{\alpha,\beta}^{x,z} \ket{\psi_{x,\alpha},-}\ket{\psi_{z,\beta},-}.
  \end{equation}
  Additionally, let us define the related two-particle state on $g_0$ as
  \begin{equation}
     \ket{\phi} = \sum_{\alpha,\beta,x,z\in \FF_2} Q_{\alpha,\beta}^{x,z} \ket{\psi_{x,\alpha}}\ket{\psi_{z,\beta}}.
  \end{equation}
  
  We can then see what the expectation of the interaction term of the Hamiltonian is under the state $\ket{\overline{\phi}}$: 
  \begin{align}
    \bra{\overline{\phi}} H_\text{int} \ket{\overline{\phi}} &= \sum_{u,v\in V(G_U^{(a,b),(c,d))}} \bra{\overline{\phi}} U_{d(u,v)}(\hat{n}_u,\hat{n}_v) \ket{\overline{\phi}}\\
      &= \sum_{u,v\in V(g_0),d_1,d_2\in \FF_2} \bra{\overline{\phi}} U_{d((u,d_1),(v,d_2))}(\hat{n}_{(u,d_1)},\hat{n}_{(v,d_2)}) \ket{\overline{\phi}}\\
      &\geq \sum_{u,v\in V(g_0),d_1\in \FF_2} \bra{\overline{\phi}} U_{d(u,v)} (\hat{n}_{(u,d_1)},\hat{n}_{(v,d_1)}) \ket{\overline{\phi}}
  \end{align}
  where in the third line we only count the contributions to the interaction when both particles are in the same copy of $g_0$.  As the interaction is positive-semidefinite, this can only decrease the expectation.  
  
  Now, from the form of $\ket{\overline{\phi}}$, we have that for any two $u,v\in V(g_0)$ and either copy of $g_0$,
  \begin{align}
    &\bra{\overline{\phi}} U_{d(u,v)} (\hat{n}_{(u,d_1)},\hat{n}_{(v,d_1)}) \ket{\overline{\phi}} \nonumber\\
    &\quad = \sum_{\substack{x_1,x_2,z_1,z_2\in\FF_2\\\alpha_1,\alpha_2,\beta_1,\beta_2\in\FF_2}}
    (Q_{\alpha_1,\beta_1}^{x_1,z_1})^* Q_{\alpha_2,\beta_2}^{x_2,z_2} \bra{\overline{\psi_{x_1,\alpha_1}}}\bra{\overline{\psi_{z_1,\beta_1}}} U_{d(u,v)}(\hat{n}_{(u,d_1)},\hat{n}_{(v,d_1)}) \ket{\overline{\psi_{x_2,\alpha_2}}}\ket{\overline{\psi_{z_2,\beta_2}}}\\
    &\quad \geq \big|\braket{d_1}{-}\big|^4\sum_{\substack{x_1,x_2,z_1,z_2\in\FF_2\\\alpha_1,\alpha_2,\beta_1,\beta_2\in\FF_2}}
    (Q_{\alpha_1,\beta_1}^{x_1,z_1})^* Q_{\alpha_2,\beta_2}^{x_2,z_2} \bra{\psi_{x_1,\alpha_1}}\bra{\psi_{z_1,\beta_2}} U_{d(u,v)}(\hat{n}_{u},\hat{n}_{v}) \ket{\psi_{x_2,\alpha_2}}\ket{\psi_{z_2,\beta_2}}\\
    &\quad = \frac{1}{4} \bra{\phi} U_{d(u,v)}(\hat{n}_u,\hat{n}_v)\ket{\phi}.
  \end{align}
  Hence, we have that
  \begin{align}
    \bra{\overline{\phi}} H_{\text{int}} \ket{\overline{\phi}}& \geq  \sum_{u,v\in V(g_0),d_1\in \FF_2} \bra{\overline{\phi}} U_{d(u,v)} (\hat{n}_{(u,d_1)},\hat{n}_{(v,d_1)}) \ket{\overline{\phi}}\\
     &\geq \frac{1}{4} \sum_{u,v\in V(g_0), d_1\in \FF_2} \bra{\phi} U_{d(u,v)}(\hat{n}_u,\hat{n}_v) \ket{\phi}\\
     &= \frac{1}{4} \sum_{d_1\in \FF_2} \bra{\phi} H_{\text{int}} \ket{\phi}\\
     &= \frac{1}{2} \bra{\phi} H_{\text{int}} \ket{\phi}\label{eq:g0_and_diagram_element_relation}.
  \end{align}
  Using \lem{2particle}, we have that \eq{g0_and_diagram_element_relation} is larger than zero for all states $\ket{\phi}$, and for all interactions that satisfy the conditions of \lem{2particle}, $\bra{\overline{\phi}} H_{\text{int}} \ket{\overline{\phi}} >0$.  As such, there does not exist a two-particle frustration free state on the graph $g_U^{(a,b),(c,d)}$ for the same interactions as $g_0$.

\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Gate diagrams}\label{sec:gate_diagrams}

While the diagram elements do have nice properties, we will eventually want to construct larger graphs using the diagram elements as basic elements.  Further, as the diagram elements themselves are rather complicated graphs, it will be useful to have a diagrammatic construction for these graphs:  these shall be the gate diagrams.

The rules for constructing gate diagrams are simple. A gate diagram consists of some number $R \in \{1,2,\ldots\}$ of diagram elements, with self-loops attached to a subset $\mathcal{S}$ of the nodes and edges connecting a set $\mathcal{E}$ of pairs of nodes. A node may have a single edge or a single self-loop attached to it, but never more than one edge or self-loop and never both an edge and a self-loop. Each node in a gate diagram has a label $(q,z,t)$ where $q \in [R]$ indicates the diagram element it belongs to. An example is shown in \fig{simple_gate_diagram}.

Sometimes it is convenient to draw the input nodes on the right-hand side of a diagram element; e.g., in \fig{W_gadget} the node closest to the top left corner is labeled $(q,z,t)=(3,0,4k+3)$.

\begin{figure}
\centering 
\tikzsetnextfilename{MP_simple_gate_diagram}
\input{../tikz/MP_simple_gate_diagram.tex}
\caption{A gate diagram with two diagram elements labeled $q=1$ (left) and $q=2$ (right).
\label{fig:simple_gate_diagram}}
\end{figure}

To every gate diagram we associate a \emph{gate graph} $G$ with
vertex set 
\begin{equation}
\left\{ (q,z,t,j,d)\colon q\in[R],\, z,d\in\FF_2,\, t\in[8k],\, j\in [8]\right\} 
\end{equation}
and adjacency matrix 
\begin{align}
A(G) & =\sum_{q\in [R]} \ketbra{q}{q}\otimes A(G_q)+h_{\mathcal{S}}+h_{\mathcal{E}}\label{eq:adj_gate_graph}\\
A(G_q) &= A(G_{U_q}^{(a_q,b_q),(c_q,d_q)})\\
h_{\mathcal{S}} & =\sum_{\mathcal{S}}|q,z,t\rangle\langle q,z,t|\otimes\II_{8} \otimes \II_2\label{eq:h_loops}\\
h_{\mathcal{E}} & =\sum_{\mathcal{E}}\left(|q,z,t\rangle+|q^{\prime},z^{\prime},t^{\prime}\rangle\right)\left(\langle q,z,t|+\langle q^{\prime},z^{\prime},t^{\prime}|\right)\otimes\II_{8}\otimes \II_2.\label{eq:h_edges}
\end{align}
The sums in equations \eq{h_loops} and \eq{h_edges} run over the set of nodes with self-loops $(q,z,t)\in\mathcal{S}$ and the set of pairs of nodes connected by edges $\{(q,z,t),(q^{\prime},z^{\prime},t^{\prime})\}\in\mathcal{E}$, respectively. We see from the above expression that each self-loop in the gate diagram corresponds to $16$ self-loops in the graph $G$, and an edge in the gate diagram corresponds to $16$ edges and $32$ self-loops in $G$.  Note that we can determine the type of each diagram element from the gate diagram, as the implemented unitary and number of nodes is encoded in the diagram.

As a node in a gate graph never has more than one edge or self-loop attached to it, equations \eq{h_loops} and \eq{h_edges} are sums of orthogonal Hermitian operators.  Therefore 
\begin{align}
\left\Vert h_{\mathcal{S}}\right\Vert  & =\max_{\mathcal{S}}\left\Vert |q,z,t\rangle\langle q,z,t|\otimes\II_{j}\right\Vert =1\quad\text{if }\mathcal{S}\neq\emptyset\label{eq:h_S_bound}\\
\left\Vert h_{\mathcal{E}}\right\Vert  & =\max_{\mathcal{E}}\left\Vert \left(|q,z,t\rangle+|q^{\prime},z^{\prime},t^{\prime}\rangle\right)\left(\langle q,z,t|+\langle q^{\prime},z^{\prime},t^{\prime}|\right)\otimes\II_{j}\right\Vert =2\quad\text{if }\mathcal{E}\neq\emptyset\label{eq:h_E_bound}
\end{align}
for any gate graph. (Of course, this also shows that $\|{h_{\mathcal{S}^\prime}}\|=1$ and $\|{h_{\mathcal{E}^\prime}}\|=2$ for any nonempty subsets $\mathcal{S}^\prime\subseteq \mathcal{S}$ and $\mathcal{E}^\prime\subseteq \mathcal{E}$.)

Consider the adjacency matrix $A(G)$ of a gate graph $G$, and note (from equation \eq{adj_gate_graph} that its smallest eigenvalue $\mu(G)$ satisfies
\begin{equation}
\mu(G)\geq e_{1}
\end{equation}
since $h_{\mathcal{S}}$ and $h_{\mathcal{E}}$ are positive semidefinite and $A(g_{U}^{(a,b),(c,d)})$ has smallest eigenvalue $e_{1}$. In the special case where $\mu(G)=e_{1}$, we say $G$ is an $e_{1}$-gate graph.

\begin{definition}
An $e_{1}$-gate graph is a gate graph $G$ such that the smallest eigenvalue of its adjacency matrix is $e_{1}=-1-3\sqrt{2}$.
\end{definition}

When $G$ is an $e_{1}$-gate graph, a single-particle ground state $|\Gamma\rangle$ of $A(G)$ satisfies 
\begin{align}
\left(\sum_{q\in [R]} \ketbra{q}{q} \otimes A(G_q)\right)|\Gamma\rangle & =e_{1}|\Gamma\rangle\label{eq:Gamma_disc}\\
h_{\mathcal{S}}|\Gamma\rangle & =0\label{eq:h_s_0}\\
h_{\mathcal{E}}|\Gamma\rangle & =0.\label{eq:h_e_0}
\end{align}
Indeed, to show that a given gate graph $G$ is an $e_{1}$-gate graph, it suffices to find a state $|\Gamma\rangle$ satisfying these conditions. Note that equation \eq{Gamma_disc} implies that $|\Gamma\rangle$ can be written as a superposition of the states
\begin{equation}
  |\overline{\psi_{z,a}^{q}}\rangle=|q\rangle|\overline{\psi_{z,a}}\rangle,\quad
  z,a\in \FF_2, q\in[R]
\end{equation}
where $|\overline{\psi_{z,a}}\rangle$ is given by equations \eq{psi0m} and \eq{psi1m} under the transform of \eq{phi_copy_transform}. The coefficients in the superposition are then constrained by equations \eq{h_s_0} and \eq{h_e_0}.


\todo{fix frustration free stuff}

%
%\subsubsection{Frustration-free states for a given interaction range}
%

% 
%\begin{example}\label{ex:As-an-example}
%As an example, we show the gate graph in \fig{simple_gate_diagram} is an $e_{1}$-gate graph. As noted above, equation \eq{Gamma_disc} lets us restrict our attention to the space spanned by the eight states $|\psi_{z,a}^{q}\rangle$ with $z,a\in \{0,1\}$ and $q\in \{1,2\}$. In this basis, the operators $h_{\mathcal{S}}$ and $h_{\mathcal{E}}$ only have nonzero matrix elements between states with the same value of $a\in\{0,1\}$. We therefore solve for the $e_{1}$ energy ground states with $a=0$ and those with $a=1$ separately. Consider a ground state of the form
%\begin{equation}
%\left(\tau_{1}|\psi_{0,a}^{1}\rangle+\nu_{1}|\psi_{1,a}^{1}\rangle\right)+\left(\tau_{2}|\psi_{0,a}^{2}\rangle+\nu_{2}|\psi_{1,a}^{2}\rangle\right)
%\end{equation}
%and note that in this case \eq{h_s_0} implies $\tau_{1}=0$. Equation \eq{h_e_0} gives
%\begin{equation}
%\begin{pmatrix}
%\tau_{2}\\
%\nu_{2}
%\end{pmatrix}=\begin{cases}
%HT\begin{pmatrix}
%-\tau_{1}\\
%-\nu_{1}
%\end{pmatrix} & a=0\\
%(HT)^{*}\begin{pmatrix}
%-\tau_{1}\\
%-\nu_{1}
%\end{pmatrix} & a=1.
%\end{cases}
%\end{equation}
%We find two orthogonal $e_{1}$-energy states, which are (up to normalization)
%\begin{align}
%|\psi_{1,0}^{1}\rangle-\frac{e^{i\frac{\pi}{4}}}{\sqrt{2}}\left(|\psi_{0,0}^{2}\rangle-|\psi_{1,0}^{2}\rangle\right)\label{eq:example_ffstate_1}\\
%|\psi_{1,1}^{1}\rangle-\frac{e^{-i\frac{\pi}{4}}}{\sqrt{2}}\left(|\psi_{0,1}^{2}\rangle-|\psi_{1,1}^{2}\rangle\right) & .\label{eq:example_ffstate_2}
%\end{align}
%We interpret each of these states as encoding a qubit that is transformed at each set of input/output nodes in the gate diagram in \fig{simple_gate_diagram}. The encoded qubit begins on the input nodes of the first diagram element in the state 
%\begin{equation}
%\begin{pmatrix}
%\tau_{1}\\
%\nu_{1}
%\end{pmatrix}=\begin{pmatrix}
%0\\
%1
%\end{pmatrix}
%\end{equation}
%because the self-loop penalizes the basis vectors $|\psi_{0,a}^{1}\rangle$. On the output nodes of diagram element $1$, the encoded qubit is in the state where either $HT$ (if $a=0$) or its complex conjugate (if $a=1$) has been applied. The edges in the gate diagram ensure that the encoded qubit on the input nodes of diagram element 2 is minus the state on the output nodes of diagram element $1$.
%\end{example}
%
%In this example, each single-particle ground state encodes a single-qubit computation. Later we show how $N$-particle frustration-free states on $e_{1}$-gate graphs can encode computations on $N$ qubits. Recall from \defn{FF_states} that a state $|\Gamma\rangle\in\mathcal{Z}_{N}(G)$ is said to be frustration free iff $H(G,N)|\Gamma\rangle=0.$ Note that $H(G,N)\geq0$, so an $N$-particle frustration-free state is necessarily a ground state. Putting this together with \lem{increase_part_number}, we see that the existence of an $N$-particle frustration-free state implies
%\begin{equation}
%\lambda_{N}^{1}(G)=\lambda_{N-1}^{1}(G)=\ldots=\lambda_{1}^{1}(G)=0,
%\end{equation}
%i.e., there are $N^{\prime}$-particle frustration-free states for all $N^{\prime}\leq N$. 
%
%
%
%
%We now characterize the space of $N$-particle frustration-free states on an $e_{1}$-gate graph $G$. Define the subspace $\mathcal{I}(G,N)\subset\mathcal{Z}_{N}(G)$ where each particle is in a ground state of $A(g_{0})$ and no two particles are located within the same diagram element: 
%\begin{equation}
%  \mathcal{I}(G,N)=\spn\{
%  \Sym(|\psi_{z_{1},a_{1}}^{q_{1}}\rangle
%  % |\psi_{z_{2},a_{2}}^{q_{2}}\rangle
%  \ldots|\psi_{z_{N},a_{N}}^{q_{N}}\rangle)\colon 
%  z_{i},a_{i}\in\{0,1\},\; q_{i}\in[R],\; 
%  q_{i}\neq q_{j}\;\text{whenever}\; i\neq j\}.\label{eq:Ign}
%\end{equation}
%
%\begin{lemma}\label{lem:FF_characterization}
%Let $G$ be an $e_{1}$-gate graph. A state $|\Gamma\rangle\in\mathcal{Z}_{N}(G)$ is frustration free if and only if 
%\begin{align}
%\left(A(G)-e_{1}\right)^{(w)}|\Gamma\rangle & =0\;\text{ for all }w\in[N]\label{eq:ff_condition1}\\
%|\Gamma\rangle & \in\mathcal{I}(G,N).\label{eq:ff_condition2}
%\end{align}
%\end{lemma}
%
%\begin{proof}
%First suppose that equations \eq{ff_condition1} and \eq{ff_condition2} hold. From \eq{ff_condition2} we see that $|\Gamma\rangle$ has no support on states where two or more particles are located at the same vertex. Hence 
%\begin{equation}
%\sum_{k\in V}\hat{n}_{k}\left(\hat{n}_{k}-1\right)|\Gamma\rangle=0.\label{eq:ff_condition3}
%\end{equation}
%Putting together equations \eq{ff_condition1} and \eq{ff_condition3}, we get 
%\begin{equation}
%H(G,N)|\Gamma\rangle=\left(H_{G}^{N}-Ne_{1}\right)|\Gamma\rangle=0,
%\end{equation}
%so $|\Gamma\rangle$ is frustration free.
%
%To complete the proof, we show that if $|\Gamma\rangle$ is frustration free, then conditions \eq{ff_condition1} and \eq{ff_condition2} hold. By definition, a frustration-free state $|\Gamma\rangle$ satisfies 
%\begin{equation}
%H(G,N)|\Gamma\rangle=\left(\sum_{w=1}^{N}\left(A(G)-e_{1}\right)^{(w)}+\sum_{k\in V}\hat{n}_{k}\left(\hat{n}_{k}-1\right)\right)|\Gamma\rangle=0.\label{eq:defn_frustr}
%\end{equation}
%Since both terms in the large parentheses are positive semidefinite, they must both annihilate $|\Gamma\rangle$ (similarly, each term in the first summation must be zero). Hence equation \eq{ff_condition1} holds. Let $G_{\mathrm{rem}}$ be the graph obtained from $G$ by removing all of the edges and self-loops in the gate diagram of $G$. In other words,
%\begin{equation}
%A(G_{\mathrm{rem}})=\sum_{q=1}^{R}|q\rangle\langle q|\otimes A(g_{0})=\II\otimes A(g_{0}).
%\end{equation}
%Noting that 
%\begin{equation}
%H(G,N)\geq H(G_{\mathrm{rem}},N)\geq0,
%\end{equation}
%we see that equation \eq{defn_frustr} also implies 
%\begin{equation}
%H(G_{\mathrm{rem}},N)|\Gamma\rangle=0.\label{eq:Grem_gamma}
%\end{equation}
%Since each of the $R$ components of $G_{\mathrm{rem}}$ is an identical copy of $g_{0}$, the eigenvalues and eigenvectors of $H(G_{\mathrm{rem}},N)$ are characterized by \lem{BH_disconnected_graphs} (along with knowledge of the eigenvalues and eigenvectors of $g_{0}$). By \lem{2particle} and \lem{increase_part_number}, no component has a two- (or more) particle frustration-free state. Combining these two facts, we see that in an $N$-particle frustration-free state, every component of $G_{\mathrm{rem}}$ must contain either $0$ or $1$ particles, and the nullspace of $H(G_{\mathrm{rem}},N)$ is the space $\mathcal{I}(G,N).$ From equation \eq{Grem_gamma} we get $|\Gamma\rangle\in\mathcal{I}(G,N)$.
%\end{proof}
%
%Note that if $\mathcal{I}(G,N)$ is empty then \lem{FF_characterization} says that $G$ has no $N$-particle frustration-free states. For example, this holds for any $e_{1}$-gate graph $G$ whose gate diagram has $R<N$ diagram elements.
%
%A useful consequence of \lem{FF_characterization} is the fact that every $k$-particle reduced density matrix of an $N$-particle frustration-free state $|\Gamma\rangle$ on an $e_{1}$-gate graph $G$ (with $k\leq N$) has all of its support on $k$-particle frustration-free states. To see this, note that for any partition of the $N$ registers into subsets $A$ (of size $k$) and $B$ (of size $N-k$), we have
%\begin{equation}
%\mathcal{I}(G,N)\subseteq\mathcal{I}(G,k)_{A}\otimes\mathcal{Z}_{N-k}(G)_{B}.
%\end{equation}
%Thus, if condition \eq{ff_condition2} holds, then all $k$-particle reduced density matrices of $|\Gamma\rangle$ are contained in $\mathcal{I}(G,k)$. Furthermore, \eq{ff_condition1} is a statement about the single-particle reduced density matrices, so it also holds for each $k$-particle reduced density matrix. From this we see that each reduced density matrix of $|\Gamma\rangle$ is frustration free.


\subsection{Gadgets}

In \ex{As-an-example} we saw how a single-particle ground state can encode a single-qubit computation. In this Section we see how a two-particle frustration-free state on a suitably designed $e_{1}$-gate graph can encode a two-qubit computation. We design specific $e_{1}$-gate graphs (called \emph{gadgets}) that we use in \sec{From-circuits-to} to prove that these ground state problems for the MPQW are QMA-hard. For each gate graph we discuss, we show that the smallest eigenvalue of its adjacency matrix is $e_{1}$ and we solve for all of the frustration-free states.

We first design a gate graph where, in any two-particle frustration-free state, the locations of the particles are synchronized.  We then design gadgets for two-qubit gates using four move-together gadgets, one for each two-qubit computational basis state. Finally, we describe a small modification of a two-qubit gate gadget called the ``boundary gadget.''

In important piece of these gadgets will be the inclusion of $\II_{(1,0)}^{(1,0)}$ diagram elements to separate the locations of particles.  With these separations, we will only ever need to analyze the case when particles occupy the same diagram element, as these identity elements ensure that for the states that we care about, particles are always located at a distance of at least $\dmax$.

\subsubsection{The move-together gadget}



The gate diagram for the \emph{move-together gadget} is shown in \fig{W_gadget}. Using equation \eq{adj_gate_graph}, we write the adjacency matrix of the corresponding gate graph $G_W$ as 
\begin{equation}
A(G_W)=\sum_{q=1}^{14}|q\rangle\langle q|\otimes A(G_q)+h_{\mathcal{E}}\label{eq:move_together_adj}
\end{equation}
where
\begin{equation}
  G_q = \begin{cases}
    G_H^{(2,2),(1,1)} & q \in \{1,2\}\\
    G_\II^{(1,1),(0,0)} & q\in \{3,4,5,6\}\\
    G_\II^{(1,0),(1,0)} & q > 6,
  \end{cases}
\end{equation}
$h_{\mathcal{E}}$ is given by \eq{h_edges}, $h_{\mathcal{S}}$ is given by \eq{h_loops},  $\mathcal{E}$ is the set of edges in the gate diagram, and $\mathcal{S}$ is the set of self-loops in the diagram.

\begin{figure}
\centering 
\subfloat[][]{
\tikzsetnextfilename{MP_W_gadget}
\input{../tikz/MP_W_gadget.tex}
\label{fig:W_gadget_gate_diagram}}
\hspace{1cm}
\subfloat[][]{
\tikzsetnextfilename{MP_W_gadget_schematic}
\input{../tikz/MP_W_gadget_schematic.tex}
\label{fig:W_gadget_gate_schematic}}
\caption{\subfig{W_gadget_gate_diagram} The gate diagram for the move-together gadget.  Note the four labeled nodes, $\alpha$, $\beta$, $\gamma$, and $\delta$, which have no attached edges.  \subfig{W_gadget_gate_schematic} A schematic representation for a move-together gadget, with the four labeled nodes corresponding to the four labeled nodes of \subfig{W_gadget_gate_diagram}. \label{fig:W_gadget}} 
\end{figure}

We begin by solving for the single-particle ground states, i.e., the eigenvectors of \eq{move_together_adj} with eigenvalue $e_{1}=-1-3\sqrt{2}$. As in \ex{As-an-example}, we can solve for the states with $a=0$ and $a=1$ separately, since
\begin{equation}
  \langle\psi_{x,1}^{j}|h_{\mathcal{E}}|\psi_{z,0}^{i}\rangle=0
\end{equation}
for all $i,j\in[14]$ and $x,z\in \FF_2$. We write a single-particle ground state as
\begin{equation}
  \sum_{i=1}^{14}\left(\tau_{i}|\psi_{0,a}^{i}\rangle+\nu_{i}|\psi_{1,a}^{i}\rangle\right)
\end{equation}
and solve for the coefficients $\tau_{i}$ and $\nu_{i}$ using equation \eq{h_e_0}.  Enforcing \eq{h_s_0} gives us that $\nu_i = 0$ for all $i>6$. Enforcing \eq{h_e_0} gives sixteen equations, one for each edge in the gate diagram:
\begin{align}
  \tau_{3}&=-\tau_{7} & 
  \tau_{7}&= - \tau_{1}&
  \frac{1}{\sqrt{2}}(\tau_{1}+\nu_{1})&=-\tau_{11}&
  \tau_{11} &= -\tau_{6} \\
  \nu_{3} &= -\tau_{9}&
  \tau_{9} &= -\tau_{2} &
  \frac{1}{\sqrt{2}}(\tau_{2}+\nu_{2})&=-\tau_{13}&
  \tau_{13} &= - \nu_{5}\\
  \tau_{4}&=-\tau_{8} & 
  \tau_{8}&=-\nu_{1} &
  \frac{1}{\sqrt{2}}(\tau_{1}-\nu_{1})&=-\tau_{12} &
  \tau_{12} &= - \tau_{5}\\
  \nu_{3}&=-\tau_{10} & 
  \tau_{10} &= - \nu_{2} &
  \frac{1}{\sqrt{2}}(\tau_{2}-\nu_{2})&=-\tau_{14}&
  \tau_{14} &= - \nu_{6}  .
\end{align}
Similarly, enforcing \eq{h_s_0} gives eight equations, namely that $\nu_q = 0$ for $q>6$.  There are four linearly independent solutions to this set of equations, given by 
\begin{align}
  \text{\emph{Solution 1:}} && 
    \tau_{1} = \tau_{3} = -\tau_{7} &=1 & 
    \tau_{5} =  \tau_{6} = -\tau_{11} = - \tau_{12} &=\frac{1}{\sqrt{2}} &&
    \text{all other coefficients }0 \\
  \text{\emph{Solution 2:}} && 
    \nu_{1} = \tau_{4} = -\tau_{8} &=1 &
    -\tau_{5} =  \tau_{6} = -\tau_{11} = \tau_{12} &= \frac{1}{\sqrt{2}} &&
    \text{all other coefficients }0 \\
  \text{\emph{Solution 3:}} && 
    \nu_{2} = \nu_{4} = -\tau_{10} &= 1 &
    \nu_{5} = -\nu_{6} = -\tau_{13} = \tau_{14} &= \frac{1}{\sqrt{2}} &&
    \text{all other coefficients }0 \\
  \text{\emph{Solution 4:}} && 
    \tau_{2} =  \nu_{3} = -\tau_{9} &= 1 &
    \nu_{5} =  \nu_{6} = -\tau_{13} = -\tau_{14} &=\frac{1}{\sqrt{2}} &&
    \text{all other coefficients }0.
\end{align}
For each of these solutions, and for each $a\in\{0,1\}$, we find a single-particle state with energy $e_1$. This result is summarized in the following Lemma.

\begin{lemma}
$G_{W}$ is an $e_{1}$-gate graph. A basis for the eigenspace
of $A(G_{W})$ with eigenvalue $e_1$ is 
\begin{align}
  \ket{\chi_{1,a}} & =\frac{1}{\sqrt{5}}\big(\ket{\psi_{0,a}^{1}} + \ket{\psi_{0,a}^3} - \ket{\psi_{0,a}^7}\big) 
    +\frac{1}{\sqrt{10}}\big(\ket{\psi_{0,a}^{5}} + \ket{\psi_{0,a}^6} - \ket{\psi_{0,a}^{11}} - \ket{\psi_{0,a}^{12}}\big)\label{eq:chi_alpha}\\
  |\chi_{2,a}\rangle & =\frac{1}{\sqrt{5}}\big(\ket{\psi_{1,a}^{1}} + \ket{\psi_{0,a}^4} - \ket{\psi_{0,a}^8}\big) 
    +\frac{1}{\sqrt{10}}\big(-\ket{\psi_{0,a}^{5}} + \ket{\psi_{0,a}^6} - \ket{\psi_{0,a}^{11}} + \ket{\psi_{0,a}^{12}}\big)\label{eq:chi_beta}\\
  |\chi_{3,a}\rangle & =\frac{1}{\sqrt{5}}\big(\ket{\psi_{1,a}^{2}} + \ket{\psi_{1,a}^4} - \ket{\psi_{0,a}^{10}}\big) 
    +\frac{1}{\sqrt{10}}\big(\ket{\psi_{1,a}^{5}} - \ket{\psi_{1,a}^6} - \ket{\psi_{0,a}^{13}} + \ket{\psi_{0,a}^{14}}\big)\label{eq:chi_gamma}\\
|\chi_{4,a}\rangle & =\frac{1}{\sqrt{5}}\big(\ket{\psi_{0,a}^{2}} + \ket{\psi_{1,a}^3} - \ket{\psi_{0,a}^{9}}\big) 
    +\frac{1}{\sqrt{10}}\big(\ket{\psi_{1,a}^{5}} + \ket{\psi_{1,a}^6} - \ket{\psi_{0,a}^{13}} - \ket{\psi_{0,a}^{14}}\big)\label{eq:chi_delta}
\end{align}
where $a\in\FF_2$. 
\end{lemma}

In \fig{W_gadget} we have used a shorthand $\alpha,\beta,\gamma,\delta$ to identify four nodes of the move-together gadget; these are the nodes with labels $(q,z,t)=(1,0,0),(1,1,3k),(2,1,3k),(2,0,0)$, respectively. We view $\alpha$ and $\gamma$ as ``input'' nodes and $\beta$ and $\delta$ as ``output'' nodes for this gate diagram. It is natural to associate each single-particle state $|\chi_{i,a}\rangle$ with one of these four nodes.  We also associate the set of 16 vertices represented by the node with the corresponding node, e.g.,
\begin{equation}
  S_{\alpha}=\left\{ (1,0,0,j,d)\colon j\in[8], d\in \FF_2\right\} .
\end{equation}
Looking at equation \eq{chi_alpha} (and perhaps referring back to equation \eq{psi0m}) we see that $|\chi_{1,a}\rangle$ has support on vertices in $S_{\alpha}$ but has no support on vertices in $S_{\beta}$, $S_{\gamma}$, or $S_{\delta}$. Looking at the picture on the right-hand side of the equality sign in \fig{W_gadget}, we think of $|\chi_{1,a}\rangle$ as localized at the node $\alpha$, with no support on the other three nodes. The states $|\chi_{2,a}\rangle,|\chi_{3,a}\rangle,|\chi_{4,a}\rangle$ are similarly localized at nodes $\beta,\gamma,\delta$. We view $|\chi_{1,a}\rangle$ and $|\chi_{3,a}\rangle$ as input states and $|\chi_{2,a}\rangle$ and $|\chi_{4,a}\rangle$ as output states for the move-together gadget.

Now we turn our attention to the two-particle frustration-free states of the move-together gadget, i.e., the states $|\Phi\rangle\in\HHH(G_{W})^{\otimes 2}$ in the nullspace of $H(G_W,2)$. As $\lambda_2^1(G_{U}) >0$ for all $U$ from \lem{2particle_element_bound}, we have that any such state must take the form
\begin{equation}
|\Phi\rangle=\sum_{a,b \in \{0,1\},\,I,J \in [4]}C_{(I,a),(J,b)}|\chi_{I,a}\rangle|\chi_{J,b}\rangle\label{eq:chi_superposition}
\end{equation}
where 
\begin{equation}
\langle\psi_{z,a}^{q}|\langle\psi_{x,b}^{q}|\Phi\rangle=0\label{eq:frustration_free}
\end{equation}
for all $z,a,x,b\in\FF_2$ and $q\in[14]$, and if $\dmax = 0$, where the coefficients are symmetric, i.e.,
\begin{equation}
C_{(I,a),(J,b)}=C_{(J,b),(I,a)},\label{eq:symmetric_coefs}.
\end{equation}  
Note that this does not guarantee that the state is frustration-free, merely that these are necessary conditions for the state to be frustration free.  

However, in the construction of the $G_W$ gadget, we placed the $H_{(1,0)}^{(1,1)}$ elements specifically to ensure that the two-particle states were separated by a distance of at least $k > \dmin$.  If we can ensure that the state $\ket{\Phi}$ has no support on pairs of diagram elements that are closer than $k > \dmax$, then we can guarantee that $\ket{\Phi}$ is frustration-free.

The move-together gadget is designed so that each solution $|\Phi\rangle$ to these equations  is a superposition of a term where both particles are in input states and a term where both particles are in output states. The particles move from input nodes to output nodes together. We now solve equations \eq{chi_superposition}--\eq{frustration_free} and prove the following.

\begin{lemma}
\label{lem:Wgadget_lemma}
A basis for the nullspace of $H(G_{W},2)$ is 
\begin{equation}
  |\Phi_{a,b}^{\pm}\rangle= \frac{1}{2} \big( |\chi_{1,a}\rangle|\chi_{3,b}\rangle \pm \ket{\chi_{3,b}}{\ket{\chi_{1,a}}} 
  + |\chi_{2,a}\rangle|\chi_{4,b}\rangle \pm \ket{\chi_{4,b}}\ket{\chi_{2,a}}\big),\quad a,b\in \FF_2\label{eq:phi_a1_a2}
\end{equation}
for $\dmax > 0$, and if $\dmax = 0$ a basis for the nullspace of $H(G_{W},2)$ when restricted to symmetric states is $\ket{\Phi_{a,b}^+}$ for $a,b\in \FF_2$.  

There are no $N$-particle frustration-free states on $G_{W}$ for $N\geq3$ for any $\dmax$, i.e.,
\begin{equation}
\lambda_{N}^{1}(G_{W})>0\quad\text{for }N\geq3.
\end{equation}
\end{lemma}

\begin{proof}
The states $|\Phi_{a,b}\rangle$ manifestly satisfy equations \eq{chi_superposition}, and one can directly verify that they also satisfy \eq{frustration_free} (the nontrivial cases to check are for $q=5$, $q=6$, and $q>10$).  Additionally, one can also directly verify that $\ket{\Phi_{a,b}}$ has no support on states for which the two particles are located on diagram elements closer than $k$, and thus the state is in the ground space of the interaction Hamiltonian.

To complete the proof that \eq{phi_a1_a2} is a basis for the nullspace of $H(G_W,2)$, we verify that any state satisfying these conditions must be a linear combination of these four states. Applying equation \eq{frustration_free} to the first $4$ diagram elements gives
\begin{align}
\langle\psi_{0,a}^{1}|\langle\psi_{0,b}^{1}|\Phi\rangle & =\frac{1}{5} C_{(1,a),(1,b)}=0 &
\langle\psi_{1,a}^{1}|\langle\psi_{1,b}^{1}|\Phi\rangle & =\frac{1}{5} C_{(2,a),(2,b)}=0\\
\langle\psi_{1,a}^{2}|\langle\psi_{1,b}^{2}|\Phi\rangle & =\frac{1}{5} C_{(3,a),(3,b)}=0 &
\langle\psi_{0,a}^{2}|\langle\psi_{0,b}^{2}|\Phi\rangle & =\frac{1}{5} C_{(4,a),(4,b)}=0\\
\langle\psi_{0,a}^{1}|\langle\psi_{1,b}^{1}|\Phi\rangle & =\frac{1}{5} C_{(1,a),(2,b)}=0 &
\langle\psi_{0,a}^{2}|\langle\psi_{1,b}^{2}|\Phi\rangle & =\frac{1}{5} C_{(4,a),(3,b)}=0\\
\langle\psi_{1,a}^{1}|\langle\psi_{0,b}^{1}|\Phi\rangle & =\frac{1}{5} C_{(2,a),(1,b)}=0 &
\langle\psi_{1,a}^{2}|\langle\psi_{0,b}^{2}|\Phi\rangle & =\frac{1}{5} C_{(3,a),(4,b)}=0\\
\langle\psi_{0,a}^{3}|\langle\psi_{1,b}^{3}|\Phi\rangle & =\frac{1}{5} C_{(1,a),(4,b)}=0 &
\langle\psi_{0,a}^{4}|\langle\psi_{1,b}^{4}|\Phi\rangle & =\frac{1}{5} C_{(2,a),(3,b)}=0\\
\langle\psi_{1,a}^{3}|\langle\psi_{0,b}^{3}|\Phi\rangle & =\frac{1}{5} C_{(4,a),(1,b)}=0 &
\langle\psi_{1,a}^{4}|\langle\psi_{0,b}^{4}|\Phi\rangle & =\frac{1}{5} C_{(3,a),(2,b)}=0
\end{align}
for all $a,b\in \{0,1\}$. Using the fact that all of these coefficients are zero, we can then see that
\begin{align}
|\Phi\rangle=\sum_{\substack{a,b\in\FF_2\\ j\in [4]}}C_{(j,a),(j+2,b)}|\chi_{j,a}\rangle|\chi_{j+2,b}\rangle.
\end{align}
Finally, applying equation \eq{frustration_free} to diagram $6$ gives
\begin{align}
\langle\psi_{0,a}^{6}|\langle\psi_{1,b}^{6}|\Phi\rangle&=\frac{1}{6}C_{(2,a),(4,b)}-\frac{1}{6}C_{(1,a),(3,b)}=0\\
\langle\psi_{1,a}^{6}|\langle\psi_{0,b}^{6}|\Phi\rangle&=\frac{1}{6}C_{(4,a),(2,b)}-\frac{1}{6}C_{(3,a),(1,b)}=0.
\end{align}
Hence
\begin{equation}
|\Phi\rangle=\sum_{\substack{a,b\in\FF_2\\j\in[4]}}C_{(j,a),(j+2,b)}\big(|\chi_{j,a}\rangle|\chi_{j+2,b}\rangle+|\chi_{j+1,a}\rangle|\chi_{j+3,b}\rangle\big),
\end{equation}
which is a superposition of the states $|\Phi_{a,b}^\pm\rangle.$ 

Note that the above analysis holds completely if we restrict ourselves to symmetric states, and thus if $\dmax = 0$, we end up with the same results except that we only care about the states $\ket{\Phi_{a,b}^+}$, as they span the symmetric nullspace.

Finally, we prove that there are no frustration-free ground states of the Bose-Hubbard model on $G_{W}$ with more than two particles. By \lem{increase_part_number},
it suffices to prove that there are no frustration-free three-particle states.

Suppose (for a contradiction) that $|\Gamma\rangle\in\mathcal{H}(G_{W})^{\otimes 3}$ is a normalized three-particle frustration-free state. Write 
\begin{equation}
|\Gamma\rangle=\sum D_{(i,a),(j,b),(k,c)}|\chi_{i,a}\rangle|\chi_{j,b}\rangle|\chi_{k,c}\rangle.
\end{equation}
Note that each reduced density matrix of $|\Gamma\rangle$ on two of the three subsystems must have all of its support on two-particle frustration-free states (see the remark following \lem{FF_characterization}), i.e., on the states $|\Phi_{a,b}\rangle$. Using this fact for the subsystem consisting of the first two particles, we see in particular that
\begin{equation}
(i,j)\notin\{(1,3),(3,1),(2,4),(4,2)\}\quad\Longrightarrow\quad D_{(i,a),(j,b),(k,c)}=0\label{eq:ij_constraint1}
\end{equation}
(since $|\Phi_{a_1,a_2}\rangle$ only has support on vectors $|\chi_{i,a}\rangle|\chi_{j,b}\rangle$ with $i,j\in \{(1,3),(3,1),(2,4),(4,2)\}$).

Using this fact for subsystems consisting of particles $2,3$ and $1,3$, respectively, gives 
\begin{align}
(j,k)\notin\{(1,3),(3,1),(2,4),(4,2)\}\quad\Longrightarrow\quad D_{(i,a),(j,b),(k,c)} & =0\label{eq:ij_constraint2}\\
(i,k)\notin\{(1,3),(3,1),(2,4),(4,2)\}\quad\Longrightarrow\quad D_{(i,a),(j,b),(k,c)} & =0.\label{eq:ij_constraint3}
\end{align}
Putting together equations \eq{ij_constraint1}, \eq{ij_constraint2}, and \eq{ij_constraint3}, we see that $|\Gamma\rangle=0$. This is a contradiction, so no three-particle frustration-free states exist.
\end{proof}

With this gadget allowing us to entangle the locations of particles, we will be able to create a pseudo-history state, in which time is encoded in the location of particles.  This is the large workhorse of the construction, as it allows us to understand the multi-particle ground space by understanding the simple two-particle ground states.


%%%%%%%%%%%%%%%

\subsubsection{Two-qubit gate gadget}

We can now use the $W$-gadget as a building block to encode graphs with more interesting ground-state behavior.  In particular, we can use the $W$-gadget to force the two-particle state of a larger gadget to have entangled locations between the two particles.  If we then place connections in a particular manner, we can use these guarantees to force the ground state to encode a computation corresponding to a permutation of the computational basis states (such as a controlled not operation).  In particular, we will be to define a gate graph for each of the two-qubit unitaries
\begin{equation}
  \{\CNOT_{12}, \CNOT_{21}, \CNOT_{12}\left(H\otimes\II\right),
    \CNOT_{12}\left(HT\otimes\II\right)\}.
\end{equation}
Here $\CNOT_{12}$ is the standard controlled-not gate with the second qubit as a target, whereas $\CNOT_{21}$ has the first qubit as target.

We define the gate graphs by exhibiting their gate diagrams. For the three cases
\begin{equation}
  U=\CNOT_{12}(\tilde U\otimes\II)
\end{equation}
with $\tilde U\in\{\II,H,HT\}$, we associate $U$ with the gate diagram shown in \fig{GVucnotcomplete}. In \fig{GVucnot} we also indicate a shorthand used to represent this gate diagram. As one might expect, for the case $U=\CNOT_{21}$, we use the same gate diagram as for $U=\CNOT_{12}$; however, we use the slightly different shorthand shown in \fig{GVcnot}.

Roughly speaking, the two-qubit gate gadgets work as follows.  We can ignore the $16$ $\II_{(1,0)}^{(1,1)}$ diagram elements, as they exist to separate the locations of the particles, but otherwise there are four move-together gadgets, one for each two-qubit basis state $|00\rangle, |01\rangle, |10\rangle, |11\rangle$. These enforce the constraint that two particles must move through the graph together, while their connections to the four diagram elements labeled $1,2,3,4$ ensure that most of the frustration-free two-particle states encode two-qubit computations, while the connections between diagram elements $1,2,3,4$ and $5,6,7,8$ ensure that the remaining frustration-free two-particle states are removed from the ground space.

To describe the frustration-free states of the gate graph depicted in \fig{GVcnot_tot}, first recall the definition of the states $|\chi_{j,a}\rangle$ for $j\in [4]$  from equations \eq{chi_alpha}--\eq{chi_delta}. For each of the move-together gadgets $xy\in\{00,01,10,11\}$ in \fig{GVucnot}, write 
\begin{equation}
|\chi_{j,a}^{xy}\rangle
\end{equation}
for the state $|\chi_{j,a}\rangle$ with support (only) on the gadget labeled $xy$. Additionally, write 
\begin{equation}
  U^a=\begin{cases}
    U & \text{ if }a=0\\
    \overline{U} & \text{ if }a=1
  \end{cases}
\end{equation}
and similarly for $\tilde U$.  This notation will help us to define the ground states of the resulting Hamiltonian, as the encoded computation will change depending on $\alpha$.

\begin{figure}
\centering 
\subfloat[][]{
  \tikzsetnextfilename{MP_GVucnot_complete}
  \input{../tikz/MP_GVucnot_complete.tex}
  \vspace{0.63cm}
  \label{fig:GVucnotcomplete}}\\
\subfloat[][]{
  \tikzsetnextfilename{MP_GVucnot}
  \input{../tikz/MP_GVucnot.tex}
  \vspace{0.63cm}
  \label{fig:GVucnot}}
\subfloat[][]{
  \tikzsetnextfilename{MP_GVcnot}
  \input{../tikz/MP_GVcnot.tex}
  \label{fig:GVcnot}}
\caption{\subfig{GVucnotcomplete} Gadget for the
 two-qubit unitary $U=\CNOT_{12}(\tilde U\otimes\II)$ with $\tilde U\in \{1,H,HT\}$. \subfig{GVucnot} A schematic encoding for $U=\CNOT_{12}(\tilde U\otimes \II)$, where the eight labeled nodes correspond to the eight labeled nodes of \subfig{GVucnotcomplete}.
\subfig{GVcnot} For the $U=\CNOT_{21}$ gate (first qubit is the target), we use the same gate graph as in \subfig{GVucnot} with $\tilde U=1$, but with a different location for the eight labeled nodes.}
\label{fig:GVcnot_tot}
\end{figure}


We now show that $G_{U}$ is an $e_{1}$-gate graph and solves for its frustration-free states.

\begin{lemma}\label{lem:2qub_gate}
Let $U=\CNOT_{12}(\tilde U\otimes\II)$ where $\tilde U\in\{\II,H,HT\}$. The corresponding gate graph $G_U$ is defined by its gate diagram shown in \fig{GVucnotcomplete}. The adjacency matrix $A(G_U)$ has ground energy $e_{1}$; a basis for the corresponding eigenspace is
\begin{align}
  |\rho_{z,a}^{1,U}\rangle & =\frac{1}{\sqrt{15}}\Big(|\psi_{z,a}^{1}\rangle+|\psi_{z,a}^{5+z}\rangle - \ket{\psi_{z,a}^{25+z}}
  	+\sum_{x,y\in\FF_2}\tilde U^a_{yz}\big(\sqrt{5}  |\chi_{1,a}^{yx}\rangle-\ket{\psi_{0,a}^{9+x + 2y}} \big) \Big)\label{eq:rho1}\
 \\
  |\rho_{z,a}^{2,U}\rangle & = \frac{1}{\sqrt{15}}\Big(|\psi_{z,a}^{2}\rangle+|\psi_{z,a}^{6-z}\rangle -\ket{\psi_{z,a}^{29+z}}
  	+\sum_{x\in\FF_2} \big(\sqrt{5} |\chi_{2,a}^{zx}\rangle - \ket{\psi_{0,a}^{17+2z + x}}\big)\Big)\label{eq:rho2}\\
  |\rho_{z,a}^{3,U}\rangle & = \frac{1}{\sqrt{15}}\Big(|\psi_{z,a}^{3}\rangle+|\psi_{z,a}^{7}\rangle  -\ket{\psi_{z,a}^{27+z}}
  	+\sum_{x\in\FF_2}\big(\sqrt{5} |\chi_{3,a}^{xz}\rangle- \ket{\psi_{0,a}^{17+2z + x}}\big)\Big) \label{eq:rho3} \\
  |\rho_{z,a}^{4,U}\rangle & =\frac{1}{\sqrt{15}}\Big(|\psi_{z,a}^{4}\rangle+|\psi_{z,a}^{8}\rangle -\ket{\psi_{z,a}^{31+z}}
  	+\sum_{x\in\FF_2}\big(\sqrt{5}|\chi_{4,a}^{x\left(z\oplus x\right)}\rangle - \ket{\psi_{0,a}^{21+2z + x}}  \big)\Big)\label{eq:rho4}
\end{align}
where $z,a\in\FF_2$.
\end{lemma}
\begin{proof}
As the gate graph $G_U$ is specified by its gate diagram, shown in \fig{GVucnotcomplete}, the adjacency matrix of the gate graph $G_{U}$ is of the form in equation \eq{adj_gate_graph}. There are 14 diagram elements for each of the move-together gadgets, so there are $88$ diagram elements in total. We will need to refer to those diagram elements labeled $q\in [32]$ in \fig{GVucnotcomplete} (i.e., those not contained in the move-together gadgets).

Write 
\begin{equation}
  A(G_{U})=A(G_{U}^{\prime})+h_{\mathcal{E}^{\prime}}
\end{equation}
where $G_{U}^{\prime}$ is the gate graph obtained from $G_{U}$ by removing all $48$ edges shown in \fig{GVucnot} ($G_U^{\prime}$ does include the edges within each of the move-together gadgets along with the selfloops of $G_{U}$). Here $h_{\mathcal{E}^{\prime}}$ is given by equation \eq{h_edges} with $\mathcal{E^{\prime}}$ the set of $48$ edges shown in \fig{GVucnot}.

One basis for the $e_1$-energy ground space of $A(G_{U}^{\prime})$ is given by the $112$ states 
\begin{align}
  &|\psi_{z,a}^{q}\rangle,\quad q\in [32],\, z,a\in \FF_2 \\
  &|\chi_{j,a}^{xy}\rangle,\quad x,y,a\in\FF_2,\, j\in[4],
\end{align}
where we exclude $\ket{\psi_{1,a}^q}$ if $q > 8$ (as these states encounter a self-loop). It will be convenient to work with the following slightly rotated basis for this space:
\begin{align}
  &|\psi_{z,a}^{q}\rangle&&q\in[8],\, z,a\in \FF_2 \\
  & \sum_{x\in\FF_2} \tilde{U}^a_{xz}  \ket{\psi_{0,a}^{j + 2 x}}&& a,z\in\FF_2, j\in \{9,10\}\\
  & \ket{\psi_{0,a}^q}&&  a\in \FF_2, 13 \leq q \leq 32\\
  &\sum_{x\in \FF_2}\tilde{U}^a_{xz}|\chi_{1,a}^{xy}\rangle&& y,z,a\in\FF_2 \\
  &|\chi_{j,a}^{xy}\rangle&& x,y,a\in\FF_2,\, j\in \{2,3,4\}.
\end{align}
In this basis, some of the states are in a superposition corresponding to the output of the single-qubit unitary $\tilde U$.

We are interested in the intersection of the ground space of $A(G_U')$ with the nullspace of $h_{\mathcal{E}^{\prime}}$, so we compute the matrix elements of $h_{\mathcal{E}^{\prime}}$ in the above basis. The resulting $112\times 112$ matrix is block diagonal with sixteen $7\times 7$ blocks. Each block is identical, with entries
\begin{equation} \frac{1}{8k}
\begin{pmatrix}
  3 & 1 & 1 &1 & 0 & 0 & 0\\ 
  1 & 2 & 0 & 0 & \frac{1}{\sqrt{5}} & 0 & 0\\
  1 & 0 & 2 & 0 & 0 & \frac{1}{\sqrt{5}} & 0\\
  1 & 0 & 0 & 2 & 0 & 0 & 1\\
  0 & \frac{1}{\sqrt{5}} & 0 & 0 & \frac{1}{5} & 0 & 0\\
  0 & 0 & \frac{1}{\sqrt{5}} & 0 & 0 & \frac{1}{5} & 0\\
  0 & 0 & 0 & 1 & 0 & 0 & 1
\end{pmatrix}.\label{eq:three_by_three_blocks}
\end{equation}
The seven states involved in each block are given by (in order from left to right as in the matrix above):
\begin{align}
 & |\psi_{z,a}^{1}\rangle,  \sum_{x\in\FF_2} \tilde{U}^a_{xz}  \ket{\psi_{0,a}^{9 + 2 x}}, \sum_{x\in\FF_2} \tilde{U}^a_{xz}  \ket{\psi_{0,a}^{10 + 2 x}},
     \ket{\psi_{0,a}^{25+z}},\sum_{x\in\FF_2}\tilde{U}^a_{xz}|\chi_{1,a}^{x0}\rangle,\sum_{x\in\FF_2}\tilde{U}^a_{xz}|\chi_{1,a}^{x1}\rangle,|\psi_{z,a}^{5+z}\rangle\\
 & |\psi_{z,a}^{2}\rangle,\ket{\psi_{0,a}^{17+2z}}, \ket{\psi_{0,a}^{18+2z}}, \ket{\psi_{0,a}^{29+z}},|\chi_{2,a}^{z0}\rangle,|\chi_{2,a}^{z1}\rangle,|\psi_{z,a}^{6-z}\rangle\\
 & |\psi_{z,a}^{3}\rangle,\ket{\psi_{0,a}^{13+2z}}, \ket{\psi_{0,a}^{14+2z}}, \ket{\psi_{0,a}^{27+z}},|\chi_{3,a}^{0z}\rangle,|\chi_{3,a}^{1z}\rangle,|\psi_{z,a}^{7}\rangle\\
 & |\psi_{z,a}^{4}\rangle,\ket{\psi_{0,a}^{21+2z}}, \ket{\psi_{0,a}^{22+2z}}, \ket{\psi_{0,a}^{31+z}},|\chi_{4,a}^{0z}\rangle,|\chi_{4,a}^{1\left(z\oplus1\right)}\rangle,|\psi_{z,a}^{8}\rangle.
\end{align}

The unique zero eigenvector of the matrix \eq{three_by_three_blocks} is 
\begin{equation}
  \frac{1}{\sqrt{15}} \begin{pmatrix}
  1 & -1 & -1 & -1 & \sqrt{5} & \sqrt{5} & 1
  \end{pmatrix}^T.
\end{equation}
Constructing this vector within each of the $16$ blocks, we get the states found in the lemma. 
\end{proof}


With this understanding of the ground states of $A(G_U)$, we can then give some meaning to the nodes of the graph.  In particular, we view the nodes labeled $\alpha,\beta,\gamma,\delta$ in \fig{GVucnot_tot} as ``input'' nodes and those labeled $\epsilon, \zeta,\eta,\theta$ as ``output nodes''. Each of the states $|\rho_{z,a}^{i,U}\rangle$ is associated with one of the nodes, depending on the values of $i\in[4]$ and $z\in\FF_2$. For example, the states $|\rho_{0,0}^{1,U}\rangle$ and $|\rho_{0,1}^{1,U}\rangle$ are associated with input node $\alpha$ since they both have nonzero amplitude on vertices of the gate graph that are associated with $\alpha$ (and zero amplitude on vertices associated with other labeled nodes).

With the single particle states found, we now turn our attention to the two-particle states.  It will turn out that the two particle eigenstates of the move-together gadget found in \lem{Wgadget_lemma} will play a critical part in our construction.


\begin{lemma}
 A basis for the nullspace of $H(G_U,2)$ is
\begin{equation}
  |T_{z_{1},a,z_{2},b}^{U,\pm}\rangle
    = \frac{1}{2}\Big(|\rho_{z_{1},a}^{1,U}\rangle|\rho_{z_{2},b}^{3,U}\rangle \pm |\rho_{z_{2},b}^{3,U}\rangle|\rho_{z_{1},a}^{1,U}\rangle
    +\sum_{x_1,x_2=0}^{1}U(a)_{x_{1}x_{2},z_{1}z_{2}}\big(|\rho_{x_{1},a}^{2,U}\rangle|\rho_{x_{2},b}^{4,U}\rangle \pm |\rho_{x_{2},b}^{4,U}\rangle|\rho_{x_{1},a}^{2,U}\rangle\big)\Big)\label{eq:twopartstate}
\end{equation}
for $z_{1},z_{2},a,b\in \FF_2$ when $\dmax >0$, and if $\dmax = 0$ a basis for the nullspace of $H(G_U,2)$ when restricted to symmetric states is $\ket{T_{z_1,a,z_2,b}^{U,+}}$ for $z_1,z_2,a,b\in\FF_2$. For any $N\geq 3$, there are no $N$-particle frustration-free
states on $G_U$  for any $\dmax >0$ and there are no $N$-particle symmetric frustration-free  states on $G_U$ when $\dmax = 0$, i.e., 
\begin{equation}
  \lambda_{N}^{1}(G_U)>0\quad\text{for }N\geq3.
\end{equation}
\end{lemma}

\begin{proof}

Let us first show that the states $\ket{T_{z_1,a,z_2,b}^{U,\pm}}$ are contained within the nullspace of $H(G_U,2)$.   We we can expand these states in terms of the $\ket{\psi^q_{z,a}}$ for $q\in[32]$ and $\ket{\chi_{j,a}^{xy}}$, and see that the state $\ket{T_{z_1,a,z_2,b}^{U,\pm}}$ has no support on diagram elements for which particles are located closer than $k > \dmax$, unless possibly both particles are contained in a single move-together gadget.   In particular, whenever one particle is in state $\ket{\psi^q_{z,a}}$ (and thus localized to the diagram element $q$), the other particle is located on a diagram element separated from the first by at least one additional diagram element.  As the nodes of a diagram element are located on vertices of at least $\dmax$ distance, these states do not cause an energy penalty.  The only difficult case to check is when both particles are in move-together gadgets, but the structure of the states $\ket{T_{z_1,a,z_2,b}^{U,\pm}}$ is such that either the particles are in separate move-together gadgets (and thus on states with support at a distance much larger than $k$), or the two particles are in a state within the span of $\ket{\Phi_{a,b}^{\pm}}$ and thus by \lem{Wgadget_lemma} are not penalized by the interaction term.  Altogether, we have that the states $\ket{T_{z_1,a,z_2,b}^{U,\pm}}$ are contained in the nullspace of the interaction Hamiltonian, and thus are frustration-free.

Now let us show that any state in the nullspace of $H(G_U,2)$ are within the span of the states $\ket{T_{z_1,a,z_2,b}^{U,\pm}}$. Using \lem{FF_characterization} we can write any two-particle frustration-free state as 
\begin{equation}
  |\Theta\rangle=\sum_{z,a,x,b\in \{0,1\}}\sum_{I,J\in [4]}B_{\left(z,a,I\right),\left(x,b,J\right)}|\rho_{z,a}^{I,U}\rangle|\rho_{x,b}^{J,U}\rangle
\label{eq:thetastate}
\end{equation}
where 
\begin{equation}
\langle\psi_{x,a}^{q}|\langle\psi_{z,b}^{q}|\Theta\rangle=0\label{eq:ff_condition}
\end{equation}
for all $x,z,a,b\in\{0,1\}$ and $q\in[88]$, and if $\dmax = 0$ we want 
\begin{equation}
B_{\left(z,a,I\right),\left(x,b,J\right)}=B_{\left(x,b,J\right),\left(z,a,I\right)}. \label{eq:sym_B}
\end{equation}
 To enforce equation \eq{ff_condition} we consider the diagram elements $q\in [32]$ (as labeled in \fig{GVucnot_complete}) separately from the other $56$ diagram elements (those inside the move-together gadgets). 

Using equation \eq{ff_condition} with $q\in \{1,2,3,4,7,8\}$ and $x,z,a,b\in\FF_2$ gives
\begin{equation}
B_{\left(x,a,I\right),\left(z,b,I\right)}=0\quad I\in[4], ~ x,z,a,b \in\FF_2\label{eq:II_constraint}.
\end{equation}
Using $q=5$, $x=0$, and $z=1$ in equation \eq{ff_condition} gives 
\begin{equation}
  \langle \psi_{0,a}^5|\langle{\psi_{1,b}^5}|\Theta\rangle = \frac{1}{15} B_{(0,a,1),(1,b,2)} = 0,\label{eq:constraint_q5}
\end{equation}
for $a,b \in \{0,1\}$, while $q=6$, $x=0$, and $z=1$ gives
\begin{equation}
  \langle \psi_{0,a}^6|\langle{\psi_{1,b}^6}|\Theta\rangle = \frac{1}{15} B_{(0,a,2),(1,b,1)} = 0.\label{eq:constraint_q6}
\end{equation}
Note that we can use the same equations with $x = 1$ and $z=0$ to see that $B_{(1,a,2),(0,b,1)} = B_{(1,a,1),(0,b,2)} = 0$ as well.  If we then  apply equation \eq{ff_condition} with $q=5$ or $q=6$  and other choices for $x$ and $z$, or for any or $9\leq q \leq 32$, we find that the equation does not lead to any additional independent constraints on the state $|\Theta\rangle$.

Now consider the constraint \eq{ff_condition} for diagram elements inside the move-together gadgets in \fig{GVucnot_complete}. Let $\Pi_{xy}$ be the projector onto two-particle states where both particles are located at vertices contained within the move-together gadget labeled $xy\in \{00,01,10,11\}$. Using the results of \lem{Wgadget_lemma}, we see that for diagram elements inside the move-together gadgets, \eq{ff_condition} is satisfied if and only if 
\begin{equation}
\Pi_{xy}|\Theta\rangle\in \mathrm{span}\big\{|\chi_{1,a}^{xy}\rangle|\chi_{3,b}^{xy}\rangle \pm |\chi_{3,b}^{xy}\rangle|\chi_{1,a}^{xy}\rangle  +|\chi_{2,a}^{xy}\rangle|\chi_{4,b}^{xy}\rangle \pm |\chi_{4,b}^{xy}\rangle |\chi_{2,a}^{xy}\rangle, \; a,b\in \{0,1\}\big\}.
\end{equation}
Since we already know
\begin{equation}
\Pi_{xy}|\Theta\rangle\in \mathrm{span}\big\{|\chi_{i,a}^{xy}\rangle|\chi_{j,b}^{xy}\rangle, \; i,j\in [4], a,b\in \FF_2\big\},
\end{equation}
we get
\begin{align}
  \langle\chi_{K,a}^{xy}|\langle\chi_{K,b}^{xy}|\Theta\rangle & =0\quad K\in[4]\label{eq:diag_chi_constraint}\\
  \langle\chi_{K,a}^{xy}|\langle\chi_{L,b}^{xy}|\Theta\rangle & =0\quad |K-L| \neq 2\label{eq:off_diag_chi_constraint}\\
  \big(\langle\chi_{1,a}^{xy}|\langle\chi_{3,b}^{xy}|-\langle\chi_{2,a}^{xy}|\langle\chi_{4,b}^{xy}|\big)|\Theta\rangle & =0\label{eq:sum_chi_constraint1}\\
  \big(\langle\chi_{3,a}^{xy}|\langle\chi_{1,b}^{xy}|-\langle\chi_{4,a}^{xy}|\langle\chi_{2,b}^{xy}|\big)|\Theta\rangle & =0\label{eq:sum_chi_constraint2}
\end{align}
for all $a,b\in \{0,1\}$. Note that \eq{diag_chi_constraint} is automatically satisfied whenever \eq{II_constraint} holds.  

Applying equation \eq{off_diag_chi_constraint} with $(K,L)=(1,2)$ and $a,b,x,y\in\FF_2$, we get 
\begin{equation}
  \langle\chi_{1,a}^{xy}|\langle\chi_{2,b}^{xy}|\Theta\rangle=\frac{1}{3}\sum_{z\in \FF_2}\tilde U^a_{xz}B_{\left(z,a,1\right),\left(x,b,2\right)}
    = \frac{1}{3} \tilde U^a_{xx}B_{\left(x,a,1\right),\left(x,b,2\right)} 
    =0.\label{eq:Uxx_eqn}
\end{equation}
In the second equality we used the fact that $B_{\left(z,a,1\right),\left(x,b,2\right)}$ is zero whenever $z\neq x$ (from equations \eq{sym_B}, \eq{constraint_q5}, and \eq{constraint_q6}). Since $\tilde{U}\in \{1,H,HT\}$ we have $\tilde{U}^a_{xx} \neq 0$, and it follows that
\begin{equation}
B_{\left(x,a,1\right),\left(x,b,2\right)}=0\label{eq:diag12}
\end{equation}
for all $x,a,b\in \FF_2$, while the same argument for $(K,L) = (2,1)$ gives $B_{(x,a,2),(x,b,1)} = 0$ for all $x,a,b\in\FF_2$.

Applying equation \eq{off_diag_chi_constraint} with $(K,L)=(1,4)$ gives
\begin{equation}
\langle\chi_{1,a}^{xy}|\langle\chi_{4,b}^{xy}|\Theta\rangle=\frac{1}{3}\sum_{z\in \FF_2} \tilde U (a)_{xz} B_{\left(z,a,1\right),\left(x\oplus y,b,4\right)}=0 \qquad x,y,a,b\in \FF_2.
\end{equation}
By taking appropriate combinations of these equations, we have
\begin{equation}
\sum_{x\in \FF_2} \tilde U^{a,\dagger}_{wx} \langle\chi_{1,a}^{x(y\oplus x)}|\langle\chi_{4,b}^{x (y\oplus x)}|\Theta\rangle= \frac{1}{3}B_{\left(w,a,1\right),\left(y,b,4\right)}=0 \qquad w,y,a,b\in \FF_2, \label{eq:14constraint}
\end{equation}
while the same argument with $(K,L) = (4,1)$ gives $B_{(x,a,4),(z,b,1)} = 0$ for $x,z,a,b\in\FF_2$

Applying equation \eq{off_diag_chi_constraint} with $(K,L)\in \{(2,3),(3,2),(3,4), (4,3)\}$  gives
\begin{align}
\langle\chi_{2,a}^{xy}|\langle\chi_{3,b}^{xy}|\Theta\rangle& =\frac{1}{3}B_{\left(x,a,2\right),\left(y,b,3\right)}=0 &\langle\chi_{3,a}^{xy}|\langle\chi_{2,b}^{xy}|\Theta\rangle& =\frac{1}{3}B_{\left(x,a,3\right),\left(y,b,2\right)}=0 \label{eq:23constraint}\\
\langle\chi_{3,a}^{xy}|\langle\chi_{4,b}^{xy}|\Theta\rangle& =\frac{1}{3}B_{\left(x,a,3\right),\left(x\oplus y,b,4\right)}=0 &
\langle\chi_{4,a}^{xy}|\langle\chi_{3,b}^{xy}|\Theta\rangle& =\frac{1}{3}B_{\left(x,a,4\right),\left(x\oplus y,b,3\right)}=0\label{eq:43constraint}
\end{align}
for all $x,y,a,b\in \FF_2$.

Now putting together equations \eq{II_constraint}, \eq{constraint_q5}, \eq{constraint_q6}, \eq{diag12}, \eq{14constraint}, \eq{23constraint}, and \eq{43constraint}, we get
\begin{equation}
  B_{\left(x,a,I\right),\left(z,b,J\right)}=0\quad \text{ for all } x,z,a,b\in \FF_2,\text{ where } |I- J| \neq 2,
\end{equation}
and thus we have
\begin{equation}
  |\Theta\rangle=\sum_{\substack{z,c,w,d\in \FF_2\\j\in [4]} }B_{\left(z,c,j\right),\left(w,d,j+2\right)}|\rho_{z,c}^{j,U}\rangle|\rho_{w,d}^{j+2,U}\rangle.\label{eq:sum4terms}
\end{equation}
Now 
\begin{align}
  \langle\chi_{1,a}^{xy}|\langle\chi_{3,b}^{xy}|\rho_{z,c}^{1,U}\rangle|\rho_{w,d}^{3,U}\rangle & =\frac{1}{3}\delta_{a,c}\delta_{b,d} \tilde{U}(a)_{xz} \delta_{y,w} =  \langle\chi_{3,b}^{xy}|\langle\chi_{1,a}^{xy}|\rho_{z,d}^{3,U}\rangle|\rho_{w,c}^{1,U}\rangle\\
  \langle\chi_{2,a}^{xy}|\langle\chi_{4,b}^{xy}|\rho_{z,c}^{2,U}\rangle|\rho_{w,d}^{4,U}\rangle & =\frac{1}{3}\delta_{a,c}\delta_{b,d} \delta_{x,z} \delta_{y,w\oplus x} = \langle\chi_{4,a}^{xy}|\langle\chi_{2,b}^{xy}|\rho_{z,c}^{4,U}\rangle|\rho_{w,d}^{2,U}\rangle,
\end{align}
so enforcing equation \eq{sum_chi_constraint1} gives 
\begin{equation}
  \sum_{z\in\FF_2}\tilde{U}^a_{xz}B_{\left(z,a,1\right),\left(y,b,3\right)}=B_{\left(x,a,2\right),\left(x\oplus y,b,4\right)},
\end{equation}
while enforcing equation \eq{sum_chi_constraint2} gives
\begin{equation}
  \sum_{z\in\FF_2}\tilde{U}^a_{xz}B_{\left(y,b,3\right),\left(z,a,1\right)}=B_{\left(x\oplus y,b,4\right),\left(x,a,2\right)},
\end{equation}
for each $x,y,a,b\in\FF_2$. In other words 
\begin{equation}
  B_{\left(z,c,2\right),\left(w,d,4\right)} =\sum_{x\in\FF_2}\tilde{U}^c_{zx} B_{\left(x,c,1\right),\left(z\oplus w,d,3\right)} =\sum_{x,y\in\FF_2}U^c_{zw,xy}B_{\left(x,c,1\right),\left(y,d,3\right)},
\end{equation}
and 
\begin{equation}
  B_{\left(w,d,4\right),\left(z,c,2\right)} =\sum_{x,y\in\FF_2}U^c_{zw,xy}B_{\left(y,d,3\right),\left(x,c,1\right)},
\end{equation}
where we used $U^a=\mathrm{CNOT}_{12} (\tilde U^a\otimes 1)$. Plugging this into \eq{sum4terms} gives 
\begin{align}
|\Theta\rangle  &= \sum_{z,a,w,b\in \FF_2 }\Big[B_{\left(z,a,1\right),\left(w,b,3\right)}|\rho_{z,a}^{1,U}\rangle|\rho_{w,b}^{3,U}\rangle + B_{\left(z,a,3\right),\left(w,b,1\right)}|\rho_{z,a}^{3,U}\rangle|\rho_{w,b}^{1,U}\rangle\nonumber\\
  &\qquad + \sum_{x,y\in\FF_2} U^a_{zw,xy} B_{(x,a,1),(y,b,3)} \ket{\rho_{z,a}^{2,U}}\ket{\rho_{w,b}^{4,U}} + U^b_{wz,yx} B_{(x,a,3),(y,b,1)} \ket{\rho_{z,a}^{4,U}}\ket{\rho_{w,b}^{2,U}}\Big]\\
   &= \sum_{z,a,w,b\in \FF_2 }\Big[B_{\left(z,a,1\right),\left(w,b,3\right)}\Big(|\rho_{z,a}^{1,U}\rangle|\rho_{w,b}^{3,U}\rangle 
    +  \sum_{x,y\in\FF_2} U^a_{xy,zw} \ket{\rho_{x,a}^{2,U}}\ket{\rho_{y,b}^{4,U}}\Big) \nonumber\\
  &  \qquad + B_{(z,a,3),(w,b,1)} \Big(\ket{\rho_{z,a}^{3,U}}\ket{\rho_{w,b}^{1,U}} 
    + \sum_{x,y\in\FF_2} U^b_{yx,wz} \ket{\rho_{x,a}^{4,U}}\ket{\rho_{y,b}^{2,U}}\Big)\Big]\\
   &= \sum_{z,a,w,b\in\FF_2} B_{(z,a,1),(w,b,3)} \big( \ket{T_{z,a,w,b}^{U,+}} + \ket{T_{z,a,w,b}^{U,-}}\big) - B_{(z,a,3),(w,b,1)} \big(\ket{T_{w,b,z,a}^{U,+}} - \ket{T_{w,b,z,a}^{U,-}}\big)
\end{align}
This is the general solution to equations \eq{thetastate}--\eq{ff_condition}, so the space of two-particle frustration-free states for $G_U$ is spanned by the 32 orthonormal states \eq{twopartstate}.

Note that the above analysis only uses \lem{Wgadget_lemma}, and thus if $\dmax = 0$ and we restrict ourselves to the symmetric states, the entire computation follows.  Further, we also have that only the states $\ket{T_{z,a,w,b}^{U,+}}$ are symmetric, and thus these states span the symmetric subspace.

Finally, we show that there are no three-particle frustration-free states (for any $\dmax$). By \lem{increase_part_number}, this implies that there are no frustration-free states for more than two particles. Suppose (to reach a contradiction) that $|\Gamma\rangle$ is a normalized three-particle frustration-free state. Write
\begin{equation}
|\Gamma\rangle=\sum E_{(x,a,q),(y,b,r),(z,c,s)}|\rho_{x,a}^{q}\rangle|\rho_{y,b}^{r}\rangle|\rho_{z,c}^{s}\rangle
\end{equation}
and note that each reduced density matrix of $|\Gamma\rangle$ on two of the three subsystems must have all of its support on two-particle frustration-free states (see the remark following \lem{FF_characterization}). As the two-particle ground space is supported on states of the form
\begin{equation}
  \ket{\rho_{x,a}^r}\ket{\rho_{z,b}^{q}}
\end{equation}
for $|r-q| = 2$, we have that each two-particle reduced state must also exist in this subspace.  We then find that
\begin{align}
\{q,r\}\notin\{\{1,3\},\{2,4\}\}\quad\Longrightarrow\quad E_{(x,a,q),(y,b,r),(z,c,s)} & =0\\
\{q,s\}\notin\{\{1,3\},\{2,4\}\}\quad\Longrightarrow\quad E_{(x,a,q),(y,b,r),(z,c,s)} & =0\\
\{r,s\}\notin\{\{1,3\},\{2,4\}\}\quad\Longrightarrow\quad E_{(x,a,q),(y,b,r),(z,c,s)} & =0
\end{align}
which together imply that $|\Gamma\rangle=0$ (a contradiction). Hence no three-particle frustration-free state exists.
\end{proof}




The two-particle state $\ket{T_{z_{1},a,z_{2},b}^{U,\pm}}$ is a superposition of a term
\begin{equation}
  \frac{1}{2}\big(|\rho_{z_{1},a}^{1,U}\rangle|\rho_{z_{2},b}^{3,U}\rangle \pm \ket{\rho_{z_2,b}^{3,U}}\ket{\rho_{z_1,a}^{1,U}}\big)
\end{equation}
with both particles located on vertices corresponding to input nodes and a term 
\begin{equation}
  \frac{1}{2}\Big(\sum_{x_{1},x_{2}\in\{0,1\}}U^a_{x_{1}x_{2},z_{1}z_{2}}\big(|\rho_{x_{1},a}^{2,U}\rangle|\rho_{x_{2},b}^{4,U}\rangle \pm \ket{\rho_{x_2,b}^{4,U}}\ket{\rho_{x_1,a}^{2,U}}\big)\Big)
\end{equation}
with both particles on vertices corresponding to output nodes. The two-qubit gate $U^a$
% \begin{equation}
% U(a)=\begin{cases}
% U & \text{ if }a=0\\
% U^{*} & \text{ if }a=1
% \end{cases}
% \end{equation}
is applied as the particles move from input nodes to output nodes.  Note that we have essentially constructed a graph such that the ground states correspond to the history states.  Assuming that we can guarantee that particles will have the correct locations, we will be able to combine these gadgets together to construct a history state.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Boundary gadget}

In addition to the gadgets that will allow us to implement two-qubit gates, it will be useful to also have gadgets with similar ground states, but without the ability to move through the gadget.  In particular, we will need to have gadgets that act as boundaries on where the particles can move.  In practice, we will simply use a slightly modified version of the two-qubit gate gadget, but with additional self loops placed so that the gadget only has single-particle self-loops.  

We will actually need two types of boundary gadgets, corresponding to whether or not we will want to force the state of a particular qubit into the zero state, such as initializing ancilla or forcing the output qubit to accept.

The most simple type of \emph{boundary gadget} will be one without penalties.  The gate diagram is nearly the same as in \fig{GVucnotcomplete} (with $\tilde U = \II$) by adding self-loops to eight of the labeled vertices.  In particular, the adjacency matrix is given by
\begin{equation}
  A(G_{\text{bnd}})=A(G_{\CNOT_{12}})+h_{\mathcal{S}} 
\end{equation}
\begin{equation}
  h_{\mathcal{S}}
  =\sum_{z\in\FF_2}(
    |1,z, 2k z \rangle\langle1,z, 2k z |\otimes\II_{8}\otimes \II_{2}
   +|2,z,4k + 2kz\rangle\langle2,z, 4 k + 2 k z|\otimes\II_{j}
   +|3,z,2k z\rangle\langle3,z,2kz|\otimes\II_{j}
  ).
\end{equation}

The second type of boundary gadget with penalties, is shown in \fig{GVbdy_complete}.  Again the gate diagram is obtained from \fig{GVucnotcomplete} by adding self-loops, but we also change the $q=8$ element from a  $\II_{(0,0)}^{(1,1)}$ element to a $\II_{(0,1)}^{(1,1)}$ diagram element.  In particular, we have that its adjacency matrix is
\begin{equation}
  A(G_{\text{bnd,pen}})=A(G_{\text{bnd}}) - 2\sum_{j\in[8]} \ketbra{8,1,6k,j,+}{8,1, 6k,j,+}
\end{equation}
Note that $A(G_{\text{bnd,pen}})$ is still a positive semidefinite matrix, as the subtracted terms correspond to changing the $q=8$ element from a $\II_{(0,0)}^{(1,1)}$ element to a $\II_{(1,1)}^{(1,1)}$ element.  This does not affect any of our previous results on the single- or two- particle eigenstates, but will allow us to have an additional node for that logical state.

For both types of boundary gadgets, the single-particle ground states (with energy $e_{1}$) are superpositions of the states $|\rho_{z,a}^{i,U}\rangle$ from \lem{2qub_gate} that are in the nullspace of $h_{\mathcal{S}}$. Note that 
\begin{equation}
  \langle\rho_{x,b}^{j,U}|h_{\mathcal{S}}|\rho_{z,a}^{i,U}\rangle=\delta_{a,b}\delta_{x,z}\left(\delta_{i,1}\delta_{j,1}+\delta_{i,2}\delta_{j,2}+\delta_{i,3}\delta_{j,3}\right)\frac{1}{15}\cdot\frac{1}{8k}
\end{equation}
and thus we have that the only single-particle ground states are
\begin{equation}
  |\rho_{z,a}^{\text{bnd}}\rangle = |\rho_{z,a}^{4,U}\rangle
\end{equation}
with $z,a\in\FF_2$.  Additionally, there are no two- (or more) particle frustration-free states, because no superposition of the states \eq{twopartstate} lies in the subspace 
\begin{equation}
\spn\{ |\rho_{z,a}^{4,U}\rangle|\rho_{x,b}^{4,U} \colon z,a,x,b\in\FF_2\} 
\end{equation}
of states with single-particle reduced density matrices in the ground space of $A(G_{\text{bnd}})$.  We summarize these results as follows.

\begin{figure}
\centering
  \tikzsetnextfilename{MP_GVbdy}
  \input{../tikz/MP_GVbdy.tex}
  \caption{The gate diagram for the boundary gadget is obtained from \fig{GVucnot} by setting $\tilde U=1$ and adding 6 self-loops.}
  \label{fig:GVbdy}
\end{figure}

\begin{lemma}\label{lem:boundary_lemma}
The smallest eigenvalue of $A(G_{\text{bnd}})$ and of $A(G_{\text{bnd,pen}})$ is $e_{1}$, with corresponding eigenvectors 
\begin{equation}
|\rho_{z,a}^{\text{bnd}}\rangle =\frac{1}{\sqrt{15}}\Big(|\psi_{z,a}^{4}\rangle+|\psi_{z,a}^{8}\rangle -\ket{\psi_{z,a}^{31+z}}
  	+\sum_{x\in\FF_2}\big(\sqrt{5}|\chi_{4,a}^{x\left(z\oplus x\right)}\rangle - \ket{\psi_{0,a}^{21+2z + x}}  \big).\label{eq:rho_bnd}
\end{equation}
For any $N\geq 2$, there are no $N$-particle frustration-free states on $G_{\text{bnd}}$ or $G_{\text{bnd,pen}}$  for any $\dmax >0$ and there are no $N$-particle symmetric frustration-free  states on $G_{\text{bnd}}$ or $G_{\text{bnd,pen}}$ when $\dmax = 0$, i.e., 
\begin{equation}
  \lambda_{N}^{1} (G_{\text{bnd}}) \geq \lambda_{N}^{1}(G_{\text{bnd,pen}})>0\quad\text{for }N\geq2.
\end{equation}
\end{lemma}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Occupancy constraints lemma
%

\section{The occupancy constraints lemma}\label{sec:occupancy_constraints_lemma}

While the graphs defined in \sec{graph_primitives} have many useful features, such as simple single- and two-particle states and a constant energy gap, they do require that the particles are located in very specific locations.  In particular, in order for the two-particle gadgets to encode a computation we require that two-particles have non-zero amplitude on the particle.  While this is simple to achieve if the number of particles is larger than the number of gadgets, the final gate graph that we construct will have many more gate graphs than particles, which will result in the existence of many unwanted states remaining in the $n$-particle ground space.

To get around this problem, we will need to ensure that certain two-particle states are removed from the ground space.  In particular, if we want to encode each logical qubit via a single particle, we will want to ensure that only one particle corresponds to a specific qubit.  If we encode time in a spatial manner, this will require that two particles don't correspond to the same qubit at different times.

We will get around this problem via a lemma that we call the \emph{occupancy constraints lemma}.  The basic idea is that it will take in a gate graph, and a set of two-particle states that we don't want to occur, and then construct a larger graph that has related $n$-particle ground states but without the unwanted states.

%=============================================================================
\subsection{Occupancy constraints}
\label{sec:occupancy_constraints}

With the idea of excluding certain two-particle states from the ground space of the quantum walk on a gate graph, we will somehow need to encode these constraints.  To do so, let us assume that $G$ is a gate graph with $R$ diagram elements (of some type).  We will then define $G^{\text{occ}}$ to be a graph with $R$ vertices, where the vertices of $G^{\text{occ}}$ correspond to the diagram elements of $G$.  The edge set of $G^{\text{occ}}$ is then defined to encode the occupancy constraints of $G$, namely there exists an edge between two vertices of $G^{\text{occ}}$ if and only if we want to exclude those states from the ground-space of $G$ where two particles are located on the corresponding diagram elements of $G$.  In this way, we can easily encode our requisite occupancy constraints: simply add an edge in the graph $G^{\text{occ}}$.

\todo{find whatever section we defined frustration-free stuff, and reference}

With these occupancy constraints well defined, it will also be useful to define the frustration-free ground space that also respects these constraints.  In particular, remember that for a particular gate graph $G$, we defined the $N$-particle frustration-free ground space of the gate graph without edges between the diagram elements and without self-loops as
\begin{equation}
  \mathcal{I}(G,N) = \spn \big\{ \ket{\psi_{z_1,a_1}^{q_1}} \cdots \ket{\psi_{z_N,a_N}^{q_N}}  :  \forall i,j\in [N], z_i,a_i\in \FF_2, q_i\in [R], i\neq j \Rightarrow q_i\neq q_j\big\}.
\end{equation}
In particular, this subspace guarantees that each individual particle is in the ground state of a diagram element, and further that no two particles are located on the same element.  To also ensure that the particles satisfy a particular pair of occupancy constraints, we can restrict this subspace even farther.  Once again, if $G$ is a gate graph, and if $G^{\text{occ}}$ is a set of occupancy constraints for $G$, then we can define
\begin{align}
  \mathcal{I}(G,G^{\text{occ}},N) &:= \spn\big\{ \ket{\psi_{z_1,a_1}^{q_1}} \cdots \ket{\psi_{z_N,a_N}^{q_N}}:\nonumber\\
  &\qquad\qquad  \forall i,j\in [N], z_i,a_i\in \FF_2, q_i\in [R], i\neq j \Rightarrow q_i\neq q_j \text{ and } (i,j)\notin E(G^{\text{occ}})\big\}.
\end{align}
This subspace explicitly excludes those states that violate the occupancy constraints of $G^{\text{occ}}$, and thus will be useful for when we want to assume that the occupancy constraints are satisfied. 

Now that we have a subspace that satisfy our occupancy constraints, we will want to understand how the eigenvalues change when we add in the various edges and self-loops of the original gate graph.  In particular, we will define
\begin{equation}
  H(G,G^{\text{occ}},N) = H(G,N) \big |_{\mathcal{I}(G,G^{\text{occ}},N)}
\end{equation}
to be the MPQW Hamiltonian when restricted to the subspace that satisfies the occupancy constraints.  We then define $\lambda_N^1(G,G^{\text{occ}})$ for the smallest eigenvalue of this Hamiltonian.  Note that if the system is exactly frustration-free, $\lambda_N^1(G,G^{\text{occ}}) = 0$.


%=============================================================================
\subsection{Occupancy Constraints Lemma statement}
\label{sec:occupancy_statement}

Now that we can easily encode our occupancy constraints, we would like to have the technical results that our transformation allows us to perform.  Specifically, while our transform might raise certain states out of the ground space, it might also drastically reduce the energy gap of the Hamiltonian as well.  As our eventual goal is to show that the MPQW-ground state problem is \QMA-complete, we need to bound this reduction in the gap.  

\todo{correct occupancy constraints bounds}

With this in mind, we can state the explicit bounds for our lemma:
\begin{lemma}[\textbf{Occupancy Constraints Lemma}]\label{lem:oc}
Let $G$ be an $e_{1}$-gate graph specified as a gate diagram with $R\geq2$ diagram elements. Let $N\in[R]$, let $G^{\text{occ}}$ specify a set of occupancy constraints on $G$, and suppose the subspace $\mathcal{I}(G,G^{\text{occ}},N)$ is nonempty. Then there exists an efficiently computable $e_{1}$-gate graph $G^{\square}$ with at most $7R^{2}$ diagram elements such that
\begin{enumerate}
\item If $\lambda_{N}^{1}(G,G^{\text{occ}})\leq a$ then $\lambda_{N}^{1}(G^{\square})\leq\frac{a}{R}$.
\item If $\lambda_{N}^{1}(G,G^{\text{occ}})\geq b$ with $b\in[0,1]$, then $\lambda_{N}^{1}(G^{\square})\geq \frac{\gamma_{\square}b}{R^{9+\nu}}$, where $\gamma_{\square}$ is a constant that depends only on the interaction $\mathcal{U}$, and $\nu$ is the bound on the maximum strength of the interaction potential.
\end{enumerate}
\end{lemma}

In the next subsection we give the explicit transformation of the graph $G$ to the graph $G^{\square}$. While the actual transformation itself is not particularly complicated, in order to show how the energy gap transforms we will need to define several intermediate graphs in which not all of the edges are added.  Thus our proof of the occupancy constraints lemma will also be rather iterative, and will be done later in this section.
%-----------------------------------------------------------------------------
\subsubsection{Definition of $G^{\square}$\label{sec:g_square_def}}

We will now show how to construct $G^{\square}$ from $G$ and an occupancy constraints graph $G^{\text{occ}}$.  To ensure that the ground space has the appropriate form, the construction of $G^{\square}$ differ slightly for even and odd $R$ is even or odd as a result of the edges in gate diagrams adding an additional sign between connected diagram elements.  The following description handles both cases.

In order to ease the definition of $G^{\square}$, let us first fix notation for the gate graph $G$ and the occupancy constraints graph $G^{\text{occ}}$. Write the adjacency matrix of $G$ as (see equation \eq{adj_gate_graph}) 
\begin{equation}
A(G)=\sum_{q=1}^{R}|q\rangle\langle q|\otimes A(g_{q})+h_{\mathcal{E}^{G}}+h_{\mathcal{S}^{G}}
\end{equation}
where $h_{\mathcal{E}^{G}}$ and $h_{\mathcal{S}^{G}}$ are determined (through equations \eq{h_edges} and \eq{h_loops}) by the sets $\mathcal{E}^{G}$ and $\mathcal{S}^{G}$ of edges and self-loops in the gate diagram for $G$, and where $g_q$ is the $128k$-vertex graph corresponding to the diagram element labeled $q$.

\begin{enumerate}
\item For each diagram element $q\in[R]$ in the gate diagram for $G$, construct a gadget as shown in \fig{replace_gate_diagram}, with diagram elements labeled $q_{\text{in}},q_{\text{out}}$ and $d(q,s)$ where $q,s\in[R]$ and $q\neq s$ if $R$ is even.  In particular, if the diagram element labeled $q$ is a $U^{(a,b)}_{(c,d)}$ diagram element, then $q_{\text{in}}$ is a $\II^{(a,b)}_{(1,1)}$ diagram element, $q_{\text{out}}$ is a $U^{(1,1)}_{(c,d)}$ diagram element, and each $d(q,s)$ is a $\II^{(2,2)}_{(2,2)}$ diagram element.   Each node $(q,z,t)$ in the gate diagram for $G$ is mapped to a new node $\new(q,z,t)$ as shown by the black and grey arrows, i.e., 
\begin{equation}
  \new(q,z,t)=\begin{cases}
    (q_{\mathrm{in}},z,t) & \text{ if }(q,z,t)\text{ is an input node}\\
    (q_{\mathrm{out}},z,t) & \text{ if }(q,z,t)\text{ is an output node}.
  \end{cases}\label{eq:node_mapping_G_G_square}
\end{equation}
Edges and self-loops in the gate diagram for $G$ are replaced by edges and self-loops between the corresponding nodes in the modified diagram.

\item For each edge $\{q_{1},q_{2}\}\in E(G^{\text{occ}})$ in the occupancy constraints graph we add four $\II^{(1,1)}_{(0,0)}$ diagram elements.  We refer to these diagram elements by labels $e_{ij}(q_{1},q_{2})$ with $i,j\in\FF_2$. For these diagram elements the labeling function is symmetric, i.e., $e_{ij}(q_{1},q_{2})=e_{ji}(q_{2},q_{1})$ whenever $\{q_{1},q_{2}\}\in E(G^{\text{occ}})$.

\item For each non-edge $\{q_{1},q_{2}\}\notin E(G^{\text{occ}})$ with $q_{1},q_{2}\in[R]$ and $q_{1}\neq q_{2}$ we add $8$ $\II^{(1,1)}_{(0,0)}$ diagram elements. We refer to these diagram elements as $e_{ij}(q_{1},q_{2})$ and $e_{ij}(q_{2},q_{1})$ with $i,j\in\FF_2$; when $\{q_1,q_2\}\notin E(G^{\text{occ}})$ the labeling function is not symmetric, i.e., $e_{ij}(q_{1},q_{2})\neq e_{ji}(q_{2},q_{1})$. If $R$ is odd we also add $4R$ $\II^{(1,1)}_{(0,0)}$ diagram elements labeled $e_{ij}(q,q)$ with $i,j\in\FF_2$ and $q\in[R]$.

\item Finally, we add edges and self-loops to the gate diagram as shown in \fig{add_edges}. This gives the gate diagram for $G^{\square}$.
\end{enumerate}

\begin{figure}
\centering
  \tikzsetnextfilename{MP_replace_gate_diagram}
  \input{../tikz/MP_replace_gate_diagram.tex}
\caption{The first step in constructing the gate diagram of $G^{\square}$
from that of $G$ is to replace each diagram element as shown. The
four input nodes (black arrow) and four output nodes (grey arrow)
on the left-hand side are identified with nodes on the right-hand
side as shown.\label{fig:replace_gate_diagram}}
\end{figure}

\todo{fix these graphs}
\begin{figure}
\centering
\subfloat[b][$\{q,s\}\in E(G^{\text{occ}}),\,q<s$]{
  \label{fig:add_edgesA}
  \tikzsetnextfilename{MP_add_edgesA}
  \input{../tikz/MP_add_edgesA.tex}
}
\hspace{.5cm}
\subfloat[b][$\{q,s\}\notin E(G^{\text{occ}})$]{
  \label{fig:add_edgesB}  
  \tikzsetnextfilename{MP_add_edgesB}
  \input{../tikz/MP_add_edgesB.tex}
}
\hspace{.5cm}
\subfloat[b][]{
  \label{fig:add_edgesC}
  \tikzsetnextfilename{MP_add_edgesC}
  \input{../tikz/MP_add_edgesC.tex}
}
\caption{Edges and self-loops added in step 4 of the construction of the gate diagram of $G^{\square}$. When $\{q,s\}\in E(G^{\text{occ}})$ with $q<s$, we add two outgoing edges to $e_{ij}(q,s)$ as shown in \subfig{add_edgesA}. Note that if $q>s$ and $\{q,s\}\in E(G^{\text{occ}})$ then $e_{ij}(q,s)=e_{ji}(s,q)$. When $\{q,s\}\notin E(G^{\text{occ}})$ we add a self-loop and a single outgoing edge from $e_{ij}(q,s)$ as shown in \subfig{add_edgesB}. Each diagram element $d(q,s)$ has eight outgoing edges (four of which are added in step 4), as shown in \subfig{add_edgesC}.\label{fig:add_edges}}
\end{figure}

The set of diagram elements in the gate graph for $G^{\square}$ is indexed by
\begin{equation}
L^{\square}=Q_{\text{in}}\cup D\cup E_{\text{edges}}\cup E_{\text{non-edges}}\cup Q_{\text{out}}\label{eq:L_square}
\end{equation}
where
\begin{align}
Q_{\text{in}} & =\left\{ q_{\mathrm{in}}:q\in[R]\right\} \label{eq:Q_in}\\
D & =\left\{ d(q,s):\, q,s\in[R]\text{ and }q\neq s\text{ if }R\text{ is even}\right\} \label{eq:defn_of D}\\
E_{\text{edges}} & =\left\{ e_{ij}(q,s):\, i,j\in\{0,1\},\,\{q,s\}\in E(G^{\text{occ}})\text{ and }q<s\right\} \nonumber \\
E_{\text{non-edges}} & =\left\{ e_{ij}(q,s):\, i,j\in\{0,1\},\,\{q,s\}\notin E(G^{\text{occ}})\text{ and }q\neq s\text{ if }R\text{ is even}\right\} \nonumber \\
Q_{\text{out}} & =\left\{ q_{\mathrm{out}}:q\in[R]\right\} .\label{eq:Q_out}
\end{align}
The total number of diagram elements in $G^{\square}$ is 
\begin{align}
|L^{\square}| & =|Q_{\text{in}}|+|D|+|E_{\text{edges}}|+|E_{\text{non-edges}}|+|Q_{\text{out}}|\\
 & =\begin{cases}
R+R^{2}+4|E(G^{\text{occ}})|+4\left(R^{2}-2|E(G^{\text{occ}})|\right)+R & R\text{ odd}\\
R+R\left(R-1\right)+4|E(G^{\text{occ}})|+4\left(R(R-1)-2|E(G^{\text{occ}})|\right)+R & R\text{ even}
\end{cases}\\
 & =\begin{cases}
5R^{2}+2R-4|E(G^{\text{occ}})| & R\text{ odd}\\
5R^{2}-3R-4|E(G^{\text{occ}})| & R\text{ even}.
\end{cases}
\end{align}
In both cases this is upper bounded by $7R^2$ as claimed in the statement of the Lemma. Write 
\begin{equation}
A(G^{\square})=\sum_{l\in L^{\square}}|l\rangle\langle l|\otimes A(g_{l})+h_{\mathcal{S}^{\square}}+h_{\mathcal{E}^{\square}}\label{eq:A_G_squAre}
\end{equation}
where $g_l$ corresponds to the diagram element labeled $l\in L^{\square}$, $\mathcal{S}^{\square}$ and $\mathcal{E}^{\square}$ are the sets of self-loops and edges in the gate diagram for $G^{\square}$. 

We now focus on the input nodes of diagram elements in $Q_{\text{in}}$ and the output nodes of the diagram elements in $Q_{\text{out}}$. These are the nodes indicated by the black and grey arrows in \fig{replace_gate_diagram}. Write $\mathcal{E}^{0}\subset\mathcal{E}^{\square}$ and $\mathcal{S}^{0}\subset\mathcal{S^{\square}}$ for the sets of edges and self-loops that are incident on these nodes in the gate diagram for $G^{\square}$. Note that the sets $\mathcal{E}^{0}$ and $\mathcal{S}^{0}$ are in one-to-one correspondence with (respectively) the sets $\mathcal{E}^{G}$ and $\mathcal{S}^{G}$ of edges and self-loops in the gate diagram for $G$ (by definition). The other edges and self-loops in $G^{\square}$ do not depend on the sets of edges and self-loops in $G$, as they are created in our effort to enforce the occupancy constraints. Writing
\begin{equation}
\mathcal{S}^{\triangle}=\mathcal{S}^{\square}\setminus S^{0}\qquad\mathcal{E}^{\triangle}=\mathcal{E}^{\square}\setminus\mathcal{E}^{0},
\end{equation}
we have 
\begin{equation}
h_{\mathcal{S}^{\square}}=h_{\mathcal{S}^{0}}+h_{\mathcal{S}^{\triangle}}\qquad h_{\mathcal{E}^{\square}}=h_{\mathcal{E}^{0}}+h_{\mathcal{E}^{\triangle}}.\label{eq:h_se_square}
\end{equation}

With these edges and self-loops that are only affected by the occupancy constraints, it will be useful to define a couple of graphs slightly more simple than $G^{\square}$.  In particular, it will be useful to first  examine the gate graph that only has the self-loops added during the transformation from $G$ to $G^{\square}$, namely the self-loops on nodes in $\mathcal{S}^{\triangle}$, as this graph has a particularly simple ground space, and we will label this graph $G^{\diamondsuit}$.  We will then be able to more easily analyze the graph that arises by adding in the edges of $\mathcal{E}^{\triangle}$, and we will label this graph by $G^{\triangle}$.  With these foundational graphs understood (and in particular understanding their $N$-particle frustration-free ground states), we will then easily understand the ground states and ground energies of $G^{\square}$ in term of the ground energies of $G$.

In particular, we will define the gate diagram for $G^{\diamondsuit}$ to be the diagram on the  elements labeled by $L^{\square}$ and including the self-loops in $\mathcal{S}^{\triangle}$.  We then have that the adjacency matrix for $G^{\diamondsuit}$ is 
\begin{equation}
  A(G^{\diamondsuit}) = \sum_{\ell \in L^{\square}} \ketbra{\ell}{\ell} \otimes A(g_\ell) + h_{\mathcal{S}^\triangle}\label{eq:A_G_diamond_defn}.
\end{equation}

We can also define the gate diagram for $G^{\triangle}$ to be the same as for $G^{\diamondsuit}$, but including the edges in $\mathcal{E}^{\triangle}$.  We can then define the adjacency matrix for $G^{\triangle}$ as
\begin{equation}
  A(G^{\triangle})=\sum_{l\in L^{\square}}|l\rangle\langle l|\otimes A(g_{l})+h_{\mathcal{S}^{\triangle}}+h_{\mathcal{E}^{\triangle}}.\label{eq:A_g_triangle}
\end{equation}
Note that $G^{\triangle}=G^{\square}$ whenever the gate diagram for $G$ contains no edges or self-loops. 


We provide an example of this construction in \fig{example_G_Gtilde} (which shows a gate graph and an occupancy constraints graph) and \fig{big_example_G_square} (which describes the derived gate graphs $G^{\square}$, $G^{\triangle}$, and $G^{\diamondsuit}$).

\todo{completely fix these example graphs}

\begin{figure}
\subfloat[][]{
  \label{fig:example_G_GtildeA}
  \tikzsetnextfilename{MP_example_G_GtildeA}
  \input{../tikz/MP_example_G_GtildeA.tex}
}
\hspace{4cm}
\subfloat[][]{
  \label{fig:example_G_GtildeB}
  \tikzsetnextfilename{MP_example_G_GtildeB}
  \input{../tikz/MP_example_G_GtildeB.tex}
}
\caption{An example \subfig{example_G_GtildeA} Gate diagram for a gate graph $G$ and \subfig{example_G_GtildeB} Occupancy constraints graph $G^{\text{occ}}$. In the text we describe how these two ingredients are mapped to a gate graph $G^{\square}$; the gate diagram for $G^{\square}$ is shown in \fig{big_example_G_square}.\label{fig:example_G_Gtilde}}
\end{figure}

\begin{figure}
  \tikzsetnextfilename{MP_big_example_G_square}
  \input{../tikz/MP_big_example_G_square.tex}
\caption{The gate diagram for $G^{\triangle}$ (only solid lines) and $G^{\square}$ (including dotted lines) derived from the example gate graph $G$ and occupancy constraints graph $G^{\text{occ}}$ from \fig{example_G_Gtilde}. The gate diagram for $G^{\diamondsuit}$ is obtained from that of $G^{\triangle}$ by removing all edges (but leaving the self-loops).\label{fig:big_example_G_square}}
\end{figure}


%=============================================================================
\subsection{The gate graph $G^{\diamondsuit}$}
\label{sec:The-gate-graph_G_DIAMOND}

With the various graphs well defined, let us now find the ground states of $A(G^{\diamondsuit})$.  We know from $\eq{A_G_diamond_defn}$ that each component of $G^{\diamondsuit}$ is a diagram element $g_l$, with self-loops on some of the nodes.  Using \lem{diagram_element_ground}, we can then see that each component of $G^{\diamond}$ suit has at most 4 orthonormal $e_1$-energy eigenstates, and that this is the minimum energy.

More concretely, for each diagram element labeled by $l\in L^{\square}$ in $A(G^{\diamondsuit})$, we can write $g_{l}'$ for the graph with adjacency matrix
\begin{equation}
  A(g_{l}')=A(g_{l})+|1,2k \rangle\langle 1,2k|\otimes\II_{16}
\end{equation}
(i.e., $g_l$ with $16$ self-loops added), and thus each component of $G^{\diamondsuit}$ is either $g_{l}$ or $g_{l}'$.  

We can then use \lem{diagram_element_ground} to see that $A(g_{\ell})$ has four orthonormal $e_{1}$-energy ground states for each $\ell$ namely $\ket{\overline{\psi_{z,a}}}$ for $z,a\in\FF_2$, as defined in \eq{psi0m}, \eq{psi1m}, using the transform of \eq{phi_copy_transform}.  As the states with $z= 0$ are in the nullspace of $\ketbra{1,2k}{1,2k}\otimes \II_{16}$, while the operator is strictly positive for the states with $z=1$, we se that the ground space of $A(g_l')$ is spanned by the states $\ket{\overline{\psi_{0,a}}}$ for $a\in\FF_2$.  If we now label the states by the $l\in L^{\square}$,  (i.e., $|\psi_{z,a}^{l}\rangle=|l\rangle|\overline{\psi_{z,a}}\rangle$, we can choose a basis $\mathcal{W}$ for the $e_{1}$-energy ground space of $A(G^{\diamondsuit})$ where each basis vector is supported on one of the components:
\begin{equation}
  \mathcal{W}= \big\{ |\psi_{0,a}^{l}\rangle:\, a\in\FF_2,\, l\in E_{\text{non-edges}}\big\} \bigcup \big\{ |\psi_{z,a}^{l}\rangle:\, z,a\in\FF_2,\, l\in L^{\square}\setminus E_{\text{non-edges}}\big\} .\label{eq:definition_of_W}
\end{equation}
The eigenvalue gap of $A(G^{\diamondsuit})$ is equal to that of either $A(g_{l})$ or $A(g_{l}')$ for some $l$. Since $g_{l}$ and $g_{l}'$ are constant-sized $256k$-vertex graphs, there exists a constant sized gap for each; let $c_{\diamondsuit}$ be the minimum value of this gap for all possible diagram elements, both with and without the added self-loops.  We then have that
\begin{align}
\gamma(A(G^{\diamondsuit})-e_{1}) & \geq c_{\diamondsuit}\label{eq:one_thirteenth_bound}
\end{align}

The ground space of $A(G^{\diamondsuit})$ has dimension 
\begin{align}
|\mathcal{W}|&=4\big|L^{\square}\big|  -2\left|E_{\text{non-edges}}\right|\\
&=\begin{cases}
4\left(5R^{2}+2R-4|E(G^{\text{occ}})|\right)-2\left(4R^{2}-8|E(G^{\text{occ}})|\right) & R\text{ odd}\\
4\left(5R^{2}-3R-4|E(G^{\text{occ}})|\right)-2\left(4R(R-1)-8|E(G^{\text{occ}})|\right) & R\text{ even}
\end{cases} \\
&= \begin{cases}
12R^{2}+8R & R\text{ odd}\\
12R^{2}-4R & R\text{ even}.
\end{cases}\label{eq:num_basis_W}
\end{align}

We now consider the $N$-particle Hamiltonian $H(G^{\diamondsuit},N)$ and characterize its nullspace.

\begin{lemma}
\label{lem:The-nullspace-of_Hdiamond} If $\dmax >0$ and if $|L^\square| geq N$, then the nullspace of $H(G^{\diamondsuit},N)$ is 
\begin{equation}
  \mathcal{I}_{\diamondsuit}= \spn \big\{ \ket{\psi_{z_1,a_1}^{q_1}} \ket{\psi_{z_2,a_2}^{q_2}} \cdots \ket{\psi_{z_N,a_N}^{q_N}}\; : \; |\psi_{z_{i},a_{i}}^{q_{i}}\rangle\in\mathcal{W}\text{ and } \forall i,j\in [N], i\neq j \Rightarrow q_{i}\neq q_{j} \big\}
\end{equation}
where $\mathcal{W}$ is given in equation \eq{definition_of_W}.  If $\dmax = 0$ and if $|L^\square|\geq N$, then when restricted to symmetric states, then nullspace of $H(G^{\diamondsuit},N)$ is given by
\begin{equation}
  \mathcal{I}_{\diamondsuit}^{\Sym}=\spn\{ \Sym( \ket{\Phi}) : \ket{\Phi} \in \mathcal{I}_{\diamondsuit}\}.
\end{equation} 
When $\dmax >0$ (and when restricted to symmetric states for $\dmax = 0$), the smallest nonzero eigenvalue satisfies 
\begin{equation}
  \gamma(H(G^{\diamondsuit},N)) > \gamma_{\diamondsuit},
\end{equation}
where $\gamma_{\diamondsuit}$ is a constant that depends only on the interaction $\mathcal{U}$.
\end{lemma}

\begin{proof}
The main tool used in this proof is our characterization of the $2$-particle ground states on diagram elements from \lem{2particle_element_bound}, namely that they don't exist.  Combined with our results for interactions on disconnected graphs from \lem{BH_disconnected_graphs}, we essentially have the proof.  

In particular, we have from \lem{2particle_element_bound} that in the $N$-particle ground space, no component of $G^{\diamondsuit}$ supports a two-particle frustration-free state (i.e., $\lambda_{2}^1(g_l)>0$ for each $l\in L^\square$), while $\lambda_1^1(g_l) = 0$.  If we assume that $L^\square \geq N$ and $\dmax > 0$, we then have from \lem{BH_disconnected_graphs} that the $N$-particle nullspace for $G^{\diamondsuit}$ is exactly $\mathcal{I}_\diamondsuit$.  If we restrict our attention to symmetric states, the same argument holds for all $\dmax$.

Additionally, we have from \lem{BH_disconnected_graphs} that the smallest nonzero eigenvector of $H(G^\diamondsuit,N)$ is either the smallest eigenvalue of a single-particle excited state for some diagram element $g_l$, or else the smallest energy of a two-particle state on some diagram element $g_l$ (where we used the fact that adding the self-loops can only increase the energy of a state).  As such, we can then bound the eigenvalue gap for the $N$-particle sector on $G^\diamondsuit$ as
\begin{align}
  \gamma(H(G^{\diamondsuit},N))&\geq \min_{l\in L^{\square}}\{ \min\{\lambda_{2}^{1}(g_{l}),\gamma(H(g_{l},1)))\}\} \\
    &\geq \min_{\substack{U\in\{\II,H,HT\}\\0\leq a,b,c,d \leq 2}} \min\{\lambda_{2}^{1}(G_U^{(a,b),(c,d)}),\gamma(H(G_U^{(a,b),(c,d)},1)))\} =\gamma_{\diamondsuit}.
\end{align}
Note that $\gamma_{\diamondsuit}$ depends only on $\dmax$ (from the size of the graph $g_0$) and on the 2-particle energy (from the two-particle ground energy), and thus $\gamma_\diamondsuit$ is some constant that depends only on the interaction.
\end{proof}

At this point, we have a foundational graph with a constant eigenvalue gap, upon which we can add edges and see how the eigenvalue gap changes.

%=============================================================================
\subsection{The adjacency matrix of the gate graph $G^{\triangle}$}
\label{sec:The-gate-graph_G_triangle}

With the graph $G^{\diamondsuit}$ defined and its ground-states defined and energy gaps bounded, we now want to examine the graph with the edges that enforce the occupancy constraints.  In particular, we now want to examine $G^{\triangle}$.

We begin by solving for the ground space of the adjacency matrix $A(G^{\triangle})$. From equation \eq{A_g_triangle} and  we have
\begin{equation}
  A(G^{\triangle})=A(G^{\diamondsuit})+h_{\mathcal{E}^{\triangle}}.\label{eq:A_g_diamond_triangle}
\end{equation}
We already know that the  $e_{1}$-energy ground space of $A(G^{\diamondsuit})$ is spanned by $\mathcal{W}$ from equation \eq{definition_of_W}. Since $h_{\mathcal{E}^{\triangle}}\geq0$ it follows that $A(G^{\triangle})\geq e_{1}$.  If we then want to find the $e_{1}$-energy groundspace of $A(G^{\triangle})$, we construct superpositions of vectors from $\mathcal{W}$ that are in the nullspace of $h_{\mathcal{E}^{\triangle}}$. To this end we consider the restriction
\begin{equation}
  h_{\mathcal{E}^{\triangle}}\big|_{\spn\left(\mathcal{W}\right)},\label{eq:restriction_h_triangle}
\end{equation}
and we will show that it is block diagonal in the basis $\mathcal{W}$.

Recall from equation \eq{h_edges} that
\begin{align}
  h_{\mathcal{E}^{\triangle}}=\sum_{\left\{ (l,z,t),(l^{\prime},z^{\prime},t^{\prime})\right\} \in\mathcal{E}^{\triangle}}\left(|l,z,t\rangle+|l^{\prime},z^{\prime},t^{\prime}\rangle\right)\left(\langle l,z,t|+\langle l^{\prime},z^{\prime},t^{\prime}|\right)\otimes\II_{16}.\label{eq:equation_for_h_epsilon_triangle}
\end{align}
The edges $\left\{ (l,z,t),(l^{\prime},z^{\prime},t^{\prime})\right\} \in\mathcal{E}^{\triangle}$ can be read off from \fig{replace_gate_diagram} and \fig{add_edges},  where we refer back to \fig{diagram_elements} for the labeling convention of nodes on a diagram element. The edges from \fig{replace_gate_diagram} are
\begin{align}
  &\big\{ (q_{\mathrm{in}},z,(5+z)k),(d(q,1),z,(1+z)k)\big\}, \label{eq:epsilon_triangle_set1_1}\\
  &\big\{ (d(q,i),z,(5+z)k),(d(q,i+1),z,(1+z)k)\big\}, \label{eq:epsilon_triangle_set1_2}\\
  & \big\{ (d(q,R),z,(5+z)k),(q_{\mathrm{out}},z,(1+z)k)\big\}, \label{eq:epsilon_triangle_set1_3}
\end{align}
with $q\in[R]$, $i\in [R-1]$ and $z\in \FF_2$, and where $d(q,q)$ does not appear if $R$ is even (i.e., $d(q,q-1)$ is followed by $d(q,q+1)$). The edges from \fig{add_edges} take the form  
\begin{align}
  \left\{ \left(d(q,s),z,k(3z + 4 x) \right),(e_{zx}(q,s),\alpha(q,s),2 k \alpha(q,s))\right\}, \label{eq:epsilon_triangle_set2}
\end{align}
with $q,s\in[R]$, $q\neq s$ if $R$ is even, $z,x\in \FF_2$, 
and where
\begin{equation}
  \alpha(q,s)=\begin{cases}
      1 & q>s \text{ and } \{q,s\}\in E(G^{\text{occ}})\\
      0 & \text{otherwise}.
    \end{cases}
\end{equation}
The set $\mathcal{E}^{\triangle}$ consists of all edges in equations \eq{epsilon_triangle_set1_1}--\eq{epsilon_triangle_set2}.

It will turn out that \eq{restriction_h_triangle} is block diagonal, with blocks $\mathcal{W}_{(z,a,q)}\subseteq\mathcal{W}$ of size
\begin{equation}
  \left|\mathcal{W}_{(z,a,q)}\right|=\begin{cases}
    3R+2 & R\text{ odd}\\
    3R-1 & R\text{ even}
  \end{cases}
\end{equation}
for each for each triple $(z,a,q)$ with $z,a\in\FF_2$ and $q\in[R]$. Using equation \eq{num_basis_W} we can confirm that $|\mathcal{W}|=4R\left|\mathcal{W}_{(z,a,q)}\right|$, so this accounts for all basis vectors in $\mathcal{W}$. The subset of basis vectors for a given block is
\begin{align}
  \mathcal{W}_{(z,a,q)} 
    &=\big\{ |\psi_{z,a}^{q_{\text{in}}}\rangle,|\psi_{z,a}^{q_{\text{out}}}\rangle\big\} \cup\big\{ |\psi_{z,a}^{d(q,s)}\rangle\colon s\in[R],\, s\neq q\text{ if }R\text{ even}\big\} \nonumber \\
    &\quad \cup \big\{ |\psi_{\alpha(q,s),a}^{e_{zx}(q,s)}\rangle\colon x\in\{0,1\},\, s\in[R],\, s\neq q\text{ if }R\text{ even}\big\} .\label{eq:subset_W}
\end{align}
Using equation \eq{equation_for_h_epsilon_triangle} and the description of $\mathcal{E}^{\triangle}$ from using the edges of equations \eq{epsilon_triangle_set1_1} --\eq{epsilon_triangle_set2}, we can check by direct inspection that \eq{restriction_h_triangle} only has nonzero matrix elements between basis vectors in $\mathcal{W}$ from the same block.  The graph $G^\triangle$ was designed to expand the states $\ket{\overline{\psi_{z,a}}}$, and block structure reflects this idea.

We can now compute the matrix elements between states from the same block. For example, if $R$ is odd there are edges $\left\{ (q_{\text{in}},0,5k),(d(q,1),0,k)\right\}$ and $\{(q_{\text{in}},1,6k),(d(q,1),1,2k)\}$ in $\mathcal{E^{\triangle}}$. Using the fact that $|\psi_{z,a}^{l}\rangle=|l\rangle|\psi_{z,a},-\rangle$ where $|\psi_{z,a}\rangle$ is given by \eq{psi0m} and \eq{psi1m}, we can then compute the relevant matrix elements:
\begin{align}
  &\bra{\psi_{z,a}^{q_{\text{in}}}}h_{\mathcal{E}^{\triangle}}\ket{\psi_{z,a}^{d(q,1)}}\\ 
  &\quad=\bra{\psi_{z,a}^{q_{\text{in}}}}\Bigg(\sum_{x\in\FF_2}\big(|q_{\text{in}},x,5(k+x)\rangle+|d(q,1),(1+x)k,1\rangle\big)\nonumber\\
  &\qquad\qquad\qquad\big(\langle q_{\text{in}},x,(5+x)k|+\langle d(q,1),(1+x)k,1|\big)\otimes\II\Bigg)|\psi_{z,a}^{d(q,1)}\rangle\\
  &\quad=\sum_{x\in\FF_2}\langle\overline{\psi_{z,a}}|\left(|x,(5+x)k\rangle\langle x,(1+x)k|\otimes\II\right)|\overline{\psi_{z,a}}\rangle
    =\frac{1}{8k}.
\end{align}
Continuing in this manner, we can compute the principal submatrix of \eq{restriction_h_triangle} corresponding to the set $\mathcal{W}_{(z,a,q)}$. This matrix is shown in \fig{mat_els_for_a_blockA}. In the figure each vertex is associated with a state in the block and the weight on a given edge is the matrix element between the two states associated with vertices joined by that edge. The diagonal matrix elements are described by the weights on the self-loops. The matrix described by \fig{mat_els_for_a_blockA} is the same for each block.
\todo{fix this figure for the correct values $1/8k$}

\begin{figure}
\centering
\subfloat[][The matrix $h_{\mathcal{E}}^{\triangle}|_{\spn(\mathcal{W})}$ is block diagonal in the basis $\mathcal{W}$, with a block $\mathcal{W}_{(z,a,q)}$ for each $z,a \in \{0,1\}$ and $q\in\{1,\ldots, R\}$. The states involved in a given block and the matrix elements between them are depicted.
% Here $\alpha (q,s)$ is $1$ if $q>s$ and $\{ q,s\}\in E(G^{\text{occ}})$ and zero otherwise. The number of basis vectors in the block is $3R+2$ if $R$ is odd and $3R-1$ if $R$ is even.
]{
  \label{fig:mat_els_for_a_blockA}
  \tikzsetnextfilename{MP_mat_els_for_a_blockA}
  \input{../tikz/MP_mat_els_for_a_blockA.tex}
}
\\
\subfloat[][After multiplying some of the basis vectors by $-1$, the matrix depicted in \subfig{mat_els_for_a_blockA} is transformed into $1/8$ times the Laplacian matrix of this graph.]{
  \label{fig:mat_els_for_a_blockB}
  \tikzsetnextfilename{MP_mat_els_for_a_blockB}
  \input{../tikz/MP_mat_els_for_a_blockB.tex}
}
\caption{\label{fig:mat_els_for_a_block}}
\end{figure}

For each triple $(z,a,q)$ with $z,a\in\FF_2$ and $q\in[R]$, define
\begin{equation}
  |\phi_{z,a}^{q}\rangle=\begin{cases}
    \frac{1}{\sqrt{3R+2}}\Big[|\psi_{z,a}^{q_{\mathrm{in}}}\rangle+|\psi_{z,a}^{q_{\mathrm{out}}}\rangle+\sum_{j\in[R]}(-1)^j \left(|\psi_{z,a}^{d(q,j)}\rangle-|\psi_{\alpha(q,j),a}^{e_{z0}(q,j)}\rangle-|\psi_{\alpha(q,j),a}^{e_{z1}(q,j)}\rangle\right)\Big] & R\text{ odd}\\
    \frac{1}{\sqrt{3R-1}}\Big[|\psi_{z,a}^{q_{\mathrm{in}}}\rangle+|\psi_{z,a}^{q_{\mathrm{out}}}\rangle+\sum_{j<q}(-1)^j \left(|\psi_{z,a}^{d(q,j)}\rangle-|\psi_{\alpha(q,j),a}^{e_{z0}(q,j)}\rangle-|\psi_{\alpha(q,j),a}^{e_{z1}(q,j)}\rangle\right)\\
       \qquad \qquad \qquad-\sum_{j<q}(-1)^j \left(|\psi_{z,a}^{d(q,j)}\rangle-|\psi_{\alpha(q,j),a}^{e_{z0}(q,j)}\rangle-|\psi_{\alpha(q,j),a}^{e_{z1}(q,j)}\rangle\right)\Big]& R\text{ even.}
  \end{cases}
  \label{eq:phi_z_a_q}
\end{equation}
The choice to omit $d(q,q)$ for $R$ even ensures that $|\psi^{q_{\text{in}}}_{z,a}\rangle$ and $|\psi^{q_{\text{out}}}_{z,a}\rangle$ have the same sign in these ground states, similar to the original gate diagram this gate graph replaced.  We now show that these states span the ground space of $A(G^{\triangle})$.
\begin{lemma}
\label{lem:A(G_triangle)}
An orthonormal basis for the $e_{1}$-energy ground space of $A(G^{\triangle})$ is given by the states
\begin{equation}
  \left\{ |\phi_{z,a}^{q}\rangle:\, z,a\in\{0,1\},\, q\in[R]\right\} 
\end{equation}
defined by equation \eq{phi_z_a_q}. The eigenvalue gap is bounded as 
\begin{equation}
  \gamma(A(G^{\triangle})-e_{1}) > \frac{c_{\triangle}}{R^{2}},
\label{eq:G^triangle_lower_bnd}
\end{equation}
where $c_{\triangle}$ is a constant that only depends on the interaction $\mathcal{U}$.
\end{lemma}

\begin{proof}
The $e_1$-energy ground space of $A(G^{\triangle})$ is equal to the nullspace of \eq{restriction_h_triangle}. Since this operator is block diagonal in the basis $\mathcal{W}$, we can solve for the eigenvectors in the nullspace of each block. Thus, to prove the first part of the lemma, we will analyze the $|\mathcal{W}_{(z,a,q)}|\times|\mathcal{W}_{(z,a,q)}|$ matrix described by \fig{mat_els_for_a_blockA} and show that \eq{phi_z_a_q} is the unique vector in its nullspace. 

We first rewrite the matrix in a slightly different basis obtained by multiplying some of the basis vectors by a phase of $-1$. Specifically, we use the basis
\begin{equation}
\left\{
   |\psi_{z,a}^{q_{\mathrm{in}}}\rangle,
  -|\psi_{z,a}^{d(q,1)}\rangle,
   |\psi_{\alpha(q,1),a}^{e_{z0}(q,1)}\rangle,
   |\psi_{\alpha(q,1),a}^{e_{z1}(q,1)}\rangle,
   |\psi_{z,a}^{d(q,2)}\rangle,
  -|\psi_{\alpha(q,2),a}^{e_{z0}(q,2)}\rangle,
  -|\psi_{\alpha(q,2),a}^{e_{z1}(q,2)}\rangle,
   \ldots,
   |\psi_{z,a}^{q_{\mathrm{out}}}\rangle
\right\} 
\end{equation}
where the state associated with each vertex on one side of a bipartition of the graph is multiplied by $-1$; these are the phases appearing in equation \eq{phi_z_a_q}. Changing to this basis replaces the weight $\frac{1}{8k}$ on each edge in \fig{mat_els_for_a_blockA} by $-\frac{1}{8k}$ and does not change the weights on the self-loops. The resulting matrix is $\frac{1}{8k}L_{0}$, where $L_{0}$ is the Laplacian matrix of the graph shown in \fig{mat_els_for_a_blockB}. 

Now we use the fact that the Laplacian of any connected graph has smallest eigenvalue zero, with a unique eigenvector equal to the all-ones vector.
\todo{Find a citation for this claim}. Hence for each block we get an eigenvector in the nullspace of \eq{restriction_h_triangle}) given by \eq{phi_z_a_q}. Ranging over all $z,a\in\FF_2$ and $q\in[R]$ gives the claimed basis for the $e_1$-energy ground space of $A(G^{\triangle})$.

To prove the lower bound on the eigenvalue gap, we use the Nullspace Projection Lemma (\lem{npl}) with 
\begin{equation}
H_{A}=A(G^{\diamondsuit})-e_{1}\qquad H_{B}=h_{\mathcal{E}^{\triangle}}
\end{equation}
and where $S=\spn(\mathcal{W})$ is the nullspace of $H_{A}$ as shown in \sec{The-gate-graph_G_DIAMOND}. Since the restriction of $H_B$ to $\mathcal{S}$ is block diagonal in the basis $\mathcal{W}$, the smallest nonzero eigenvalue of \eq{restriction_h_triangle} is equal to the smallest nonzero eigenvalue of one of its blocks. The matrix for each block is $\frac{1}{8k}L_{0}$. Thus we can lower bound the smallest nonzero eigenvalue of $H_B|_S$ using standard bounds on the smallest nonzero eigenvalue of the Laplacian $L$ of a graph $G$. In particular, Theorem 4.2 of reference \cite{Moh91} shows that 
\begin{equation*}
  \gamma(L) \geq \frac{4}{|V(G)| \diam(G)} \geq \frac{4}{|V(G)|^2}
\end{equation*}
(where $\diam(G)$ is the diameter of $G$). Since the size of the graph in \fig{mat_els_for_a_blockB} is either $3R-1$ or $3R+2$, we have
\begin{equation*}
  \gamma(H_{B}|_{S})=\frac{1}{8k}\gamma(L_{0}) \geq \frac{1}{8k}\frac{4}{\left(3R+2\right)^{2}}\geq\frac{1}{32kR^{2}}
\end{equation*}
since $R\geq2$. 

Using this bound and the fact that $\gamma(H_{A})>c_{\diamondsuit}$ (from equation \eq{one_thirteenth_bound}) and $\left\Vert H_{B}\right\Vert =2$ (from equation \eq{h_E_bound}) and plugging into \lem{npl} gives
\begin{equation}
  \gamma(A(G^{\triangle})-e_{1})\geq\frac{c_{\diamondsuit}\cdot\frac{1}{32kR^{2}}}{c_{\diamondsuit}+2}>\frac{c_{\diamondsuit}}{94 kR^{2}}=\frac{c_{\triangle}}{R^2}. 
\end{equation}
where we used the fact that $c_{\diamondsuit} \leq 1$, and we define $c_\triangle = c_{\diamondsuit}/(96k)$.  As $c_\diamondsuit$ is a constant that only depends on the interaction, so too is $c_\triangle$.
\end{proof}


%=============================================================================
\subsection{The Hamiltonian $H(G^{\triangle},N)$}

With the previous sections results about the graph $G^{\triangle}$, and in particular knowing its ground states and eigenvalue gap, we can now analyze the multi-particle Hamiltonian.  Namely, we can now consider the $N$-particle Hamiltonian $H(G^{\triangle},N)$ and solve for its nullspace. 

In preparation for understanding the $N$-particle states, it will be useful to note the following fact about the subsets $\mathcal{W}_{(z,a,q)}\subset\mathcal{W}$ defined in equation \eq{subset_W}.
\begin{definition}
\label{defn:overlap_diagram_element}
  We say $\mathcal{W}_{(z_{1},a_{1},q_{1})}$ and $\mathcal{W}_{(z_{2},a_{2},q_{2})}$ \emph{overlap on a diagram element} if there exists $l\in L^{\square}$ such that $|\psi_{x_{1},b_{1}}^{l}\rangle\in\mathcal{W}_{(z_{1},a_{1},q_{1})}$ and $|\psi_{x_{2},b_{2}}^{l}\rangle\in\mathcal{W}_{(z_{2},a_{2},q_{2})}$ for some $x_{1},x_{2},b_{1},b_{2}\in\FF_2$.
\end{definition}

\begin{fact}
[Key property of $\mathcal{W}_{(z,a,q)}$]\label{fct:block_property}
Sets $\mathcal{W}_{(z_{1},a_{1},q_{1})}$ and $\mathcal{W}_{(z_{2},a_{2},q_{2})}$ overlap on a diagram element if and only if $q_{1}=q_{2}$ or $\{q_{1},q_{2}\}\in E(G^{\text{occ}})$.
\end{fact}
This fact can be confirmed by direct inspection of the sets $\mathcal{W}_{(z,a,q)}$. If $q_{1}=q_{2}=q$ the diagram element $l$ on which they overlap can be chosen to be $l=q_{\mathrm{in}}$; if $q_{1}\neq q_{2}$ and $\{q_{1},q_{2}\}\in E(G^{\text{occ}})$ then $l=e_{z_{1}z_{2}}(q_{1},q_{2})=e_{z_{2}z_{1}}(q_{2},q_{1})$.
Conversely, if $\{q_1,q_2\} \notin E(G^{\text{occ}})$ with $q_1 \ne q_2$, then there is no overlap.  This fact is the intuitive reason behind our construction of $G^\square$; we designed the graph $G^\triangle$ so that \fct{block_property} held.

We will show that the nullspace $\mathcal{I}_{\triangle}$ of $H(G^{\triangle},N)$ is 
\begin{align}
  \mathcal{I}_{\triangle}&=\spn\big\{|\phi_{z_{1},a_{1}}^{q_{1}}\rangle|\phi_{z_{2},a_{2}}^{q_{2}}\rangle\ldots|\phi_{z_{N},a_{N}}^{q_{N}}\rangle\colon
\text{$z_{i},a_{i}\in\FF_2$, $q_{i}\in[R]$, $q_{i}\neq q_{j}$, and $\{q_{i},q_{j}\}\notin E(G^{\text{occ}})$}\big\},
\label{eq:I_triangle}
\end{align}
for $\dmax > 0$, and if $\dmax = 0$ we will show that when restricted to symmetric states, the nullspace of $H(G^{\triangle},N)$ is 
\begin{align}
  \mathcal{I}_{\triangle}^{\Sym} &=  \big\{ \Sym ( \ket{\Phi}) \; : \; \ket{\Phi} \in \mathcal{I}_{\triangle}\big\}.
\end{align}
Note that $\mathcal{I}_{\triangle}$ is very similar to $\mathcal{I}(G,G^{\text{occ}},N)$ (from equation \eq{occup_space_defn}) but with each single-particle state $|\psi_{z,a}^{q}\rangle\in\mathcal{Z}_{N}(G)$ replaced by $|\phi_{z,a}^{q}\rangle\in\mathcal{Z}_{N}(G^{\triangle})$ (with the same similarity for the symmetric states).

\todo{Change from $\mathcal{Z}$ to something else}

\begin{lemma}
\label{lem:The-nullspace-of_H_triangle}The nullspace of $H(G^{\triangle},N)$ is $\mathcal{I}_{\triangle}$ as defined in equation \eq{I_triangle} for $\dmax >0$, or when restricted to symmetric states the nullspace of $H(G^\triangle,N)$ is $\mathcal{I}_\triangle^{\Sym}$. In either case, its smallest nonzero eigenvalue is 
\begin{equation}
\gamma(H(G^{\triangle},N)) > \frac{\gamma_{\triangle}}{R^{7}},\label{eq:lowerbound_HG_triangle}
\end{equation}
where $\gamma_{\triangle}$ is a constant that only depends on $\mathcal{U}$.
\end{lemma}

In addition to \fct{block_property}, we use the following simple fact in the proof of the Lemma.

\begin{fact}
\label{fct:lin_alg_fact}
Let $|p\rangle=c|\alpha_{0}\rangle+\sqrt{1-c^{2}}|\alpha_{1}\rangle$ with $\langle\alpha_{i}|\alpha_{j}\rangle=\delta_{ij}$ and $c\in[0,1]$. Then
\begin{equation}
|p\rangle\langle p|=c^{2}|\alpha_{0}\rangle\langle\alpha_{0}|+M
\end{equation}
where $\left\Vert M\right\Vert \leq1-\frac{3}{4}c^{4}$.
\end{fact}

To prove this Fact, one can calculate $\left\Vert M\right\Vert =\frac{1}{2}(1-c^{2})+\frac{1}{2}\sqrt{1+2c^{2}-3c^{4}}$ and use the inequality $\sqrt{1+x}\leq1+\frac{x}{2}$ for $x\geq-1$.

\begin{proof}[Proof of \protect\lem{The-nullspace-of_H_triangle}]  Using equation \eq{A_g_diamond_triangle} and the fact that the smallest eigenvalues of $A(G^{\diamondsuit})$ and $A(G^{\triangle})$ are the same (equal to $e_{1}$, from \sec{The-gate-graph_G_DIAMOND} and \lem{A(G_triangle)}), we can break the MPQW-Hamiltonian on $G^\triangle$ into three terms.  Namely, we have
\begin{equation}
  H(G^{\triangle},N)=H(G^{\diamondsuit},N)+\sum_{w=1}^{N}h_{\mathcal{E}^{\triangle}}^{(w)} + B,\label{eq:H_G^triangle,diamond}
\end{equation}
where $B$ is the change in interaction terms resulting from vertices changing distance.  It is important to realize that $B$ only adds terms to the Hamiltonian, as any vertices that were originally at a distance less than $\dmax$ remain at the same distance when adding the edges in $\mathcal{E}^\triangle$, and thus $B$ is positive semi-definite.  Recall from \lem{The-nullspace-of_Hdiamond} that the nullspace of $H(G^{\diamondsuit},N)$ is $\mathcal{I}_{\diamondsuit}$ (or $\mathcal{I}_\diamondsuit^{\Sym}$ if we are restricting to symmetric states). We consider 
\begin{equation}
  \sum_{w=1}^{N}h_{\mathcal{E}^{\triangle}}^{(w)}\bigg|_{\mathcal{I}_{\diamondsuit}}.\label{eq:restriction to script R}
\end{equation}
We show that its nullspace is equal to $\mathcal{I}_{\triangle}$, and we lower bound its smallest nonzero eigenvalue. Specifically, we prove
\begin{equation}
  \gamma\left(\sum_{w=1}^{N}h_{\mathcal{E}^{\triangle}}^{(w)}\bigg|_{\mathcal{I}_{\diamondsuit}}\right)>\frac{12c_{\triangle}}{(4R)^{6}}.\label{eq:bound_R6}
\end{equation}
Additionally, we will show that $B$ annihilates those states in $\mathcal{I}_{\triangle}$, so that $\mathcal{I}_{\triangle}$ is the nullspace of $H(G^{\triangle},N)$ as claimed.

We will first prove equation \eq{lowerbound_HG_triangle} using this bound on the added movement terms (equation \eq{bound_R6}) and the fact that $B$ annihilates $\mathcal{I}_{\triangle}$. We apply the Nullspace Projection Lemma (\lem{npl}) with $H_{A}$ and $H_{B}$ given by the first and second terms in equation \eq{H_G^triangle,diamond}; in this case the nullspace of $H_{A}$ is $S=\mathcal{I}_{\diamondsuit}$ (from \lem{The-nullspace-of_Hdiamond}). Now applying \lem{npl} and using the bounds $\gamma(H_{A})>\frac{1}{300}$ (from \lem{The-nullspace-of_Hdiamond}), $\left\Vert H_{B}\right\Vert \leq N\left\Vert h_{\mathcal{E}^{\triangle}}\right\Vert =2N\leq2R$ (from equation \eq{h_E_bound} and the fact that $N\leq R$), and the bound \eq{bound_R6} on $\gamma(H_{B}|_{S})$, we find
\begin{equation}
  \gamma(H(G^{\triangle},N)-M)\geq\frac{\frac{12c_{\triangle}\gamma_{\diamondsuit}}{(4R)^{6}}}{\gamma_{\diamondsuit}+2R}\geq\frac{16 \gamma_{\diamondsuit} c_{\triangle}}{(4R)^7}=\frac{\gamma_\triangle}{R^{7}}.
\end{equation}
If we then remember the fact that $M$ annihilates all states in $\mathcal{I}_{\triangle}$, we can use a variational argument to show that the same bound holds for the entire MPQW Hamiltonian (i.e., adding $M$ to the Hamiltonian does not reduce the gap):
\begin{equation}
  \gamma(H(G^{\triangle},N)) \geq \frac{\gamma_{\triangle}}{R^7}.
\end{equation}

With the final reductions for the proof completed, we must now establish that $B$ annihilates all terms in $\mathcal{I}_{\triangle}$, the nullspace of \eq{restriction to script R} is $\mathcal{I}_{\triangle}$, and prove the lower bound \eq{bound_R6}.  Let us first show that each state in $\mathcal{I}_{\triangle}$ has no energy penalty due to new interactions arising from the addition of edges in the graph $G^{\triangle}$.  By definition, note that the only vertices in $G^{\triangle}$ that have vertices at a distance closer than $\dmax$ either belong to the same diagram element, belong to diagram elements corresponding to $\{q_{\text{in}}, q_{\text{out}}, d(q,s)\}$ for some $q\in [R]$, or else belong to diagram elements labeled $\{d(q,s), e_{z_1,z_2}(q,s)\}$ for some $q,s\in [R]$, and $z_1,z_2\in \FF_2$.  As such, if any state has energy penalties resulting from the added edges (i.e., is not annihilated by the operator $B$,), then it must have at least two particles located on one of these pairs of diagram elements.  However, each state $\ket{\Phi}\in \mathcal{I}_{\triangle}$ is guaranteed to only have a single particle on each such pair of diagram elements, by construction.  Hence, $B\ket{\Phi} = 0$.

To analyze \eq{restriction to script R} we use the fact (established in \sec{The-gate-graph_G_triangle}) that \eq{restriction_h_triangle} is block diagonal with a block $\mathcal{W}_{(z,a,q)}\subset\mathcal{W}$ for each triple $(z,a,q)$ with $z,a\in\FF_2$ and $q\in[R]$, as the operator \eq{restriction to script R} inherits a block structure from this fact. For any basis vector 
\begin{equation}
  \Sym(|\psi_{z_{1},a_{1}}^{q_{1}}\rangle|\psi_{z_{2},a_{2}}^{q_{2}}\rangle\ldots|\psi_{z_{N},a_{N}}^{q_{N}}\rangle)\in\mathcal{I}_{\diamondsuit},
\label{eq:basis_vector_in_scriptF}
\end{equation}
we define a set of occupation numbers that correspond to the number of particles in each block.  Namely, we will define
\begin{equation}
  \mathcal{N}=\left\{ N_{(x,b,r)} \colon x,b\in\{0,1\},\, r\in[R]\right\} 
\end{equation}
where
\begin{equation}
  N_{(x,b,r)}
  =|\{j \colon |\psi_{z_{j},a_{j}}^{q_{j}}\rangle\in\mathcal{W}_{(x,b,r)}\}|.
\end{equation}
Observe that \eq{restriction to script R} conserves the set of occupation numbers (due to the inherited block structure) and is therefore block diagonal with a block for each possible set $\mathcal{N}$. 

For a given block corresponding to a set of occupation numbers $\mathcal{N}$, we write $\mathcal{I}_{\diamondsuit}(\mathcal{N})\subset\mathcal{\mathcal{I}_{\diamondsuit}}$ for the subspace spanned by basis vectors \eq{basis_vector_in_scriptF} in the block. We classify the blocks into three categories depending on $\mathcal{N}$.

\begin{mdframed}[frametitle=Classification of the blocks of \eq{restriction to script R} according to $\mathcal{N}$]
Consider the following two conditions on a set $\mathcal{N}=\{ N_{(x,b,r)}\colon x,b\in\{0,1\},\, r\in[R]\}$
of occupation numbers:
\begin{enumerate}[label=(\alph*)]
\item $N_{(x,b,r)}\in\{0,1\}$ for all $x,b\in\{0,1\}$ and
$r\in[R]$. If this holds, write $\left(y_{i},c_{i},s_{i}\right)$ for the nonzero occupation numbers (with some arbitrary ordering), i.e., $N_{(y_{i},c_{i},s_{i})}=1$ for $i\in[N]$.
\item The sets $\mathcal{W}_{(y_{i},c_{i},s_{i})}$ and $\mathcal{W}_{(y_{j},c_{j},s_{j})}$
do not overlap on a diagram element for all distinct $i,j\in[N]$.
\end{enumerate}
We say a block is of type 1 if $\mathcal{N}$ satisfies (a) and (b). We say it is of type 2 if $\mathcal{N}$ does not satisfy (a). We say it is of type 3 if $\mathcal{N}$ satisfies (a) but does not satisfy (b).
\end{mdframed}


Note that every block must be of type 1, 2, or 3.  We will show that each block of type $1$ contains one state in the nullspace of \eq{restriction to script R} and, ranging over all blocks of this type, we will obtain a basis for $\mathcal{I}_{\triangle}$. We will also show that the smallest nonzero eigenvalue within a block of type 1 is at least $\frac{\gamma_{\diamondsuit}}{R^{2}}$.  We will then show that blocks of type 2 and 3 do not contain any states in the nullspace of \eq{restriction to script R} and that the smallest eigenvalue within any block of type 2 or 3 is greater than \todo{get correct bound}$\frac{12c_{\triangle}}{(4R)^6}$. Hence, the nullspace of \eq{restriction to script R} is $\mathcal{I}_{\triangle}$ and its smallest nonzero eigenvalue is lower bounded as in equation \eq{bound_R6}.

%%%%%%%%%%%%%
\smallskip
\noindent \textbf{Type 1}
\smallskip

\noindent Let us first investigate those blocks of type 1.  Note (from \defn{overlap_diagram_element}) that requirement (b) implies $q\neq r$ whenever 
\begin{equation}
|\psi_{x,b}^{q}\rangle\in\mathcal{W}_{(y_{i},c_{i},s_{i})}\text{ and }|\psi_{z,a}^{r}\rangle\in\mathcal{W}_{(y_{j},c_{j},s_{j})}
\end{equation}
for distinct $i,j\in[N]$. Hence, we can remove the requirement that $q_i\neq q_j$:
\begin{align}
\mathcal{\mathcal{I}_{\diamondsuit}}(\mathcal{N}) & =\spn\{ \Sym(|\psi_{z_{1},a_{1}}^{q_{1}}\rangle|\psi_{z_{2},a_{2}}^{q_{2}}\rangle\ldots|\psi_{z_{N},a_{N}}^{q_{N}}\rangle)\colon q_{i}\neq q_{j}\text{ and }|\psi_{z_{j},a_{j}}^{q_{j}}\rangle\in\mathcal{W}_{(y_{j},c_{j},s_{j})}\} \\
 & =\spn\{ \Sym(|\psi_{z_{1},a_{1}}^{q_{1}}\rangle|\psi_{z_{2},a_{2}}^{q_{2}}\rangle\ldots|\psi_{z_{N},a_{N}}^{q_{N}}\rangle)\colon|\psi_{z_{j},a_{j}}^{q_{j}}\rangle\in\mathcal{W}_{(y_{j},c_{j},s_{j})}\}.
\end{align}
From this we see that 
\begin{equation}
\dim(\mathcal{I}_{\diamondsuit}(\mathcal{N}))=\prod_{j=1}^{N}\left|{\mathcal{W}_{(y_{j},c_{j},s_{j})}}\right|=\begin{cases}
\left(3R+2\right)^{N} & R\text{ odd}\\
\left(3R-1\right)^{N} & R\text{ even.}
\end{cases}
\end{equation}
We now solve for all the eigenstates of \eq{restriction to script R} within the block. 

As we need only understand the eigenvectors of each individual block, it will be useful to remember \lem{A(G_triangle)} as we have already determined all of the single-particle eigenstates.  It will convenient to write an orthonormal basis of eigenvectors of the $|\mathcal{W}_{(z,a,q)}|\times|\mathcal{W}_{(z,a,q)}|$ matrix described by \fig{mat_els_for_a_blockA} as 
\begin{equation}
|\phi_{z,a}^{q}(u)\rangle, \quad u\in[|\mathcal{W}_{(z,a,q)}|]\label{eq:phi_u}
\end{equation}
and their ordered eigenvalues as
\begin{equation}
\theta_{1}\leq\theta_{2}\leq\ldots\leq\theta_{|\mathcal{W}_{(z,a,q)}|}.
\end{equation}
From the proof of \lem{A(G_triangle)}, the eigenvector with smallest eigenvalue $\theta_{1}=0$ is $|\phi_{z,a}^{q}\rangle=|\phi_{z,a}^{q}(1)\rangle$ and $\theta_{2}\geq\frac{c_{\diamondsuit}}{R^{2}}$. For any $u_{1},u_{2},\ldots,u_{N}\in [|\mathcal{W}_{(z,a,q)}|]$, the state 
\begin{equation}
\Sym(|\phi_{y_{1},c_{1}}^{s_{1}}(u_{1})\rangle|\phi_{y_{2},c_{2}}^{s_{2}}(u_{2})\rangle\ldots|\phi_{y_{N},c_{N}}^{s_{N}}(u_{N})\rangle)
\end{equation}
is an eigenvector of \eq{restriction to script R} with eigenvalue $\sum_{j=1}^{N}\theta_{u_j}.$ Furthermore, states corresponding to different choices of $u_{1},\ldots,u_{N}$ are orthogonal, and ranging over all $\dim(\mathcal{I}_{\diamondsuit}(\mathcal{N}))$ choices we get every eigenvector in the block. The smallest eigenvalue within the block is $N\theta_{1}=0$ and there is a unique vector in the nullspace, given by
\begin{equation}
  \ket{\Phi_\mathcal{N}} := \Sym(|\phi_{y_{1},c_{1}}^{s_{1}}\rangle|\phi_{y_{2},c_{2}}^{s_{2}}\rangle\ldots|\phi_{y_{N},c_{N}}^{s_{N}}\rangle)\label{eq:vector_type1}
\end{equation}
(recall $|\phi_{z,a}^{q}\rangle=|\phi_{z,a}^{q}(1)\rangle$). The smallest nonzero eigenvalue of \eq{restriction to script R} within the block is $(N-1)\theta_{1}+\theta_{2}=\theta_{2}\geq\frac{c_{\diamondsuit}}{R^{2}}$.

With the knowledge that each state of the form \eq{vector_type1} minimizes the energy of \eq{restriction to script R}, and is in fact the unique ground state within a particular type 1 block, we will now show that the collection of all such states span the space $\mathcal{I}_{\triangle}$.  As the second requirement on type 1 blocks requires that the sets $\mathcal{W}_{(y_i,c_i,s_i)}$ no not pairwise overlap, we can use \fct{block_property} to see that this is equivalent to the sets satisfying $s_{i}\neq s_{j}$ and $\{s_{i},s_{j}\}\notin E(G^{\text{occ}})$ for distinct $i,j\in[N]$ (as well as arbitrary $y_i$ and $c_i$). Hence the set of states \eq{vector_type1} obtained from of all blocks of type 1 is 
\begin{align}
  &\big\{ \ket{\Phi_\mathcal{N}} : \mathcal{N} \text{ is a type 1 block}\big\}\nonumber\\
  &\qquad=\big\{ \Sym(|\phi_{y_{1},c_{1}}^{s_{1}}\rangle|\phi_{y_{2},c_{2}}^{s_{2}}\rangle\ldots|\phi_{y_{N},c_{N}}^{s_{N}}\rangle)\colon \nonumber\\
  &\qquad\qquad\qquad\forall i,j\in [N], y_{i},c_{i}\in\FF_2,\, s_{i}\in[R],\, i\neq j \Rightarrow s_{i}\neq s_{j}\text{ and }\,\{s_{i},s_{j}\}\notin E(G^{\text{occ}})\big\} 
\end{align}
which by definition spans $\mathcal{I}_{\triangle}$.

\medskip

\noindent \textbf{Type 2}

\smallskip

\noindent Now let $\mathcal{N}$ be of type 2.  We then have that there exist $x,b\in\FF_2$ and $r\in[R]$ such that $N_{(x,b,r)}\geq2$. We will show there are no eigenvectors in the nullspace of \eq{restriction to script R} within a block of this type and we lower bound the smallest eigenvalue within the block. Specifically, we show
\begin{equation}
  \min_{|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})}\langle\kappa|\sum_{w=1}^{N}h_{\mathcal{E}^{\triangle}}^{(w)}|\kappa\rangle >\frac{12c_{\triangle}}{(4R)^6}.\label{eq:boundfortype2}
\end{equation}
First note that all $|\kappa\rangle\in\mathcal{I}_{\diamondsuit}$ satisfy $(A(G^{\diamondsuit})-e_{1})^{(w)}|\kappa\rangle=0$ for each $w\in [N]$, which can be seen using the definition of $\mathcal{I}_{\diamondsuit}$ and the fact that $\mathcal{W}$ spans the nullspace of $A(G^{\diamondsuit})-e_{1}$. We can then add these terms to equation \eq{A_g_diamond_triangle}, so that
\begin{equation}
  \min_{|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})}\langle\kappa|\sum_{w=1}^{N}h_{\mathcal{E}^{\triangle}}^{(w)}|\kappa\rangle=\min_{|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})}\langle\kappa|\sum_{w=1}^{N}\left(A(G^{\triangle})-e_{1}\right)^{(w)}|\kappa\rangle.\label{eq:min_over_blockFbl}
\end{equation}
If we then examine only the ground space of this operator, we can see that
\begin{align}
  \sum_{w=1}^{N}\left(A(G^{\triangle})-e_{1}\right)^{(w)}
  & \geq\gamma\left(\sum_{w=1}^{N}\left(A(G^{\triangle})-e_{1}\right)^{(w)}\right)\cdot
    \left(1-\Pi^{\triangle}\right) \nonumber \\
  &= \gamma(A(G^{\triangle})-e_{1})\cdot\left(1-\Pi^{\triangle}\right)
   > \frac{c_{\triangle}}{R^{2}}\left(1-\Pi^{\triangle}\right),
\label{eq:op_ineq_A_Gtriangle}
\end{align}
where $\Pi^{\triangle}$ is the projector onto the nullspace of $\sum_{w=1}^{N}\left(A(G^{\triangle})-e_{1}\right)^{(w)}$, and where in the last step we used \lem{A(G_triangle)}. Plugging equation \eq{op_ineq_A_Gtriangle} into equation \eq{min_over_blockFbl} gives
\begin{equation}
  \min_{|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})}\langle\kappa|\sum_{w=1}^{N}h_{\mathcal{E}^{\triangle}}^{(w)}|\kappa\rangle>\frac{c_{\triangle}}{R^{2}}\Big(1-\max_{|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})}\langle\kappa|\Pi^{\triangle}|\kappa\rangle\Big).\label{eq:bound1}
\end{equation}

Using \lem{A(G_triangle)} we can write $\Pi^{\triangle}$ explicitly as
\begin{equation}
\Pi^{\triangle}=\sum_{(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}}\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}\label{eq:Pi_N_triangle}
\end{equation}
where 
\begin{align}
  \mathcal{P}_{(\vec{z},\vec{a},\vec{q})} & =|\phi_{z_{1},a_{1}}^{q_{1}}\rangle\langle\phi_{z_{1},a_{1}}^{q_{1}}|\otimes|\phi_{z_{2},a_{2}}^{q_{2}}\rangle\langle\phi_{z_{2},a_{2}}^{q_{2}}|\otimes\cdots\otimes|\phi_{z_{N},a_{N}}^{q_{N}}\rangle\langle\phi_{z_{N},a_{N}}^{q_{N}}|\\
  \mathcal{Q} & =\left\{ (z_{1},\ldots z_{N},a_{1},\ldots,a_{N},q_{1},\ldots,q_{N}):\, z_{i},a_{i}\in\FF_2\text{ and }q_{i}\in[R]\right\} .
\end{align}
Essentially, each particle is projected onto the ground state of a block, where the blocks are labeled by the elements of $\mathcal{Q}$ and there are no correlations between the particles.  For each $(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}$ we also define a space 
\begin{equation}
  S_{(\vec{z},\vec{a},\vec{q})}=\spn(\mathcal{W}_{(z_{1},a_{1},q_{1})})\otimes\spn(\mathcal{W}_{(z_{2},a_{2},q_{2})})\otimes\cdots\otimes\spn(\mathcal{W}_{(z_{N},a_{N},q_{N})}).
\end{equation}
Note that $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}$ has all of its support in $S_{(\vec{z},\vec{a},\vec{q})}$, and that
\begin{equation}
S_{(\vec{z},\vec{a},\vec{q})}\perp S_{(\vec{z}^{\prime},\vec{a}^{\prime},\vec{q}^{\prime})}\text{ for distinct }(\vec{z},\vec{a},\vec{q}),(\vec{z}^{\prime},\vec{a}^{\prime},\vec{q}^{\prime})\in\mathcal{Q}.\label{eq:perp_S}
\end{equation}
Therefore $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}\mathcal{P}_{(\vec{z}^{\prime},\vec{a}^{\prime},\vec{q}^{\prime})}=0$ for distinct $(\vec{z},\vec{a},\vec{q}),(\vec{z}^{\prime},\vec{a}^{\prime},\vec{q}^{\prime})\in\mathcal{Q}$. (Below we use similar reasoning to obtain a less obvious result.) Note that $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}$ is orthogonal to $\mathcal{I}_{\diamondsuit}(\mathcal{N})$ unless 
\begin{equation}
\left|\left\{ j:(z_{j},a_{j},q_{j})=(w,u,v)\right\} \right|=N_{(w,u,v)}\text{ for all }w,u\in\{0,1\},\, v\in[R].\label{eq:satisfy_occ_numbers}
\end{equation}
We restrict our attention to the projectors that are not orthogonal to $\mathcal{I}_{\diamondsuit}(\mathcal{N})$. Letting $\mathcal{Q}(\mathcal{N})\subset\mathcal{Q}$ be the set of $(\vec{z},\vec{a},\vec{q})$ satisfying equation \eq{satisfy_occ_numbers}, we have
\begin{equation}
\langle\kappa|\sum_{(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}}\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}|\kappa\rangle=\langle\kappa|\sum_{(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})}\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}|\kappa\rangle\quad\text{for all }|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N}).\label{eq:restrict_attention_mathcalN}
\end{equation}

Since $N_{(x,b,r)}\geq2$, note that in each term $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}$ with $(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})$, the operator 
\begin{equation}
|\phi_{x,b}^{r}\rangle\langle\phi_{x,b}^{r}|\otimes|\phi_{x,b}^{r}\rangle\langle\phi_{x,b}^{r}|
\end{equation}
appears between two of the $N$ registers (tensored with rank-1 projectors on the other $N-2$ registers). Using equation \eq{phi_z_a_q} we may expand $|\phi_{x,b}^{r}\rangle$ as a sum of states from $\mathcal{W}_{(x,b,r)}$. This gives
\begin{equation}
|\phi_{x,b}^{r}\rangle|\phi_{x,b}^{r}\rangle=c_{0}|\psi_{x,b}^{r_{\text{in}}}\rangle|\psi_{x,b}^{r_{\text{in}}}\rangle+\left(1-c_{0}^{2}\right)^{\frac{1}{2}}|\Phi_{x,b}^{r}\rangle
\end{equation}
where $c_{0}$ is either $\frac{1}{3R+2}$ (if $R$ is odd) or $\frac{1}{3R-1}$ (if $R$ is even), and where $|\psi_{x,b}^{r_{\text{in}}}\rangle|\psi_{x,b}^{r_{\text{in}}}\rangle$ is orthogonal to $|\Phi_{x,b}^{r}\rangle$. Note that each of the states $|\phi_{x,b}^{r}\rangle|\phi_{x,b}^{r}\rangle$, $|\psi_{x,b}^{r_{\text{in}}}\rangle|\psi_{x,b}^{r_{\text{in}}}\rangle$, and $|\Phi_{x,b}^{r}\rangle$ lie in the space 
\begin{equation}
\spn(\mathcal{W}_{(x,b,r)})\otimes\spn(\mathcal{W}_{(x,b,r)}).
\label{eq:tensor_prod_WW}
\end{equation}
Now applying \fct{lin_alg_fact} gives
\begin{equation}
|\phi_{x,b}^{r}\rangle\langle\phi_{x,b}^{r}|\otimes|\phi_{x,b}^{r}\rangle\langle\phi_{x,b}^{r}|=c_{0}^{2}|\psi_{x,b}^{r_{\text{in}}}\rangle\langle\psi_{x,b}^{r_{\text{in}}}|\otimes|\psi_{x,b}^{r_{\text{in}}}\rangle\langle\psi_{x,b}^{r_{\text{in}}}|+M_{x,b}^{r}\label{eq:expand_phi_phi_proj}
\end{equation}
where $M_{x,b}^{r}$ is a Hermitian operator with all of its support on the space \eq{tensor_prod_WW} and
\begin{equation}
\left\Vert M_{x,b}^{r}\right\Vert \leq1-\frac{3}{4}c_{0}^{4}\leq1-\frac{3}{4}\left(\frac{1}{3R+2}\right)^{4}\leq1-\frac{3}{4}\frac{1}{(4R)^4}
\end{equation}
since $R\geq2$. For each $(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})$ we define $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}^{M}$ to be the operator obtained from $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}$ by replacing
\begin{equation}
|\phi_{x,b}^{r}\rangle\langle\phi_{x,b}^{r}|\otimes|\phi_{x,b}^{r}\rangle\langle\phi_{x,b}^{r}|\mapsto M_{x,b}^{r}
\end{equation}
on two of the registers (if $N_{(x,b,r)}>2$ there is more than one way to do this; we fix one choice for each $(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})$). Note that $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}^{M}$ has all of its support in the space $S_{(\vec{z},\vec{a},\vec{q})}$. Using \eq{perp_S} gives
\begin{equation}
\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}^{M}\mathcal{P}_{(\vec{z}^{\prime},\vec{a}^{\prime},\vec{q}^{\prime})}^{M}=0\text{ for distinct }(\vec{z},\vec{a},\vec{q}),(\vec{z}^{\prime},\vec{a}^{\prime},\vec{q}^{\prime})\in\mathcal{Q}(\mathcal{N}).
\end{equation}
Using equation \eq{expand_phi_phi_proj} and the fact that
\begin{equation}
\langle\kappa|\Big(|\psi_{x,b}^{r_{\text{in}}}\rangle\langle\psi_{x,b}^{r_{\text{in}}}|^{(w_{1})}\Big)\Big(|\psi_{x,b}^{r_{\text{in}}}\rangle\langle\psi_{x,b}^{r_{\text{in}}}|^{(w_{2})}\Big)|\kappa\rangle=0\quad\text{for all }|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})\text{ and distinct }w_{1},w_{2}\in[N]
\end{equation}
(which can be seen from the definition of $\mathcal{I}_\diamondsuit$), we have 
\begin{equation}
\langle\kappa|\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}|\kappa\rangle=\langle\kappa|\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}^{M}|\kappa\rangle\quad\text{for all }|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N}).
\end{equation}
Hence, letting 
\begin{equation}
\Pi_{\mathcal{N}}^{\triangle}=\sum_{(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})}\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}^{M},\label{eq:pi_triangle_N}
\end{equation}
we have $\langle\kappa|\Pi^{\triangle}|\kappa\rangle=\langle\kappa|\Pi_{\mathcal{N}}^{\triangle}|\kappa\rangle$ for all $|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})$. To obtain the desired bound \eq{bound_norm_pi_triangle_n} on the norm of $\Pi_{\mathcal{N}}^{\triangle}$, we use the fact that the norm of a sum of pairwise orthogonal Hermitian operators is upper bounded by the maximum norm of an operator in the sum, so
\begin{equation}
  \big\Vert \Pi_{\mathcal{N}}^{\triangle}\big\Vert 
    =\Bigg\Vert \sum_{(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})}\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}^{M}\Bigg\Vert 
    =\max_{(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})}\big\Vert \mathcal{P}_{(\vec{z},\vec{a},\vec{q})}^{M}\big\Vert 
    =\left\Vert M_{x,b}^{r}\right\Vert \leq1-\frac{3}{4}\frac{1}{\left(4R\right)^{4}}.
  \label{eq:bound_on_norm_pi_n_triangle}
\end{equation}

Putting this together, we then have that
\begin{equation}
  \max_{\ket{\kappa}\in \mathcal{I}_{\diamondsuit}(\mathcal{N})} \bra{\kappa} \Pi^{\triangle} \ket{\kappa} = \max_{\ket{\kappa}\in \mathcal{I}_{\diamondsuit}(\mathcal{N})} \bra{\kappa} \Pi^{\triangle}_{\mathcal{N}} \ket{\kappa} \leq \norm{\Pi^{\triangle}_{\mathcal{N}}} \leq 1 - \frac{3}{4(4R)^4}.
\end{equation}
If we then use \eq{bound1}, we have that
\begin{equation}
  \min_{|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})}\langle\kappa|\sum_{w=1}^{N}h_{\mathcal{E}^{\triangle}}^{(w)}|\kappa\rangle>\frac{c_{\triangle}}{R^{2}}\Big(1-\max_{|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})}\langle\kappa|\Pi^{\triangle}|\kappa\rangle\Big) \geq \frac{12c_{\triangle}}{(4R)^6}.
\end{equation}

\medskip

\noindent \textbf{Type 3}

\smallskip

\noindent Let us finally examine the case where $\mathcal{N}$ is of type 3 then $N_{(x,b,r)}\in\{0,1\}$
for all $x,b\in\FF_2$ and $r\in[R]$, and 
\begin{equation}
N_{(y,c,s)}=N_{(t,d,u)}=1
\end{equation}
for some $(y,c,s)\neq(t,d,u)$ with either $u=s$ or $\{u,s\}\in E(G^{\text{occ}})$ (using property (b) and \fct{block_property}). We show there are no eigenvectors in the nullspace of \eq{restriction to script R} within a block of this type and we lower bound the smallest eigenvalue within the block. We establish the same bound \eq{boundfortype2} as for blocks of Type 2.

The proof is very similar to that given above for blocks of Type 2. In fact, the first part of proof is identical, from equation \eq{min_over_blockFbl} up to and including equation \eq{restrict_attention_mathcalN}. That is to say, as in the previous case we have
\begin{equation}
\langle\kappa|\sum_{(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}}\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}|\kappa\rangle=\langle\kappa|\sum_{(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})}\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}|\kappa\rangle\quad\text{for all }|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N}).\label{eq:restrict_attention_mathcalN-1}
\end{equation}
In this case, since $N_{(y,c,s)}=N_{(t,d,u)}=1$, in each term $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}$ with $(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})$, the operator 
\begin{equation}
|\phi_{y,c}^{s}\rangle\langle\phi_{y,c}^{s}|\otimes|\phi_{t,d}^{u}\rangle\langle\phi_{t,d}^{u}|
\end{equation}
appears between two of the $N$ registers (tensored with rank 1 projectors on the other $N-2$ registers). Using equation \eq{phi_z_a_q} we may expand $|\phi_{y,c}^{s}\rangle$ and $|\phi_{t,d}^{u}\rangle$ as superpositions (with amplitudes $\pm\frac{1}{\sqrt{3R+2}}$ if $R$ is odd or $\pm\frac{1}{\sqrt{3R-1}}$ if $R$ is even) of the basis states from $\mathcal{W}_{(y,c,s)}$ and $\mathcal{W}_{(t,d,u)}$ respectively. Since $\mathcal{W}_{(y,c,s)}$ and $\mathcal{W}_{(t,d,u)}$ overlap on some diagram element, there exists $l\in L^{\square}$ such that $|\psi_{x_{1},b_{1}}^{l}\rangle\in\mathcal{W}_{(y,c,s)}$ and $|\psi_{x_{2},b_{2}}^{l}\rangle\in\mathcal{W}_{(t,d,u)}$ for some $x_{1},x_{2},b_{1},b_{2}\in\{0,1\}$. Hence
\begin{equation}
|\phi_{y,c}^{s}\rangle|\phi_{t,d}^{u}\rangle=c_{0}\left(\pm|\psi_{x_{1},b_{1}}^{l}\rangle|\psi_{x_{2},b_{2}}^{l}\rangle\right)+\left(1-c_{0}^{2}\right)^{\frac{1}{2}}|\Phi_{y,c,t,d}^{s,u}\rangle
\end{equation}
where $c_{0}$ is either $\frac{1}{3R+2}$ (if $R$ is odd) or $\frac{1}{3R-1}$ (if $R$ is even). Now applying \fct{lin_alg_fact} we get
\begin{equation}
|\phi_{y,c}^{s}\rangle\langle\phi_{y,c}^{s}|\otimes|\phi_{t,d}^{u}\rangle\langle\phi_{t,d}^{u}|=c_{0}^{2}|\psi_{x_{1},b_{1}}^{l}\rangle\langle\psi_{x_{1},b_{1}}^{l}|\otimes|\psi_{x_{2},b_{2}}^{l}\rangle\langle\psi_{x_{2},b_{2}}^{l}|+M_{y,c,t,d}^{s,u}\label{eq:expand_phi_phi_proj-1-1}
\end{equation}
where $\Vert M_{y,c,t,d}^{s,u}\Vert \leq1-\frac{3}{4}\left(\frac{1}{4R}\right)^{4}$. For each $(\vec{z},\vec{a},\vec{q})\in\mathcal{Q}(\mathcal{N})$ we define $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}^{M}$ to be the operator obtained from $\mathcal{P}_{(\vec{z},\vec{a},\vec{q})}$ by replacing
\begin{equation}
|\phi_{y,c}^{s}\rangle\langle\phi_{y,c}^{s}|\otimes|\phi_{t,d}^{u}\rangle\langle\phi_{t,d}^{u}|\mapsto M_{y,c,t,d}^{s,u}
\end{equation}
on two of the registers and we let $\Pi_{\mathcal{N}}^{\triangle}$ be given by \eq{pi_triangle_N}. Then, as in the previous case, $\langle\kappa|\Pi^{\triangle}|\kappa\rangle=\langle\kappa|\Pi_{\mathcal{N}}^{\triangle}|\kappa\rangle$ for all $|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})$ and using the same reasoning as before, we get the bound \eq{bound_on_norm_pi_n_triangle} on $\Vert \Pi_{\mathcal{N}}^{\triangle}\Vert $. Using these two facts we get the same bound on the smallest eigenvalue within a block of type 3 as the bound we obtained for blocks of type 2:
\begin{align}
\min_{|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})}\langle\kappa|\sum_{w=1}^{N}h_{\mathcal{E}^{\triangle}}^{(w)}|\kappa\rangle &>\frac{c_{\triangle}}{R^{2}}\Big(1-\max_{|\kappa\rangle\in\mathcal{I}_{\diamondsuit}(\mathcal{N})}\langle\kappa|\Pi^{\triangle}|\kappa\rangle\Big) \geq \frac{12c_{\triangle}}{(4R)^6}.\qedhere
\end{align}
\end{proof}

%=============================================================================
\subsection{The gate graph $G^{\square}$ }

With all of the intermediate graphs characterized, we now consider the gate graph $G^{\square}$ and prove \lem{oc}. We first show that $G^{\square}$ is an $e_{1}$-gate graph. From equations \eq{A_G_squAre}, \eq{h_se_square}, and \eq{A_g_triangle} we have
\begin{equation}
A(G^{\square})=A(G^{\triangle})+h_{\mathcal{E}^{0}}+h_{\mathcal{S}^{0}}.\label{eq:A_g_square_triangle}
\end{equation}
\lem{A(G_triangle)} characterizes the $e_{1}$-energy ground space of $G^{\triangle}$ and gives an orthonormal basis $\{|\phi_{z,a}^{q}\rangle\colon z,a\in\{0,1\},\, q\in[R]\}$ for it. To solve for the $e_{1}$-energy ground space of $A(G^{\square})$, we solve for superpositions of the states $\{|\phi_{z,a}^{q}\rangle\}$ in the nullspace of $h_{\mathcal{E}^{0}}+h_{\mathcal{S}^{0}}$.

Recall the definition of the sets $\mathcal{E}^{0}$ and $\mathcal{S}^{0}$, as these are the edges and self-loops that are inherited from the graph $G$. From \sec{g_square_def}, each node $(q,z,t)$ in the gate diagram for $G$ is associated with a node $\new(q,z,t)$ in the gate diagram for $G^{\square}$ as described by \eq{node_mapping_G_G_square}. This mapping is depicted in \fig{replace_gate_diagram} by the black and grey arrows. Applying this mapping to each pair of nodes in the edge set $\mathcal{E}^{G}$ and each node in the self-loop set $\mathcal{S}^{G}$ of the gate diagram for $G$, we get the sets $\mathcal{E}^{0}$ and $\mathcal{S}^{0}$. Hence, using equations \eq{h_loops} and \eq{h_edges},
\begin{align}
h_{\mathcal{S}^0} &=\sum_{(q,z,t)\in \mathcal{S}^G} |{\new(q,z,t)}\rangle\langle{\new(q,z,t)}|\otimes \II \label{eq:hS0}\\
h_{\mathcal{E}^0} &=\sum_{\{(q,z,t),(q^\prime,z^\prime,t^\prime)\}\in \mathcal{E}^G} \left(|{\new(q,z,t)}\rangle+|{\new(q^\prime,z^\prime,t^\prime)}\rangle\right)\left(\langle{\new(q,z,t)}|+\langle{\new(q^\prime,z^\prime,t^\prime)}|\right)\otimes \II.\label{eq:hE0}
\end{align}

Using equation \eq{phi_z_a_q}, we see that for all nodes $(q,z,t)$ in the gate diagram for $G$ and for all $j\in[8]$, $x,b,d\in\FF_2$, and $r\in[R]$,
\begin{align}
  \langle{\new(q,z,t),j,d}|\phi^r_{x,b}\rangle & =\sqrt{c_0}
    \begin{cases}
      \langle q_{\mathrm{in}},z,t,j,d|\psi^{r_{\mathrm{in}}}_{x,b}\rangle & \text{ if $(q,z,t)$ is an input node}\\
      \langle q_{\mathrm{out}},z,t,j,d|\psi^{r_{\mathrm{out}}}_{x,b}\rangle & \text{ if $(q,z,t)$ is an output node}
    \end{cases}\nonumber \\
  &=\sqrt{c_0}\delta_{r,q} \langle z,t,j,d|\psi_{x,b}\rangle
  \label{eq:mat_el_newnodes}
\end{align}
where $c_0$ is $\frac{1}{3R+2}$ if $R$ is odd or $\frac{1}{3R-1}$ if $R$ is even, and where $|\psi_{x,b}\rangle$ is defined by equations \eq{psi0m} and \eq{psi1m}. The matrix element on the left-hand side of this equation is evaluated in the Hilbert space $\mathcal{Z}_1 (G^\square)$ where each basis vector corresponds to a vertex of the graph $G^\square$; these vertices are labeled $(l,z,t,j,d)$ with $l\in L^\square$, $z,d\in \FF_2$, $t\in[2k]$, and $j\in[8]$. However, from \eq{mat_el_newnodes} we see that
\begin{equation}
  \underbrace{\langle \new(q,z,t),j,d|\phi^r_{x,b}\rangle}_{\text{in } \mathcal{Z}_1 (G^\square)}=\sqrt{c_0}\underbrace{\langle q,z,t,j,d|\psi^r_{x,b}\rangle}_{\text{in } \mathcal{Z}_1 (G)} \label{eq:twoHspaces}
\end{equation}
where the right-hand side is evaluated in the Hilbert space $\mathcal{Z}_1 (G)$.

Putting together equations \eq{hS0}, \eq{hE0}, and \eq{twoHspaces} gives
\begin{equation}
  \langle\phi_{z,a}^{q}|h_{\mathcal{E}^{0}}+h_{\mathcal{S}^{0}}|\phi_{x,b}^{r}\rangle=\langle\psi_{z,a}^{q}|h_{\mathcal{E}^{G}}+h_{\mathcal{S}^{G}}|\psi_{x,b}^{r}\rangle\cdot
  \begin{cases}
    \frac{1}{3R+2} & R\text{ odd}\\
    \frac{1}{3R-1} & R\text{ even}
  \end{cases}
  \label{eq:h_eG_hsG}
\end{equation}
for all $z,a,x,b\in\FF_2$ and $q,r\in[R]$. On the left-hand side of this equation, the Hilbert space is $\mathcal{Z}_{1}(G^{\square})$; on the right-hand side it is $\mathcal{Z}_{1}(G)$.

We use equation \eq{h_eG_hsG} to relate the $e_1$-energy ground states of $A(G)$ to those of $A(G^\square)$. Since $G$ is an $e_{1}$-gate graph, there is a state 
\begin{equation}
  |\Gamma\rangle=\sum_{z,a,q}\alpha_{z,a,q}|\psi_{z,a}^{q}\rangle\in\mathcal{Z}_{1}(G)
\end{equation}
that satisfies $A(G)|\Gamma\rangle=e_1|\Gamma\rangle$ and hence $h_{\mathcal{E}^{G}}|\Gamma\rangle=h_{\mathcal{S}^{G}}|\Gamma\rangle=0$. Letting
\begin{equation}
  |\Gamma^{\prime}\rangle=\sum_{z,a,q}\alpha_{z,a,q}|\phi_{z,a}^{q}\rangle\in\mathcal{Z}_{1}(G^{\square})
\end{equation}
and using equation \eq{h_eG_hsG}, we see that $\langle\Gamma^{\prime}|h_{\mathcal{E}^{0}}+h_{\mathcal{S}^{0}}|\Gamma^{\prime}\rangle=0$ and therefore $\langle\Gamma^{\prime}|A(G^{\square})|\Gamma^{\prime}\rangle=e_{1}$. Hence $G^{\square}$ is an $e_{1}$-gate graph. Moreover, the linear mapping from $\mathcal{Z}_{1}(G)$ to $\mathcal{Z}_{1}(G^\square)$ defined by
\begin{equation}
  |\psi_{z,a}^{q}\rangle \mapsto |\phi_{z,a}^{q}\rangle\label{eq:map_1particle}
\end{equation}
maps each $e_{1}$-energy eigenstate of $A(G)$ to an $e_{1}$-energy eigenstate of $A(G^{\square})$.

Now consider the $N$-particle Hamiltonian $H(G^{\square},N)$. Using equation \eq{A_g_square_triangle} and the fact that both $A(G^{\square})$ and $A(G^{\triangle})$ have smallest eigenvalue $e_{1}$, we have
\begin{equation}
  H(G^{\square},N)=H(G^{\triangle},N)+\sum_{w=1}^{N}\left(h_{\mathcal{E}^{0}}+h_{\mathcal{S}^{0}}\right)^{(w)}\bigg|_{\mathcal{Z}_{N}(G^{\square})} + C',
\end{equation}
where $C$ corresponds to the added interactions resulting from the additional edges. IRecall from \lem{A(G_triangle)} that the nullspace of the first term is $\mathcal{I}_{\triangle}$. The $N$-fold tensor product of the mapping \eq{map_1particle} acts on basis vectors of $\mathcal{I}(G,G^{\text{occ}},N)$ as 
\begin{equation}
  \Sym(|\psi_{z_{1},a_{1}}^{q_{1}}\rangle|\psi_{z_{2},a_{2}}^{q_{2}}\rangle\ldots|\psi_{z_{N},a_{N}}^{q_{N}}\rangle)
    \mapsto
  \Sym(|\phi_{z_{1},a_{1}}^{q_{1}}\rangle|\phi_{z_{2},a_{2}}^{q_{2}}\rangle\ldots|\phi_{z_{N},a_{N}}^{q_{N}}\rangle),
  \label{eq:N_particle_mapping}
\end{equation}
where $z_{i},a_{i}\in\FF_2,\; q_{i}\neq q_{j},\;\text{and }\{q_{i},q_{j}\}\notin E(G^{\text{occ}})$.
Clearly this defines an invertible linear map between the two spaces
$\mathcal{I}(G,G^{\text{occ}},N)$ and $\mathcal{I}_{\triangle}$. Let $|\Theta\rangle\in\mathcal{I}(G,G^{\text{occ}},N)$
and write $|\Theta^{\prime}\rangle\in\mathcal{I}_{\triangle}$ for its image under the map \eq{N_particle_mapping}. Then 
\begin{align}
  \langle\Theta^{\prime}|H(G^{\square},N)-C'|\Theta^{\prime}\rangle&=\langle\Theta^{\prime}|\sum_{w=1}^{N}\left(h_{\mathcal{E}^{0}}+h_{\mathcal{S}^{0}}\right)^{(w)}|\Theta^{\prime}\rangle\\
  &=\langle\Theta|\sum_{w=1}^{N}\left(h_{\mathcal{E}^{G}}+h_{\mathcal{S}^{G}}\right)^{(w)}|\Theta\rangle\cdot
  \begin{cases}
    \frac{1}{3R+2} & R\text{ odd}\\
    \frac{1}{3R-1} & R\text{ even}
  \end{cases}
\label{eq:Theta_Theta_prime_eqn}
\end{align}
where in the first equality we used the fact that $|\Theta^\prime\rangle$ is in the nullspace $\mathcal{I}_{\triangle}$ of $H(G^\triangle,N)$ and in the second equality we used equation \eq{h_eG_hsG} and the fact that $\langle\phi_{z,a}^{q}|\phi_{x,b}^{r}\rangle=\langle\psi_{z,a}^{q}|\psi_{x,b}^{r}\rangle$. 

Understanding how $C'$ relates to the added interactions in the original gate-graph $G$ is slightly more tricksome, as an arbitrary state we might have $N$-particle interactions which under our transformation would require a factor of $(3R)^{-N}$ to the energy.  However, the fact that each state in $\mathcal{I}_{\triangle}$ and each state in $\mathcal{I}(G,G^{\text{occ}},N)$ satisfy the occupancy constraints implies that at most a single particle ever occupies a single vertex (and thus $C'=0$ if $\dmax = 0$).  Using this, we have that when restricted to those states in $\mathcal{I}_{\triangle}$, $C'$ only affects two-particles at a time and the requisite change to the energy penalty will only be $(3R)^{-2}$.

\todo{probably I should make this more coherent}
As such, let $\mathcal{V}^{\square} \subset V(G^\square)\times V(G^\square)$ consist of those pairs of vertices that could be affected by the new interactions caused by the added edges.  Since each node of every diagram element is separated by a distance at least $\dmax$, we have that each pair of vertices must come from diagram elements labeled $q_{\text{in}}$ or $q_{\text{out}}$.  Further, if we let $\mathcal{V}\subset V(G)\times V(G)$ be the similar set of vertices that can have interactions caused by the added edges in $G$, we have that $\mathcal{V}^{\square}$ is in one-to-one correspondence to those of $\mathcal{V}$, since we have added the same number of edges.  In particular, we have that the vertices on 
\todo{actually figure out this mapping}

With this in mind, along with the fact that we have at most a single particle located on each vertex and the relation between $\ket{\phi_{z,a}^q}$ and $\ket{\psi_{z,a}^q}$, we have that 
\begin{align}
  \bra{\Theta'} C' \ket{\Theta'} &= \sum_{(u',v')\in \mathcal{V}^\square} \sum_{w_1\neq w_2\in [N]} \bra{\Theta'} \big(\ketbra{u'}{u'}^{(w_1)} \otimes \ketbra{v'}{v'}^{(w_2)}\big) \ket{\Theta'}\\
   &= \sum_{(u,v)\in \mathcal{V}} \sum_{w_1\neq w_2\in [N]} \bra{\Theta}\big(\ketbra{u}{u}^{(w_1)} \otimes \ketbra{v}{v}^{(w_2)}\big) \ket{\Theta}
     \begin{cases}
       \frac{1}{(3R+2)^2} & R\text{ odd}\\
       \frac{1}{(3R-1)^2} & R\text{ even}
    \end{cases}\\
  &= \bra{\Theta} C \ket{\Theta} \begin{cases}
       \frac{1}{(3R+2)^2} & R\text{ odd}\\
       \frac{1}{(3R-1)^2} & R\text{ even}
    \end{cases}
    \label{eq:C' relation}
\end{align}

We now complete the proof of \lem{oc} using equation \eq{Theta_Theta_prime_eqn} and \eq{C' relation}.

%-----------------------------------------------------------------------------
\subsubsection*{Case 1: $\lambda_{N}(G,G^{\text{occ}})\leq a$}

In this case there exists a state $|\Theta\rangle\in\mathcal{I}(G,G^{\text{occ}},N)$ satisfying 
\begin{equation}
\langle\Theta|\sum_{w=1}^{N}\left(h_{\mathcal{E}^{G}}+h_{\mathcal{S}^{G}}\right)^{(w)} + C|\Theta\rangle = a_{\text{adj}} + a_\text{int}\leq a,
\end{equation}

From equation \eq{Theta_Theta_prime_eqn} we see that the state $|\Theta^{\prime}\rangle\in\mathcal{I}_{\triangle}$ satisfies $\langle\Theta^{\prime}||\Theta^{\prime}\rangle\leq\frac{a_{\text{adj}}}{3R-1}$, and from $\eq{C' relation}$ that it also satisfies $\bra{\Theta'} C' \ket{\Theta}' \leq \frac{a_{\text{int}}}{(3R-1)^2}$.

Putting this together, (along with the fact that $\ket{\Theta'}\in \mathcal{I}_{\triangle}$ and thus is in the nullspace of $H(G^{\triangle},N)$),
\begin{equation}
  \bra{\Theta'}H(G^{\square},N) \ket{\Theta'} \leq \frac{a_{\text{adj}}}{3R-1} + \frac{a_{\text{int}}}{(3R-1)^2} < \frac{a_{\text{adj}}}{R} + \frac{a_{\text{int}}}{R} = \frac{a}{R}.
\end{equation}

%-----------------------------------------------------------------------------
\subsubsection*{Case 2: $\lambda_{N}(G,G^{\text{occ}})\geq b$}

In this case 
\begin{align}
\lambda_{N}(G,G^{\text{occ}})&=\min_{|\Theta\rangle\in\mathcal{I}(G,G^{\text{occ}},N)}\langle\Theta|H(G,G^{\text{occ}},N)|\Theta\rangle\\
   & = \min_{|\Theta\rangle\in\mathcal{I}(G,G^{\text{occ}},N)}\langle\Theta|\sum_{w=1}^{N}\left(h_{\mathcal{E}^{G}}+h_{\mathcal{S}^{G}}\right)^{(w)}|\Theta\rangle + \bra{\Theta} C \ket{\Theta}\\
   &= b_{\text{adj}} + b_{\text{int}} \geq  b.
\end{align}
 Now applying equation \eq{Theta_Theta_prime_eqn} and \eq{C' relation} gives
\begin{align}
  \min_{|\Theta^{\prime}\rangle\in\mathcal{I}_{\triangle}}\langle\Theta^{\prime}|H(G^{\square},N)|\Theta^{\prime}\rangle&=\min_{|\Theta^{\prime}\rangle\in\mathcal{I}_{\triangle}}\langle\Theta^{\prime}|\sum_{w=1}^{N}\left(h_{\mathcal{E}^{0}}+h_{\mathcal{S}^{0}}\right)^{(w)}|\Theta^{\prime}\rangle + \bra{\Theta'} C' \ket{\Theta'}\\
  &\geq \frac{b_{\text{adj}}}{3R+2} + \frac{b_{\text{int}}}{(3R+2)^2}\\
  &\geq\frac{1}{(3R+2)^2}b,\label{eq:bound_thetaprime}
\end{align}
This establishes that the nullspace of $H(G^{\square},N)$ is empty, i.e., $\lambda_{N}^{1}(G^{\square})>0$, so $\lambda_{N}^{1}(G^{\square})=\gamma(H(G^{\square},N))$. We lower bound $\lambda_{N}^{1}(G^{\square})$ using the Nullspace Projection Lemma (\lem{npl}) with
\begin{equation}
  H_{A}=H(G^{\triangle},N)\qquad H_{B}=\sum_{w=1}^{N}\left(h_{\mathcal{E}^{0}}+h_{\mathcal{S}^{0}}\right)^{(w)}\bigg|_{\mathcal{Z}_{N}(G^{\square})} + C'
\end{equation}
and where the nullspace of $H_{A}$ is $S=\mathcal{I}_{\triangle}$. We apply \lem{npl} and use the bounds $\gamma(H_{A})>\frac{\gamma_\triangle}{R^{7}}$ (from \lem{The-nullspace-of_H_triangle}), $\gamma(H_{B}|_{S})\geq\frac{b}{(3R+2)^2}$ (from equation \eq{bound_thetaprime}), and 
\begin{equation}
  \left\Vert H_{B}\right\Vert \leq N\left\Vert {h_{\mathcal{E}^{0}}+h_{\mathcal{S}^{0}}}\right\Vert  + \norm{H_{\text{int}}} \leq3N + d_{\mathcal{U}} N^{\nu}
  \leq d_{\mathcal{U}}R^{\nu_\mathcal{U}}
\end{equation}
(using equations \eq{h_E_bound} and \eq{h_S_bound}, the bounds on $H_{\text{int}}$, and the fact that $N\leq R$) to find 
\begin{align}
\lambda_{N}^{1}(G^{\square}) &= \gamma(H(G^{\square},N)) \\
 &\geq \frac{\gamma_{\triangle}b}{(3R+2)^2R^7}\frac{1}{\frac{\gamma_{\triangle}}{R^7}+d_{\mathcal{U}} R^{\nu_{\mathcal{U}}}} \\
 & >\frac{ \gamma_{\square} b}{R^{9+\nu}}
\end{align}
where $\gamma_{\square}$ depends only on the interaction $\mathcal{U}$.

\begin{comment}
(FROM THE OLD PROOF)

\begin{lemma}
Let $h$ be the $\left(n+1\right)\times(n+1)$ matrix defined as 
\begin{equation}
h=\begin{pmatrix}
na^{2} & ab & ac & ac & \ldots & ac\\
ab & b^{2} & 0 & 0 & \ldots & 0\\
ac & 0 & c^{2} & 0 & \ldots & 0\\
ac & 0 & 0 & c^{2} & \ldots & 0\\
\vdots & \vdots & \vdots & \vdots & \ddots & \vdots\\
ac & 0 & 0 & 0 & \ldots & c^{2}
\end{pmatrix}
\end{equation}
with $c>b>a>0$ and basis states labeled $|0\rangle,\ldots,|n\rangle$ from left to right and top to bottom. Then $h\geq0$, the unique eigenvector with eigenvalue zero is
\begin{equation}
|\phi\rangle=\frac{1}{\sqrt{a^{2}+b^{2}+\left(n-1\right)c^{2}}}\left(a|0\rangle-b|1\rangle-c\sum_{j=2}^{n}|j\rangle\right),
\end{equation}
and the smallest nonzero eigenvalue satisfies $\gamma(h)\geq b^{2}-ab$.
\end{lemma}

\begin{proof}
First change basis to 
\begin{equation}
\{|0\rangle,|1\rangle,|\alpha_{0}\rangle,|\alpha_{1}\rangle,\ldots,|\alpha_{n-2}\rangle\}
\end{equation}
where $|\alpha_{k}\rangle=\left(\sqrt{n-1}\right)^{-1}\sum_{j=2}^{n}e^{\frac{2\pi ijk}{n-1}}|j\rangle$.
In this basis $h$ is given by
\begin{equation}
\begin{pmatrix}
na^{2} & ab & ac\sqrt{n-1} & 0 & \ldots & 0\\
ab & b^{2} & 0 & 0 & \ldots & 0\\
ac\sqrt{n-1} & 0 & c^{2} & 0 & \ldots & 0\\
0 & 0 & 0 & c^{2} & \ldots & 0\\
\vdots & \vdots & \vdots & \vdots & \ddots & \vdots\\
0 & 0 & 0 & 0 & \ldots & c^{2}
\end{pmatrix}
\end{equation}
 and its eigenvalues are $c^{2}$ (with multiplicity $n-1$) along
with the eigenvalues of the top left $3\times3$ submatrix, which
are 
\begin{equation}
\left\{ 0,\frac{1}{2}\left(b^{2}+c^{2}+a^{2}n\pm\sqrt{\left(c^{2}-b^{2}+a^{2}n\right)^{2}+4a^{2}b^{2}-4a^{2}c^{2}}\right)\right\} .
\end{equation}
 One can easily confirm that the zero eigenvector is $|\phi\rangle$
as given in the statement of the Lemma. Using the inequality $\sqrt{\left(c^{2}-b^{2}+a^{2}n\right)^{2}+4a^{2}b^{2}-4a^{2}c^{2}}\leq\left(c^{2}-b^{2}+a^{2}n\right)+2ab$
gives 
\begin{equation}
\frac{1}{2}\left(b^{2}+c^{2}+a^{2}n-\sqrt{\left(c^{2}-b^{2}+a^{2}n\right)^{2}+4a^{2}b^{2}-4a^{2}c^{2}}\right)\geq\frac{1}{2}\left(2b^{2}-2ab\right)=b^{2}-ab.
\end{equation}
From this (and the fact that $c^{2}\geq b^{2}-ab\geq0$) we see that $h\geq0$ and we get the bound $\gamma(h)\geq b^{2}-ab$, which completes the proof.
\end{proof}
\end{comment}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Constructing the graph for \QMA-completeness}\label{sec:graph_construction}

With the graphs defined in \sec{graph_primitives} and the ability to ensure that certain states are excluded from the ground space via the occupancy constraints lemma \sec{occupancy_constraints}, we will now be able to construct the graph that will be used in our \QMA-completeness proof.   In particular, we will show how to transform a given circuit into a graph, such that the $n$-particle ground-energy will correspond to whether the circuit has an accepting state when certain states are excluded from the ground space.  

The main idea will be to use the graph primitives of \sec{graph_primitives} to construct a gate graph replacing circuits of a particular form.  We will use a single particle for each qubit, and use the location of a single qubit to encode the current ``time'' of the occupation.  Using our two-particle graph gadgets, we can then ensure that the particles move together through the entire computation (assuming that they start in the correct possitions).  

\subsection{Verification circuits}

\todo{Show that the circuit can be written in the requisite form.}

\subsection{Gate graph for a given circuit}
For any $n$-qubit, $M$-gate verification circuit $\mathcal{C}_{X}$ of the form described above, we associate a gate graph $G_X$. The gate diagram for $G_X$ is built using the gadgets described in \sec{Gadgets}; specifically, we use $M$ two-qubit gadgets and $2(n-1)$ boundary gadgets. Since each two-qubit gadget and each boundary gadget contains $32$ diagram elements, the total number of diagram elements in $G_X$ is $R=32(M+2n-2)$.

We now present the construction of the gate diagram for $G_X$.  We also describe some gate graphs obtained as intermediate steps that are used in our analysis in \sec{Proof-of-Theorem}. The reader may find this description easier to follow by looking ahead to \fig{step-by-step}, which illustrates this construction for a specific $3$-qubit circuit.

\begin{enumerate}
  \item \textbf{Draw a grid} with columns labeled $j=0,1,\ldots,M+1$ and rows labeled $i=1,\ldots,n$ (this grid is only used to help describe the diagram).
  \item \textbf{Place gadgets in the grid to mimic the quantum circuit.}
For each $j=1,\ldots,M$, place a gadget for the two-qubit gate $U_j$ between rows $1$ and $s(j)$ in the $j$th column. Place boundary gadgets in rows $i=2,\ldots,n$ of column $0$ and in the same rows of column $M+1$. Write $G_{1}$ for the gate graph associated with the resulting diagram.
  \item \textbf{Connect the nodes within each row.}
First add edges connecting the nodes in rows $i=2,\ldots,n$; call the resulting gate graph $G_{2}$. Then add edges connecting the nodes in row $1$; call the resulting gate graph $G_{3}$.
  \item \textbf{Add self-loops to the boundary gadgets.}
In this step we add self-loops to enforce initialization of ancillas (at the beginning) and the proper output of the circuit (at the end). For each row $k=n_{\text{in}}+1,\ldots,n$, add a self-loop to node $\delta$ (as shown in  \fig{GVbdy}) of the corresponding boundary gadget in column $r=0$, giving the gate diagram for $G_{4}$. Finally, add a self-loop to node $\alpha$ of the boundary gadget (as in \fig{GVbdy}) in row %$k=$
$2$ and column $M+1$, giving the gate diagram for $G_X$.
\end{enumerate}

\fig{step-by-step} illustrates the step-by-step construction of $G_X$ using a simple $3$-qubit circuit with four gates 
\begin{equation}
  \CNOT_{12}\left(\CNOT_{13}HT\otimes\II\right)\CNOT_{21}\CNOT_{13}.
\end{equation}
In this example, two of the qubits are input qubits (so $n_{\text{in}}=2$), while the third qubit is an ancilla 
%that is 
initialized to $|0\rangle$.
% at the start of the computation. 
Following the convention described in \sec{Universality}, we take qubit $2$ to be the output qubit. (In this example the circuit is not meant to compute anything interesting; its only purpose is to illustrate our method of constructing a gate graph).

\begin{figure}
\centering \subfloat[][]{ 
  \tikzsetnextfilename{MP_G1}
  \input{../tikz/MP_G1.tex}
  \label{fig:G1}
} 
% \vspace{0.1cm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % The Example Composition Graph Mark 2 % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subfloat[][]{ 
  \tikzsetnextfilename{MP_G2}
  \input{../tikz/MP_G2.tex}
  \label{fig:G2}
}

% \vspace{0.1cm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% % The Example Composition Graph Mark 3 
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subfloat[][]{
  \tikzsetnextfilename{MP_G3}
  \input{../tikz/MP_G3.tex}
  \label{fig:G3}
} 
% \vspace{0.1cm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
% % The Example Composition Graph Mark 4 % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subfloat[][]{
  \tikzsetnextfilename{MP_G4}
  \input{../tikz/MP_G4.tex}
  \label{fig:GX}
}

\caption{Step-by-step construction of the gate diagram for $G_X$ for the three-qubit example circuit described in the text. 
\subfig{G1} The gate diagram for $G_{1}$.
\subfig{G2} Add edges in all rows except the first to obtain the gate diagram for $G_{2}$.
\subfig{G3} Add edges in the first row to obtain the gate diagram for $G_{3}$.
\subfig{GX} Add self-loops to the boundary gadgets to obtain the gate diagram for $G_X$ (the diagram for $G_{4}$ in this case differs from \subfig{GX} by removing the self-loop in column $5$; this diagram is not shown).
\label{fig:step-by-step}
}
\end{figure}

We made some choices in designing this circuit-to-gate graph mapping that may seem arbitrary (e.g., we chose to place boundary gadgets in each row except the first). We have tried to achieve a balance between simplicity of description and ease of analysis, but we expect that other choices could be made to work.

%-----------------------------------------------------------------------------
\subsubsection{Notation for $G_X$}

We now introduce some notation that allows us to easily refer to a subset $\mathcal{L}$ of the diagram elements in the gate diagram for $G_X$.

Recall from \sec{Gadgets} that each two-qubit gate gadget and each boundary gadget is composed of $64$ diagram elements. This can be seen by looking at \fig{GVucnot} and noting (from \fig{W_gadget}) that each move-together gadget comprises 14 diagram elements.

For each of the two-qubit gate gadgets in the gate diagram for $G_X$, we focus our attention on the four diagram elements labeled $1$--$4$ in \fig{GVucnot}. In total there are $4M$ such diagram elements in the gate diagram for $G_X$: in each column $j\in\{1,\ldots,M\}$ there are two in row $1$ and two in row $s(j)$. When $U_j\in\{\CNOT_{1s(j)},\CNOT_{1s(j)}\left(H\otimes\II\right),\CNOT_{1s(j)}\left(HT\otimes\II\right)\}$ the diagram elements labeled $1,2$ are in row $1$ and those labeled $3,4$ are in row $s(j)$; when $U_j=\CNOT_{s(j) 1}$ those labeled $1,2$ are in row $s(j)$ and those labeled $3,4$ are in row $1$. We denote these diagram elements by triples $(i,j,d)$. Here $i$ and $j$ indicate (respectively) the row and column of the grid in which the diagram element is found, and $d$ indicates whether it is the leftmost ($d=0$) or rightmost ($d=1$) diagram element in this row and column. We define 
\begin{equation}
\mathcal{L}_{\mathrm{gates}}=\left\{ \left(i,j,d\right)\colon i\in\{1,s(j)\},\; j\in[M],\; d\in\{0,1\}\right\} \label{eq:L_gates}
\end{equation}
to be the set of all such diagram elements.

For example, in \fig{step-by-step} the first gate is 
\begin{equation}
  U_1=\CNOT_{13},
\end{equation}
so the gadget from \fig{GVucnot} (with $\tilde U=1$) appears between rows $1$ and $3$ in the first column. The diagram elements labeled $1,2,3,4$ from \fig{GVucnot} are denoted by $(1,1,0), (1,1,1), (3,1,0), (3,1,1)$, respectively. The second gate in \fig{step-by-step} is $U_2=\CNOT_{21}$, so the gadget from \fig{GVcnot} (with $\tilde U=1$) appears between rows $2$ and $1$; in this case the diagram elements labeled $1,2,3,4$ in \fig{GVucnot} are denoted by $(2,2,0),(2,2,1),(1,2,0),(1,2,1)$, respectively.

We also define notation for the boundary gadgets in $G_X$. For each boundary gadget. we focus on a single diagram element, labeled $4$ in \fig{GVbdy}. For the left hand-side and right-hand side boundary gadgets, respectively, we denote these diagram elements as
\begin{align}
 & \mathcal{L}_{\text{in}}=\left\{ (i,0,1)\colon i\in\{2,\ldots,n\}\right\} \label{eq:L_in}\\
 & \mathcal{L}_{\text{out}}=\left\{ (i,M+1,0)\colon i\in\{2,\ldots,n\}\right\} .\label{eq:L_out}
\end{align}
 
\begin{definition}
\label{defn:scriptL}Let $\mathcal{L}$ be the set of diagram
elements
\begin{equation}
\mathcal{L}=\mathcal{L}_{\text{in}}\cup\mathcal{L}_{\mathrm{gates}}\cup\mathcal{L}_{\text{out}}
\end{equation}
where $\mathcal{L}_{\text{in}}$, $\mathcal{L}_{\mathrm{gates}}$, and $\mathcal{L}_{\text{out}}$ are given by equations \eq{L_in}, \eq{L_gates}, and \eq{L_out}, respectively.
\end{definition}

Finally, it is convenient to define a function $F$ that describes horizontal movement within the rows of the gate diagram for $G_X$. The function $F$ takes as input a two-qubit gate $j\in[M]$, a qubit $i\in\{2,\ldots,n\}$, and a single bit and outputs a diagram element from the set $\mathcal{L}$. If the bit is $0$ then $F$ outputs the diagram element in row $i$ that appears in a column $0\leq k<j$ with $k$ maximal (i.e., the closest diagram element in row $i$ to the left of column $j$):
\begin{equation}
F(i,j,0)=\begin{cases}
(i,k,1) & \text{ where }1\leq k<j\text{ is the largest }k\text{ such that }s(k)=i\text{, if it exists}\\
(i,0,1) & \text{ otherwise.}
\end{cases}\label{eq:F_bit0}
\end{equation}
On the other hand, if the bit is $1$, then $F$ outputs the diagram element in row $i$ that appears in a column $j<k\leq M+1$ with $k$ minimal (i.e., the closest diagram element in row $i$ to the right of column $j$). 
\begin{equation}
F(i,j,1)=\begin{cases}
(i,k,0) & \text{ where }j<k\leq M\text{ is the smallest }k\text{ such that }s(k)=j\text{, if it exists}\\
(i,M+1,0) & \text{ otherwise}.
\end{cases}\label{eq:F_bit1}
\end{equation}

\subsubsection{Occupancy constraints graph}

In this Section we define an occupancy constraints graph $G_Xoc$. Along with $G_X$ and the number of particles $n$, this determines a subspace $\mathcal{I}(G_X,G_Xoc,n)\subset\mathcal{Z}_{n}(G_X)$ through equation \eq{occup_space_defn}. We will see in \sec{Proof-of-Theorem} how low-energy states of the Bose-Hubbard model that live entirely within this subspace encode computations corresponding to the quantum circuit $\mathcal{C}_{X}$. This fact is used in the proof of \thm{main_thm_with_occ_constraints}, which shows that the smallest eigenvalue $\lambda_{n}^{1}(G_X,G_Xoc)$ of
\begin{equation}
H(G_X,G_Xoc,n)=H(G_X,n)\big|_{\mathcal{I}(G_X,G_Xoc,n)}
\end{equation}
is related to the maximum acceptance probability of the circuit.

We encode quantum data in the locations of $n$ particles in the graph $G_X$ as follows. Each particle encodes one qubit and is located in one row of the graph $G_X$. Since all two-qubit gates in $\mathcal{C}_{X}$ involve the first qubit, the location of the particle in the first row determines how far along the computation has proceeded. We design the occupancy constraints graph to ensure that low-energy states of $H(G_X,G_Xoc,n)$ have exactly one particle in each row (since there are $n$ particles and $n$ rows), and so that the particles in rows $2,\ldots,n$ are not too far behind or ahead of the particle in the first row. To avoid confusion, we emphasize that not \emph{all} states in the subspace $\mathcal{I}(G_X,G_Xoc,n)$ have the desired properties---for example, there are states in this subspace with more than one particle in a given row. We see in the next Section that states with low energy for $H(G_X,n)$ that also satisfy the occupancy constraints (i.e., low-energy states of $H(G_X,G_Xoc,n)$) have the desired properties.

We now define $G_Xoc$, which is a simple graph with a vertex for each diagram element in $G_X$. Each edge in $G_Xoc$ places a constraint on the locations of particles in $G_X$. The graph $G_Xoc$ only has edges between diagram elements in the set $\mathcal{L}$ from \defn{scriptL}; we define the edge set $E(G_Xoc)$ by specifying pairs of diagram elements $L_{1},L_{2}\in\mathcal{L}$. We also indicate (in bold) the reason for choosing the constraints, which will become clearer in \sec{Proof-of-Theorem}.
\begin{enumerate}
\item \textbf{No two particles in the same row.} For each $i\in[n]$ we add constraints between diagram elements $(i,j,c)\in\mathcal{L}$ and $(i,k,d)\in\mathcal{L}$ in row $i$ but in different columns, i.e.,
\begin{equation}
\{\left(i,j,c\right),\left(i,k,d\right)\}\in E(G_Xoc)\text{ whenever }j\neq k.\label{eq:occ_constraints_type1}
\end{equation}
\item \textbf{Synchronization with the particle in the first row.} For each $j\in[M]$ we add constraints between row $1$ and row $s(j)$:
\begin{equation}
\{(1,j,c),(s(j),k,d)\}\in E(G_Xoc)\text{ whenever }k\neq j\text{ and }(s(j),k,d)\neq F(s(j),j,c).
\end{equation}
For each $j\in[M]$ we also add constraints between row $1$ and rows $i\in[n]\setminus\{1,s(j)\}$:
\begin{equation}
\{(1,j,c),(i,k,d)\}\in E(G_Xoc)\text{ whenever }(i,k,d)\notin\{F(i,j,0),F(i,j,1)\}.
\end{equation}
\end{enumerate}





%=============================================================================
%  Proof
%=============================================================================

\section{Proof of QMA-hardness for MPQW ground energy}

\thm{main_thm_with_occ_constraints} bounds the smallest eigenvalue $\lambda_n^{1}(G_X,G_Xoc)$ of $H(G_X,G_Xoc,n)$. To prove the Theorem, we investigate a sequence of Hamiltonians starting with $H(G_{1},n)$ and $H(G_{1},G_Xoc,n)$ and then work our way up to the Hamiltonian $H(G_X,G_Xoc,n)$ by adding positive semidefinite terms.

For each Hamiltonian we consider, we solve for the nullspace and the smallest nonzero eigenvalue. To go from one Hamiltonian to the next, we use the following ``Nullspace Projection Lemma,'' which was used (implicitly) in reference \cite{MLM99}. The Lemma bounds the smallest nonzero eigenvalue $\gamma(H_A+H_B)$ of a sum of positive semidefinite Hamiltonians $H_A$ and $H_B$ using knowledge of the smallest nonzero eigenvalue $\gamma(H_A)$ of $H_A$ and the smallest nonzero eigenvalue $\gamma(H_B|_S)$ of the restriction of $H_B$ to the nullspace $S$ of $H_A$.

We prove the Lemma in \sec{Proof-of-Lemma_MLM}. When we apply this Lemma, we are usually interested in an asymptotic limit where $c,d\ll\left\Vert H_{B}\right\Vert $ and the right-hand side of \eq{lemma_lower_bnd} is $\Omega(\frac{cd}{\Vert H_{B}\Vert })$.

Our proof strategy, using repeated applications of the Nullspace Projection Lemma, is analogous to that of reference \cite{KKR04}, where the so-called Projection Lemma was used similarly. Our technique has the advantage of not requiring the terms we add to our Hamiltonian to have ``unphysical'' problem-size dependent coefficients (it also has this advantage over the method of perturbative gadgets \cite{KKR04,JF08}). This allows us to prove results about the ``physically realistic'' Bose-Hubbard Hamiltonian. A similar technique based on Kitaev's Geometric Lemma was used recently in reference \cite{GN13} (however, that method is slightly more computation intensive, requiring a lower bound on $\gamma(H_{B})$ as well as bounds on $\gamma(H_{A})$ and $\gamma(H_{B}|_{S})$).


\subsection{Single-particle ground-states}

We begin by discussing the graphs
\begin{equation}
G_{1},G_{2},G_{3},G_{4},G_X
\end{equation}
(as defined in \sec{From-circuits-to}; see \fig{step-by-step}) in more detail and deriving some properties of their adjacency matrices.

The graph $G_{1}$ has a component for each of the two-qubit gates $j \in [M]$, for each of the boundary gadgets $i=2,\ldots,n$ in column $0$, and for each of the boundary gadgets $i=2,\ldots,n$ in column $M+1$. In other words 
\begin{equation}
G_{1}=\underbrace{\left(\bigcup_{i=2}^{n}G_{\text{bnd}}\right)}_{\text{left boundary}}\cup\underbrace{\left(\bigcup_{j=1}^{M}G_{U_j}\right)}_{\text{two-qubit gates}}\cup\underbrace{\left(\bigcup_{i=2}^{n}G_{\text{bnd}}\right)}_{\text{right boundary}}.\label{eq:G_alpha}
\end{equation}
We use our knowledge of the adjacency matrices of the components $G_\text{bnd}$ and $G_{U_j}$ to understand the ground space of $A(G_1)$.  Recall (from \sec{Gadgets}) that the smallest eigenvalue of $A(G_{U_j})$ is 
\begin{equation}
e_{1}=-1-3\sqrt{2}
\end{equation}
(with degeneracy $16)$ which is also the smallest eigenvalue of $A(G_{\text{bnd}})$ (with degeneracy $4$). For each diagram element $L\in\mathcal{L}$ and pair of bits $z,a\in\{0,1\}$ there is an eigenstate $|\rho_{z,a}^{L}\rangle$ of $A(G_{1})$ with this minimal eigenvalue $e_{1}$. In total we get sixteen eigenstates
\begin{equation}
|\rho_{z,a}^{(1,j,0)}\rangle,|\rho_{z,a}^{(1,j,1)}\rangle,|\rho_{z,a}^{(s(j),j,0)}\rangle,|\rho_{z,a}^{(s(j),j,1)}\rangle,\quad z,a\in\{0,1\}
\end{equation}
for each two-qubit gate $j\in[M]$, four eigenstates 
\begin{equation}
|\rho_{z,a}^{(i,0,1)}\rangle,\quad z,a\in\{0,1\}
\end{equation}
for each boundary gadget $i\in\{2,\ldots,n\}$ in column $0$, and four eigenstates 
\begin{equation}
|\rho_{z,a}^{(i,M+1,0)}\rangle,\quad z,a\in\{0,1\}
\end{equation}
for each boundary gadget $i\in\{2,\ldots,n\}$ in column $M+1$. The set 
\begin{equation}
\left\{ |\rho_{z,a}^{L}\rangle\colon z,a\in\{0,1\},\; L\in\mathcal{L}\right\} 
\end{equation}
is an orthonormal basis for the ground space of $A(G_{1})$. 

We write the adjacency matrices of $G_{2}$, $G_{3}$, $G_{4}$, and $G_X$ as 
\begin{align}
  A(G_{2}) &= A(G_{1})+h_{1} & 
  A(G_{4}) &= A(G_{3})+\sum_{i=n_{\text{in}}+1}^{n}h_{\text{in},i} \\
  A(G_{3}) &= A(G_{2})+h_{2} &
  A(G_X)   &= A(G_{4})+h_{\text{out}}.
\end{align}
From step 3 of the construction of the gate diagram in \sec{The-gate-graph}, we see that $h_{1}$ and $h_{2}$ are both sums of terms of the form 
\begin{equation}
  \left(|q,z,t\rangle+|q^{\prime},z,t^{\prime}\rangle\right)
  \left(\langle q,z,t|+\langle q^{\prime},z,t^{\prime}|\right)\otimes\II_{j},
\end{equation}
where $h_1$ contains a term for each edge in rows $2,\ldots, n$ and $h_2$ contains a term for each of the $2(M-1)$ edges in the first row. The operators
\begin{align}
  h_{\mathrm{in},i} &= |(i,0,1),1,7\rangle\langle(i,0,1),1,7|\otimes\II &
  h_{\text{out}} &= |(2,M+1,0),0,5\rangle\langle(2,M+1,0),0,5|\otimes\II
\label{eq:hin_i}
\end{align}
correspond to the self-loops added in the gate diagram in step 4 of \sec{The-gate-graph}. 

We prove that $G_1$, $G_2$, $G_3$, $G_4$, and $G_X$ are $e_1$-gate graphs.

\begin{lemma}
\label{lem:The-smallest-eigenvalues}The smallest eigenvalues of $G_{1},G_{2},G_{3},G_{4}$
and $G_X$ are 
\begin{equation}
\mu(G_{1})=\mu(G_{2})=\mu(G_{3})=\mu(G_{4})=\mu(G_X)=e_{1}.
\end{equation}
\end{lemma}

\begin{proof}
We showed in the above discussion that $\mu(G_{1})=e_{1}$. The adjacency matrices of $G_{2}$, $G_{3}$, $G_{4}$, and $G_X$ are obtained from that of $G_{1}$ by adding positive semidefinite terms ($h_{1}$, $h_{2}$, $h_{\text{in},i}$, and $h_{\text{out}}$ are all positive semidefinite). It therefore suffices to exhibit an eigenstate $|\varrho\rangle$ of $A(G_{1})$ with
\begin{equation}
  h_{1}|\varrho\rangle
  =h_{2}|\varrho\rangle
  =h_{\text{in},i}|\varrho\rangle
  =h_{\text{out}}|\varrho\rangle
  =0
\end{equation}
(for each $i\in\{n_{\text{in}}+1,\ldots,n\}$). There are many states $|\varrho\rangle$ satisfying these conditions; one example is
\begin{equation}
|\varrho\rangle = |\rho_{0,0}^{(1,1,0)}\rangle
\end{equation}
which is supported on vertices where $h_{1}$, $h_{2}$, $h_{\text{in},i}$, and $h_{\text{out}}$ have no support.
\end{proof}

%-----------------------------------------------------------------------------
\subsubsection{Multi-particle Hamiltonian}
\label{sec:Building-up-the}

We now outline the sequence of Hamiltonians considered in the following Sections and describe the relationships between them. As a first step, in \sec{Configurations-and-the} we exhibit a basis $\mathcal{B}_{n}$ for the nullspace of $H(G_{1},n)$ and we prove that its smallest nonzero eigenvalue is lower bounded by a positive constant. We then discuss the restriction
\begin{equation}
  H(G_{1},G_Xoc,n)
  = H(G_{1},n)\big|_{\mathcal{I}\left(G_{1},G_Xoc,n\right)}
\label{eq:restriction}
\end{equation}
in \sec{Legal-configurations-and}, where we prove that a subset $\mathcal{B}_{\text{legal}}\subset\mathcal{B}_{n}$ is a basis for the nullspace of \eq{restriction}, and that its smallest nonzero eigenvalue is also lower bounded by a positive constant.

For the remainder of the proof we use the Nullspace Projection Lemma (\lem{npl}) four times, using the decompositions 
\begin{align}
H(G_{2},G_Xoc,n) & =H(G_{1},G_Xoc,n)+H_{1}\big|_{\mathcal{I}(G_{2},G_Xoc,n)}\label{eq:H_G2}\\
H(G_{3},G_Xoc,n) & =H(G_{2},G_Xoc,n)+H_{2}\big|_{\mathcal{I}(G_{3},G_Xoc,n)}\label{eq:H_G3}\\
H(G_{4},G_Xoc,n) & =H(G_{3},G_Xoc,n)+\sum_{i=n_{\text{in}}+1}^{n}H_{\text{in},i}\big|_{\mathcal{I}(G_{4},G_Xoc,n)}\label{eq:H_G4}\\
H(G_X,G_Xoc,n) & =H(G_{4},G_Xoc,n)+H_{\text{out}}\big|_{\mathcal{I}(G_X,G_Xoc,n)}\label{eq:H_GC}
\end{align}
where 
\begin{equation*}
H_{1}=\sum_{w=1}^{n}h_{1}^{(w)} \qquad H_{\text{in},i}=\sum_{w=1}^{n}h_{\text{in},i}^{(w)} \qquad 
H_{2}=\sum_{w=1}^{n}h_{2}^{(w)} \qquad  H_{\text{out}}=\sum_{w=1}^{n}h_{\text{out}}^{(w)}
\end{equation*}
are all positive semidefinite, with $h_{1},h_{2},h_{\text{in},i},h_{\text{out}}$ as defined in \sec{The-adjacency-matrix}. Note that in writing equations \eq{H_G2}, \eq{H_G3}, \eq{H_G4}, and \eq{H_GC}, we have used the fact (from \lem{The-smallest-eigenvalues}) that the adjacency matrices of the graphs we consider all have the same smallest eigenvalue $e_{1}$. Also note that
\begin{equation} \mathcal{\mathcal{I}}\left(G_{i},G_Xoc,n\right)=\mathcal{\mathcal{I}}\left(G_X,G_Xoc,n\right) \end{equation} for $i\in[4]$ since the gate diagrams for each of the graphs $G_{1},G_{2},G_{3},G_{4}$ and $G_X$ have the same set of diagram elements.

Let $S_{k}$ be the nullspace of $H(G_{k},G_Xoc,n)$ for $k=1,2,3,4$. Since these positive semidefinite Hamiltonians are related by adding positive semidefinite terms, their nullspaces satisfy 
\begin{equation}
S_{4}\subseteq S_{3}\subseteq S_{2}\subseteq S_{1}\subseteq\mathcal{\mathcal{I}}\left(G_X,G_Xoc,n\right).
\end{equation}
We solve for $S_1=\spn(\mathcal{B}_{\text{legal}})$ in \sec{Legal-configurations-and} and we characterize the spaces $S_2,S_3$, and $S_4$ in \sec{Frustration-free-states} in the course of applying our strategy. 

For example, to use the Nullspace Projection Lemma to lower bound the smallest nonzero eigenvalue of $H(G_{2},G_Xoc,n)$, we consider the restriction 
\begin{equation}
  \Big(H_{1}\big|_{\mathcal{I}(G_{2},G_Xoc,n)}\Big)\Big|_{S_{1}}
  =H_{1}\big|_{S_{1}}.\label{eq:H1_restriction}
\end{equation}
We also solve for $S_2$, which is equal to the nullspace of \eq{H1_restriction}. To obtain the corresponding lower bounds on the smallest nonzero eigenvalues of $H(G_{k},G_Xoc,n)$ for $k=2,3,4$ and $H(G_X,G_Xoc,n)$, we consider restrictions 
\begin{equation}
  H_{2}\big|_{S_{2}},
  \sum_{i=n_{\text{in}}+1}^{n}H_{\text{in},i}\big|_{S_{3}},\quad\text{and}\quad
  H_{\text{out}}\big|_{S_{4}}.
\end{equation}
Analyzing these restrictions involves extensive computation of matrix elements. To simplify and organize these computations, we first compute the restrictions of each of these operators to the space $S_{1}$. We present the results of this computation in \sec{Matrix-elements-in}; details of the calculation can be found in \sec{matrix_els_details}. In \sec{Frustration-free-states} we proceed with the remaining computations and apply the Nullspace Projection Lemma three times using equations \eq{H_G2}, \eq{H_G3}, and \eq{H_G4}. Finally, in \sec{Completeness-and-Soundness} we apply the Lemma again using equation \eq{H_GC} and we prove \thm{main_thm_with_occ_constraints}.



\subsection{Configurations}

In this Section we use \lem{BH_disconnected_graphs} to solve for the nullspace of $H(G_{1},n)$, i.e., the $n$-particle frustration-free states on $G_{1}$. \lem{BH_disconnected_graphs} describes how frustration-free states for $G_1$ are built out of frustration-free states for its components.

To see how this works, consider the example from \fig{G1}. In this example, with $n=3$, we construct a basis for the nullspace of $H(G_{1},3)$ by considering two types of eigenstates. First, there are frustration-free states
\begin{equation}
\Sym(|\rho_{z_{1},a_{1}}^{L_{1}}\rangle|\rho_{z_{2},a_{2}}^{L_{2}}\rangle|\rho_{z_{3},a_{3}}^{L_{3}}\rangle)
\label{eq:twopart_states1}
\end{equation}
where $L_{k}=(i_{k},j_{k},d_{k})\in\mathcal{L}$ belong to different components of $G_{1}$. That is to say, $j_{w}\neq j_{t}$ unless $j_{w}=j_{t}\in\{0,5\}$, in which case $i_{w}\neq i_{t}$ (in this case the particles are located either at the left or right boundary, in different rows of $G_{1}$). There are also frustration-free states where two of the three particles are located in the same two-qubit gadget $J\in[M]$ and one of the particles is located in a diagram element $L_{1}$ from a different component of the graph. These states have the form
\begin{equation}
\Sym(|T_{z_{1},a_{1},z_{2},a_{2}}^{J}\rangle|\rho_{z_{3},a_{3}}^{L_{1}}\rangle)
\label{eq:twopart_states2}
\end{equation}
where 
\begin{equation}
|T_{z_{1},a_{1},z_{2},a_{2}}^{J}\rangle=\frac{1}{\sqrt{2}}|\rho_{z_{1},a_{1}}^{(1,J,0)}\rangle|\rho_{z_{2},a_{2}}^{(s(J),J,0)}\rangle+\frac{1}{\sqrt{2}}\sum_{x_{1},x_{2}\in\{0,1\}}U_{J}(a_{1})_{x_{1}x_{2},z_{1}z_{2}}|\rho_{x_{1},a_{1}}^{(1,J,1)}\rangle|\rho_{x_{2},a_{2}}^{(s(J),J,1)}\rangle\label{eq:T_state}
\end{equation}
and $L_{1}=(i,j,k)\in\mathcal{L}$ satisfies $j\neq J$. Each of the states \eq{twopart_states1} and \eq{twopart_states2} is specified by $6$ ``data'' bits $z_{1},z_{2},z_{3},a_{1},a_{2},a_{3}\in\{0,1\}$ and a ``configuration'' indicating where the particles are located in the graph. The configuration is specified either by three diagram elements $L_{1},L_{2},L_{3}\in\mathcal{L}$ from different components of $G_{1}$ or by a two-qubit gate $J\in [M]$ along with a diagram element $L_{1}\in\mathcal{L}$ from a different component of the graph.

We now define the notion of a configuration for general $n$. Informally, we can think of an $n$-particle configuration as a way of placing $n$ particles in the graph $G_{1}$ subject to the following restrictions. We first place each of the $n$ particles in a component of the graph, with the restriction that no boundary gadget may contain more than one particle and no two-qubit gadget may contain more than two particles. For each particle on its own in a component (i.e., in a component with no other particles), we assign one of the diagram elements $L\in\mathcal{L}$ associated to that component. We therefore specify a configuration by a set of two-qubit gadgets $J_{1},\ldots,J_{Y}$ that contain two particles, along with a set of diagram elements $L_{k}\in\mathcal{L}$ that give the locations of the remaining $n-2Y$ particles. We choose to order the $J$s and the $L$s so that each configuration is specified by a unique tuple $(J_{1},\ldots,J_{Y},L_{1},\ldots,L_{n-2Y})$. For concreteness, we use the lexicographic order on diagram elements in the set $\mathcal{L}$: $L_{A}=(i_{A},j_{A},d_{A})$ and $L_{B}=(i_{B},j_{B},d_{B})$ satisfy $L_{A}<L_{B}$ iff either $i_{A}<i_{B}$, or $i_{A}=i_{B}$ and $j_{A}<j_{B}$, or $(i_{A},j_{A})=(i_{B},j_{B})$ and $d_{A}<d_{B}$.

\begin{definition}
[\textbf{Configuration}]\label{defn:configuration}An $n$-particle configuration on the gate graph $G_{1}$ is a tuple 
\begin{equation}
(J_{1},\ldots,J_{Y},L_{1},\ldots,L_{n-2Y})
\end{equation}
with $Y\in\{0,\ldots,\left\lfloor \frac{n}{2}\right\rfloor \}$, ordered integers
\begin{equation}
1\leq J_{1}<J_{2}<\cdots<J_{Y}\leq M,
\end{equation}
and lexicographically ordered diagram elements 
\begin{equation}
L_{1}<L_{2}<\cdots<L_{n-2Y},\qquad L_{k}=\left(i_{k},j_{k},d_{k}\right)\in\mathcal{L}.
\end{equation}
We further require that each $L_{k}$ is from a different component of $G_{1}$, i.e., 
\begin{equation}
j_{w}=j_{t}\quad\Longrightarrow\quad j_{w}\in\{0,M+1\}\text{ and }i_{w}\neq i_{t},
\end{equation}
and we require that $j_{u}\neq J_{v}$ for all $u\in[n-2Y]$ and $v\in[Y]$.
\end{definition}

\newcommand{\configex}[1]{
\raisebox{-0.5\height}{
\begin{tikzpicture}[scale=.4,yscale=.8, every node/.style={scale=0.4}]

% Gray Grid Lines 
\foreach \y in {2,4}{
  \draw[draw=black!20] (0,\y cm) -- (15.7 cm, \y cm);
}
\foreach \x in {2.618,5.236,7.854,10.472,13.09}{
  \draw[draw=black!20] (\x cm, 0cm) -- (\x cm, 6cm);
}
\setcounter{mycount}{1};
\foreach \y in {5,3,1}{
  \node at (-.6,\y) {$i = \arabic{mycount}$\addtocounter{mycount}{1}};
}
\foreach \x in {0, ...,5}{
  \node at ( 2.618*\x + 1.31,6.3) {$j = \x$};
}
  
% Boundary Graphs
\foreach \xscope /\scale in {0.5/1,15.2/-1}{ 
  \foreach \yscope in {1.81,3.81}{
    \begin{scope}[yshift = \yscope cm,xshift = \xscope cm,xscale=\scale]
      \draw[rounded corners = .75mm] (0,0) -- (.6,0) -- (.6,-.5) --
        (1.4,-.5) -- (1.4,-1.618) -- (0,-1.618) -- cycle;
      % \draw[fill=black] (1,-.5) circle (.66mm);
      % \draw[fill=black] (1.4,-.81) circle (.66mm);
      % \draw[fill=black] (1.4,-1.41) circle (.66mm);
      % \draw[fill=black] (1,-1.618) circle (.66mm);
      % \node at (.7,-1.11) {\large Bnd};
    \end{scope}
  }
}
      
% Gate Graphs
\setcounter{mycount}{1}
\foreach \ybottom/ \control /\unitary in {.19/1/1,2.19/0/1,.19/1/HT,2.19/1/1}{
  \begin{scope}[xshift = \value{mycount}*2.618 cm + .31cm]
    \begin{scope}[xshift=2cm,xscale=-1]
      \draw[rounded corners = .75mm,fill=white] 
        (0cm,\ybottom cm) -- (2cm, \ybottom cm) -- (2cm,\ybottom cm + 1.118cm) 
          -- (1.2cm, \ybottom cm + 1.118cm) -- (1.2cm, 4.5cm) -- (2cm, 4.5cm) 
          -- (2cm, 5.62 cm) -- (0cm, 5.62cm) -- (0cm, 4.5cm) -- (.6cm, 4.5cm)
          -- (.6cm, \ybottom cm + 1.118cm) -- (0cm, \ybottom cm + 1.118cm)
          -- cycle; 
    \end{scope}
  \end{scope}
  \addtocounter{mycount}{1};
}

#1

\end{tikzpicture}
}}

%\begin{figure}
%\subfloat[][]{\label{fig:configA}\configex{
%\node at (2.618+.31+1.7,5.06) {\huge $\times$};
%\node at (2*2.618+.31+.3,2.75) {\huge $\times$};
%\node at (3*2.618+.31+.3,.75) {\huge $\times$};
%}}
%\subfloat[][]{\label{fig:configB}\configex{
%\node at (2.618+.31+1.7,.75) {\huge $\times$};
%\foreach \yoffset in {.2,-.2}{
%  \node at (2*2.618+.31+1.1,4+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (2*2.618+.31+1.1,4) ellipse (.25 cm and .45 cm);
%}}
%
%\subfloat[][]{\label{fig:configC}\configex{
%\node at (2.618+.31+1.7,5.06) {\huge $\times$};
%\node at (.5+1.1,2.75) {\huge $\times$};
%\node at (3*2.618+.31+.3,.75) {\huge $\times$};
%}}
%\subfloat[][]{\label{fig:configD}\configex{
%\node at (.5+1.1,2.75) {\huge $\times$};
%\foreach \yoffset in {.2,-.2}{
%  \node at (3*2.618+.31+1.1,3+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (3*2.618+.31+1.1,3) ellipse (.25 cm and .45 cm);
%}}
%
%\subfloat[][]{\label{fig:configE}\configex{
%\node at (3*2.618+.31+.3,5.06) {\huge $\times$};
%\node at (2*2.618+.31+1.7,2.75) {\huge $\times$};
%\node at (4*2.618+.31+.3,2.75) {\huge $\times$};
%}}
%\subfloat[][]{\label{fig:configF}\configex{
%\node at (2.618+.31+1.7,5.06) {\huge $\times$};
%\node at (2*2.618+.31+.3,2.75) {\huge $\times$};
%\node at (5*2.618+.718+.3,.75) {\huge $\times$};
%}}
%\caption{Diagrammatic depictions of configurations for the example where $G_1$ is the gate graph from \fig{G1}. The Figures show the locations of each of the three particles in the gate graph.  The symbol \protect\tikz[scale=.4, yscale=.8, every node/.style={scale=0.4}]{
%\protect \node at (0,0) {\protect \huge $\times$};} indicates a single-particle state and the symbol \protect\tikz[scale=.4, yscale=.8, every node/.style={scale=0.4}]{
%\protect \node at (0,.2) {\protect \large $\times$};
%\protect \node at (0,-.2) {\protect \large $\times$};
%\protect \draw (0,0) ellipse (.25 cm and .45 cm);}
%indicates a two-particle state.
%\subfig{configA} $((1,1,1),(2,2,0),(3,3,0))$.
%\subfig{configB} $(2,(3,1,1))$.
%\subfig{configC} $((1,1,1),(2,0,1),(3,3,0)$.
%\subfig{configD} $(3,(2,0,1))$.
%\subfig{configE} $((1,3,0),(2,2,1),(2,4,0))$.
%\subfig{configF} $((1,1,1),(2,2,0),(3,5,0))$.
%\label{fig:configs}}
%\end{figure}

In \fig{configs} we give some examples of configurations (for the example from \fig{G1} with $n=3$) and we introduce a diagrammatic notation for them.

For any configuration and $n$-bit strings $\vec{z}$ and $\vec{a}$, there is a state in the nullspace of $H(G_{1},n)$, given by
\begin{equation}
\Sym(|T_{z_{1},a_{1},z_{2},a_{2}}^{J_{1}}\rangle\ldots|T_{z_{2Y-1},a_{2Y-1},z_{2Y},a_{2Y}}^{J_{Y}}\rangle|\rho_{z_{2Y+1},a_{2Y+1}}^{L_{1}}\rangle\ldots|\rho_{z_{n},a_{n}}^{L_{n-2Y}}\rangle).\label{eq:config_data_state}
\end{equation}
The ordering in the definition of a configuration ensures that each distinct choice of configuration and $n$-bit strings $\vec{z},\vec{a}$ gives a different state.

\begin{definition}
Let $\mathcal{B}_{n}$ be the set of all states of the form \eq{config_data_state}, where $(J_{1},\ldots,J_{Y},L_{1},\ldots,L_{n-2Y})$ is a configuration and $\vec{z},\vec{a}\in\{0,1\}^{n}$.
\end{definition}

\begin{lemma}
\label{lem:gs_g_alpha}The set $\mathcal{B}_{n}$ is an orthonormal
basis for the nullspace of $H(G_{1},n)$. Furthermore,
\begin{equation}
  \gamma(H(G_{1},n)) \geq \mathcal{K}_0
\label{eq:first_lowerbnd}
\end{equation}
where $\mathcal{K}_0\in (0,1]$ is an absolute constant.
\end{lemma}

\begin{proof}
Each component of $G_{1}$ is either a two-qubit gadget or a boundary gadget (see equation \eq{G_alpha}). The single-particle states of $A(G_{1})$ with energy $e_{1}$ are the states $|\rho_{z,a}^{L}\rangle$ for $L\in\mathcal{L}$ and $z,a\in\{0,1\}$, as discussed in \sec{The-adjacency-matrix}. Each of these states has support on only one component of $G_{1}$. In addition, $G_{1}$ has a two-particle frustration-free state for each two-qubit gadget $J\in[M]$ and bits $z,a,x,b$, namely $\Sym(|T_{z,a,x,b}^{J}\rangle)$. Furthermore, no component of $G_{1}$ has any three- (or more) particle frustration-free states. Using these facts and applying \lem{BH_disconnected_graphs}, we see that $\mathcal{B}_{n}$ spans the nullspace of $H(G_{1},n)$.

\lem{BH_disconnected_graphs} also expresses each eigenvalue of $H(G_{1},n)$ as a sum of eigenvalues for its components. We use this fact to obtain the desired lower bound on the smallest nonzero eigenvalue. Our analysis proceeds on a case-by-case basis, depending on the occupation numbers for each component of $G_{1}$ (the values $N_{1},\ldots,N_{k}$ in \lem{BH_disconnected_graphs}).

First consider any set of occupation numbers where some two-qubit gate gadget $J\in[M]$ contains 3 or more particles. By \lem{increase_part_number} and \lem{BH_disconnected_graphs}, any such eigenvalue is at least $\lambda_{3}^{1}(G_{U_J})$, which is a positive constant by \lem{2qub_gate}. Next consider a case where some boundary gadget contains more than one particle. The corresponding eigenvalues are similarly lower bounded by $\lambda_{2}^{1}(G_{\text{bnd}})$, which is also a positive constant by \lem{boundary_lemma}. Finally, consider a set of occupation numbers where each two-qubit gadget contains at most two particles and each boundary gadget contains at most one particle. The smallest eigenvalue with such a set of occupation numbers is zero. The smallest nonzero eigenvalue is either
\begin{equation}
\gamma(H(G_{U_J},1)),\,\gamma(H(G_{U_J},2))\text{ for some $J\in[M]$, or }\gamma(H(G_{\text{bnd}},1)).
\end{equation}
However, these quantities are at least some positive constant since $H(G_{U_J},1)$, $H(G_{U_J},2)$, and $H(G_{\text{bnd}},1)$ are nonzero constant-sized positive semidefinite matrices.

Now combining the lower bounds discussed above and using the fact that, for each $J\in [M]$, the two-qubit gate $U_J$ is chosen from a fixed finite gate set (given in \eq{gate_set_Vr}), we see that $\gamma (H(G_1,n))$ is lower bounded by the positive constant 
\begin{equation}
  \min\{\lambda_{3}^{1}(G_U),
        \lambda_{2}^{1}(G_{\text{bnd}}),
        \gamma(H(G_U,1)),
        \gamma(H(G_U,2)),
        \gamma(H(G_{\text{bnd}},1))\colon
        \text{$U$ is from the gate set \eq{gate_set_Vr}}\}.
\label{eq:minterms}
\end{equation}
The condition $\mathcal{K}_0\leq1$ can be ensured by setting $\mathcal{K}_0$ to be the minimum of $1$ and \eq{minterms}.
\end{proof}

Note that the constant $\mathcal{K}_0$ can in principle be computed using \eq{minterms}: each quantity on the right-hand side can be evaluated by diagonalizing a specific finite-dimensional matrix.


\subsubsection{Legal configurations}

In this section we define a subset of the $n$-particle configurations that we call legal configurations, and we prove that the subset of the basis vectors in $\mathcal{B}_{n}$ that have legal configurations spans the nullspace of $H(G_{1},G_Xoc,n).$

We begin by specifying the set of legal configurations. Every legal configuration 
\begin{equation}
(J_{1},\ldots,J_{Y},L_{1},\ldots,L_{n-2Y})
\end{equation}
has $Y\in\{0,1\}$. The legal configurations with $Y=0$ are 
\begin{equation}
((1,j,d_{1}),F(2,j,d_{2}),F(3,j,d_{3}),\ldots,F(n,j,d_{n}))\label{eq:config_c01}
\end{equation}
where $j\in[M]$ and where $\vec{d}=\left(d_{1},\ldots,d_{n}\right)$ satisfies $d_{i}\in\{0,1\}$ and $d_{1}=d_{s(j)}$. (Recall that the function $F$, defined in equations \eq{F_bit0} and \eq{F_bit1}, describes horizontal movement of particles.) The legal configurations with $Y=1$ are 
\begin{equation}
(j,F(2,j,d_{2}),\ldots,F(s(j)-1,j,d_{s(j)-1}),F(s(j)+1,j,d_{s(j)+1}),\ldots,F(n,j,d_{n}))\label{eq:config_2}
\end{equation}
where $j\in\{1,\ldots,M\}$ and $d_{i}\in\{0,1\}$ for $i\in[n]\setminus\{1,s(j)\}$. Although the values $d_{1}$ and $d_{s(j)}$ are not used in equation \eq{config_2}, we choose to set them to 
\begin{equation}
d_{1}=d_{s(j)}=2
\end{equation}
for any legal configuration with $Y=1$. In this way we identify the set of legal configurations with the set of pairs $j,\vec{d}$ with $j\in[M]$ and 
\begin{equation}
\vec{d}=(d_{1},d_{2},d_{3},\ldots,d_{n})
\end{equation}
satisfying 
\begin{align}
d_{1} & =d_{s(j)}\in\{0,1,2\} \quad \text{and} \quad d_{i}\in\{0,1\} \text{ for } i\notin\{1,s(j)\}.
\end{align}
The legal configuration is given by equation \eq{config_c01} if $d_{1}=d_{s(j)}\in\{0,1\}$ and equation \eq{config_2} if $d_{1}=d_{s(j)}=2$. 

The examples in \figs{configA}, \subfig{configB}, and \subfig{configC} show legal configurations whereas the examples in \figs{configD}, \subfig{configE}, and \subfig{configF} are illegal.  The legal examples correspond to $j=1$, $\vec d=(1,1,1)$; $j=2$, $\vec d=(2,2,0)$; and $j=1$, $\vec d=(1,0,1)$, respectively.  We now explain why the other examples are illegal. Looking at \eq{config_2}, we see that the configuration $(3,(2,0,1))$ depicted in \fig{configD} is illegal since $F(2,3,0)=(2,2,1) \neq (2,0,1)$ and $F(2,3,1)=(2,4,0) \neq (2,0,1)$. The configuration in \fig{configE} is illegal since there are two particles in the same row. Looking at equation \eq{config_c01}, we see that the configuration $((1,1,1),(2,2,0),(3,5,0))$ in \fig{configF} is illegal since $(3,5,0)\notin \{F(3,1,0),F(3,1,1)\} = \{(3,0,1),(3,3,0)\}$.

We now identify the subset of basis vectors $\mathcal{B}_{\text{legal}}\subset\mathcal{B}_{n}$ that have legal configurations. We write each such basis vector as
\begin{equation}
|j,\vec{d},\vec{z},\vec{a}\rangle=\begin{cases}
\Sym\Big(|\rho_{z_{1},a_{1}}^{(1,j,d_{1})}\rangle\displaystyle\bigotimes_{i=2}^{n}|\rho_{z_{i},a_{i}}^{F(i,j,d_{i})}\rangle\Big) & d_{1}=d_{s(j)}\in\{0,1\}\\
\Sym\bigg(|T_{z_{1},a_{1},z_{s(j)},a_{s(j)}}^{j}\rangle\displaystyle\bigotimes_{\substack{i=2\\i\neq s(j)}}^n |\rho_{z_{i},a_{i}}^{F(i,j,d_{i})}\rangle\bigg) & d_{1}=d_{s(j)}=2
\end{cases}\label{eq:legal_states}
\end{equation}
where $j,\vec{d}$ specifies the legal configuration and $\vec{z,}\vec{a}\in\{0,1\}^{n}$. (Note that the bits in $\vec{z}$ and $\vec{a}$ are ordered slightly differently than in equation \eq{config_data_state}; here the labeling reflects the indices of the encoded qubits). 

\begin{definition}
Let 
\begin{equation}
\mathcal{B}_{\text{legal}}=\big\{ |j,\vec{d},\vec{z},\vec{a}\rangle\colon j\in [M],\; d_{1}=d_{s(j)}\in\{0,1,2\}\text{ and }\; d_{i}\in\{0,1\}\text{ for }i\notin\{1,s(j)\},\;\vec{z},\vec{a}\in\{0,1\}^{n}\big\} 
\end{equation}
 and $\mathcal{B}_{\text{illegal}}=\mathcal{B}_{n}\setminus\mathcal{B}_{\text{illegal}}.$ 
\end{definition}

The basis $\mathcal{B}_{n}=\mathcal{B}_{\text{legal}}\cup\mathcal{B}_{\text{illegal}}$ is convenient when considering the restriction to the subspace $\mathcal{I}(G_{1},G_Xoc,n)$. Letting $\Pi_{0}$ be the projector onto $\mathcal{I}(G_{1},G_Xoc,n)$, the following Lemma (proven in \sec{Proof-of-Lemma Pi0_restriction}) shows that the restriction 
\begin{equation}
\Pi_{0}\big|_{\spn(\mathcal{B}_{n})}\label{eq:restrictionBn}
\end{equation}
is diagonal in the basis $\mathcal{B}_n$. The Lemma also bounds the diagonal entries.

\begin{restatable}{lemma}{restrictionlemma}
\label{lem:Pi_0_restriction}
Let $\Pi_{0}$ be the projector onto $\mathcal{I}(G_{1},G_Xoc,n)$. For any $|j,\vec{d},\vec{z},\vec{a}\rangle\in\mathcal{B}_{\text{legal}}$, we have
\begin{align}
\Pi_{0}|j,\vec{d},\vec{z},\vec{a}\rangle & =|j,\vec{d},\vec{z},\vec{a}\rangle\label{eq:subspace_eqn0}.
\end{align}
Furthermore, for any two distinct basis vectors $|\phi\rangle,|\psi\rangle\in\mathcal{B}_{\text{illegal}}$, we have 
\begin{align}
\langle\phi|\Pi_{0}|\phi\rangle & \leq\frac{255}{256}\label{eq:subspace_eqn1}\\
\langle\phi|\Pi_{0}|\psi\rangle & =0.\label{eq:subspace_eqn2}
\end{align}
\end{restatable}

We use this Lemma to characterize the nullspace of $H(G_{1},G_Xoc,n)$ and bound its smallest nonzero eigenvalue.

\begin{lemma}
\label{lem:H_Galpha_Gtilde}The nullspace $S_1$ of $H(G_{1},G_Xoc,n)$ is spanned by the orthonormal basis $\mathcal{B}_{\text{legal}}$. Its smallest nonzero eigenvalue is
\begin{equation}
  \gamma(H(G_{1},G_Xoc,n)) \geq \frac{\mathcal{K}_0}{256} \label{eq:G_alpha_lowerbnd}
\end{equation}
where $\mathcal{K}_0\in (0,1]$ is the absolute constant from \lem{gs_g_alpha}.
\end{lemma}

\begin{proof}
Recall from \sec{The-occupancy-constraints} that 
\begin{equation}
H(G_{1},G_Xoc,n)=H(G_{1},n)|_{\mathcal{I}(G_{1},G_Xoc,n)}.
\end{equation}
Its nullspace is the space of states $|\kappa\rangle$ satisfying
\begin{equation}
\Pi_{0}|\kappa\rangle=|\kappa\rangle\quad\text{and}\quad H(G_{1},n)|\kappa\rangle=0
\end{equation}
(recall that $\Pi_{0}$ is the projector onto $\mathcal{I}(G_{1},G_Xoc,n)$, the states satisfying the occupancy constraints). Since $\mathcal{B}_{n}$ is a basis for the nullspace of $H(G_{1},n)$, to solve for the nullspace of $H(G_{1},G_Xoc,n)$ we consider the restriction \eq{restrictionBn} and solve for the eigenspace with eigenvalue $1$. This calculation is simple because \eq{restrictionBn} is diagonal in the basis $\mathcal{B}_{n}$, according to \lem{Pi_0_restriction}. We see immediately from the Lemma that $\mathcal{\mathcal{B}_{\text{legal}}}$ spans the nullspace of $H(G_{1},G_Xoc,n)$; we now show that \lem{Pi_0_restriction} also implies the lower bound \eq{G_alpha_lowerbnd}. Note that
\begin{equation}
\gamma(H(G_{1},G_Xoc,n))=\gamma(\Pi_{0}H(G_{1},n)\Pi_{0}).
\end{equation}
Let $\Pi_{\text{legal}}$ and $\Pi_{\text{illegal}}$ project onto the spaces spanned by $\mathcal{B}_{\text{legal}}$ and $\mathcal{B}_{\text{illegal}}$ respectively, so $\Pi_{\text{legal}}+\Pi_{\text{illegal}}$ projects onto the nullspace of $H(G_{1},n)$. The operator inequality
\begin{equation}
H(G_{1},n)\geq\gamma(H(G_{1},n))\cdot\left(1-\Pi_{\text{legal}}-\Pi_{\text{illegal}}\right)
\end{equation}
implies 
\begin{equation}
\Pi_{0}H(G_{1},n)\Pi_{0}\geq\gamma(H(G_{1},n))\cdot\Pi_{0}(1-\Pi_{\text{legal}}-\Pi_{\text{illegal}})\Pi_{0}.
\end{equation}
Since the operators on both sides of this inequality are positive semidefinite and have the same nullspace, their smallest nonzero eigenvalues are bounded as 
\begin{equation}
\gamma(\Pi_{0}H(G_{1},n)\Pi_{0})\geq\gamma(H(G_{1},n))\cdot\gamma(\Pi_{0}(1-\Pi_{\text{legal}}-\Pi_{\text{illegal}})\Pi_{0}).
\end{equation}
Hence 
\begin{equation}
\gamma(H(G_{1},G_Xoc,n))=\gamma(\Pi_{0}H(G_{1},n)\Pi_{0}) \geq \mathcal{K}_0\cdot\gamma(\Pi_{0}(1-\Pi_{\text{legal}}-\Pi_{\text{illegal}})\Pi_{0})
\label{eq:gamma_bnd1}
\end{equation}
where we used \lem{gs_g_alpha}. From equations \eq{subspace_eqn1} and \eq{subspace_eqn2} we see that 
\begin{equation}
\Pi_{0}|g\rangle=|g\rangle\quad\text{and}\quad\Pi_{\text{illegal}}|f\rangle=|f\rangle\qquad\Longrightarrow\qquad\langle f|g\rangle\langle g|f\rangle\leq\frac{255}{256}.\label{eq:fg_eqn}
\end{equation}
The nullspace of 
\begin{equation}
\Pi_{0}\left(1-\Pi_{\text{legal}}-\Pi_{\text{illegal}}\right)\Pi_{0}\label{eq:projector_conjugated}
\end{equation}
is spanned by 
\begin{equation}
\mathcal{B}_{\text{legal}}\cup\left\{ |\tau\rangle\colon\Pi_{0}|\tau\rangle=0\right\} .
\end{equation}
To see this, note that \eq{projector_conjugated} commutes with $\Pi_{0}$, and the space of $+1$ eigenvectors of $\Pi_{0}$ that are annihilated by \eq{projector_conjugated} is spanned by $\mathcal{B}_{\text{legal}}$ (by \lem{Pi_0_restriction}). Any eigenvector $|g_{1}\rangle$ corresponding to the smallest nonzero eigenvalue of this operator therefore satisfies $\Pi_{0}|g_{1}\rangle=|g_{1}\rangle$ and $\Pi_{\text{legal}}|g_{1}\rangle=0$, so 
\begin{align}
\gamma(\Pi_{0}(1-\Pi_{\text{legal}}-\Pi_{\text{illegal}})\Pi_{0}) 
&= 1-\langle g_{1}|\Pi_{\mathcal{\text{illegal}}}|g_{1}\rangle\geq\frac{1}{256}
\end{align}
using equation \eq{fg_eqn}. Plugging this into equation \eq{gamma_bnd1} gives the lower bound \eq{G_alpha_lowerbnd}. 
\end{proof}


We now consider 
\begin{equation}
H_{1}|_{S_{1}},H_{2}|_{S_{1}},H_{\text{in},i}|_{S_{1}},H_{\text{out}}|_{S_{1}}\label{eq:ops_restriction_S1}
\end{equation}
where these operators are defined in \sec{Building-up-the} and 
\begin{equation}
S_{1}=\spn(\mathcal{B}_{\text{legal}})
\end{equation}
is the nullspace of $H(G_1,G_Xoc,n)$.

We specify the operators \eq{ops_restriction_S1} by their matrix elements in an orthonormal basis for $S_{1}$. Although the basis $\mathcal{B}_{\text{legal}}$ was convenient in \sec{Legal-configurations-and}, here we use a different basis in which the matrix elements of $H_{1}$ and $H_{2}$ are simpler. We define
\begin{equation}
  |j,\vec{d},\In(\vec{z}),\vec{a}\rangle
  =\sum_{\vec{x}\in\{0,1\}^{n}} \big(\langle\vec{x} 
   |\bar{U}_{j,d_1}(a_{1}) 
   |\vec{z}\rangle\big)|j,\vec{d},\vec{x},\vec{a}\rangle 
  \label{eq:phi_init_basis}
\end{equation}
where
\begin{equation}
  \bar{U}_{j,d_1}(a_1) = \begin{cases}
    U_{j-1}(a_1) U_{j-2}(a_1) \ldots U_1(a_1) & \text{if $d_1 \in \{0,2\}$} \\
    U_j(a_1) U_{j-1}(a_1) \ldots U_1(a_1) & \text{if $d_1=1$}.
  \end{cases}
  \label{eq:ubar}
\end{equation}
In each of these states the quantum data (represented by the $\vec{x}$ register on the right-hand side) encodes the computation in which the unitary $\bar{U}_{j,d_1}(a_1)$ is applied to the initial $n$-qubit state $|\vec{z}\rangle$ (the notation $\In(\vec{z})$ indicates that $\vec{z}$ is the input). The vector $\vec{a}$ is only relevant insofar as its first bit $a_{1}$ determines whether or not each two-qubit unitary is complex conjugated; the other bits of $\vec{a}$ go along for the ride. Letting $\vec{z},\vec{a}\in\{0,1\}^{n}$ , $j\in[M]$, and \begin{equation} \vec{d}=(d_{1},\ldots,d_{n})\quad\text{with}\quad d_{1}=d_{s(j)}\in\{0,1,2\}\quad\text{and}\quad d_{i}\in\{0,1\},\; i\notin\{1,s(j)\}, \end{equation} we see that the states \eq{phi_init_basis} form an orthonormal basis for $S_{1}$. In \sec{matrix_els_details} we compute the matrix elements of the operators \eq{ops_restriction_S1} in this basis, which are reproduced below.

Roughly speaking, the nonzero off-diagonal matrix elements of the operator $H_{1}$ in the basis \eq{phi_init_basis} occur between states $|j,\vec{d},\In(\vec{z}),\vec{a}\rangle$ and $|j,\vec{c},\In(\vec{z}),\vec{a}\rangle$ where the legal configurations $j,\vec{d}$ and $j,\vec{c}$ are related by horizontal motion of a particle in one of the rows $i\in\{2,\ldots,n\}$. 

\begin{mdframed}[frametitle=Matrix elements of $H_{1}$]
\begin{equation}
\langle k,\vec{c},\In(\vec{x}),\vec{b}|H_{1}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle=\delta_{k,j}\delta_{\vec{a},\vec{b}}\delta_{\vec{z},\vec{x}}\cdot\begin{cases}
\frac{n-1}{64} & \vec{c}=\vec{d}\\
\frac{1}{64}\displaystyle\prod_{\substack{r=1\\r\neq i}}^n
\delta_{d_{r},c_{r}} & d_{i}\neq c_{i}\;\text{for some}\; i\in[n]\setminus\{1,s(j)\}\\
\frac{1}{64\sqrt{2}} \displaystyle\prod_{\substack{r=2\\r\neq s(j)}}^n \delta_{d_{r},c_{r}} & (c_{1},d_{1})\in\{(2,0),(0,2),(1,2),(2,1)\}\\
0 & \text{otherwise.}
\end{cases}\label{eq:H1_goodbasis-1}
\end{equation}
\end{mdframed}

\newcommand{\configtrans}[2]{
\configex{#1}
$~\longrightarrow~$
\configex{#2}
}
%\begin{figure}
%\subfloat[][$\langle j,\vec{c},\In(\vec{z}),\vec{a}|H_1|j,\vec{d},\In(\vec{z}),\vec{a}\rangle
%    =\frac{1}{64}$; here $j=2$ and $\vec{d}=(2,2,0) \rightarrow \vec{c}=(2,2,1)$.]{\label{fig:H1_InbasisA}
%\configtrans{
%\node at (2.618+.31+1.7,.75) {\huge $\times$};
%\foreach \yoffset in {.2,-.2}{
%  \node at (2*2.618+.31+1.1,4+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (2*2.618+.31+1.1,4) ellipse (.25 cm and .45 cm);
%}{
%\foreach \yoffset in {.2,-.2}{
%  \node at (2*2.618+.31+1.1,4+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (2*2.618+.31+1.1,4) ellipse (.25 cm and .45 cm);
%\node at (3*2.618+.31+.3,.75) {\huge $\times$};
%}}
%
%\subfloat[][$\langle j,\vec{c},\In(\vec{z}),\vec{a}|H_1|j,\vec{d},\In(\vec{z}),\vec{a}\rangle
%   =\frac{1}{64\sqrt{2}}$; here $j=3$ and $\vec{d}=(0,0,0) \rightarrow \vec{c}=(2,0,2)$. ]{\label{fig:H1_InbasisB}
%\configtrans{
%\node at (2.618+.31+1.7,.75) {\huge $\times$};
%\node at (2*2.618+.31+1.7,2.75) {\huge $\times$};
%\node at (3*2.618+.31+.3,5.06) {\huge $\times$};
%}{
%\node at (2*2.618+.31+1.7,2.75) {\huge $\times$};
%\foreach \yoffset in {.2,-.2}{
%  \node at (3*2.618+.31+1.1,3+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (3*2.618+.31+1.1,3) ellipse (.25 cm and .45 cm);
%}}
%
%\subfloat[][$\langle j,\vec{c},\In(\vec{z}),\vec{a}|H_1|j,\vec{d},\In(\vec{z}),\vec{a}\rangle
%  =\frac{1}{64\sqrt{2}}$; here $j=1$ and $\vec{d}=(1,1,1) \rightarrow \vec{c}=(2,1,2)$.]{\label{fig:H1_InbasisC}
%\configtrans{
%\node at (2.618+.31+1.7,5.06) {\huge $\times$};
%\node at (2*2.618+.31+.3,2.75) {\huge $\times$};
%\node at (3*2.618+.31+.3,.75) {\huge $\times$};
%}{
%\foreach \yoffset in {.2,-.2}{
%  \node at (2.618+.31+1.1,3+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (2.618+.31+1.1,3) ellipse (.25 cm and .45 cm);
%\node at (2*2.618+.31+.3,2.75) {\huge $\times$};
%}}
%
%\caption{
%Examples of matrix elements of $H_1$ in the basis \eq{phi_init_basis} of $S_1$. The relevant matrix elements (as indicated above) are computed using \subfig{H1_InbasisA} the second case and \subfig{H1_InbasisB}, \subfig{H1_InbasisC} the third case in equation \eq{H1_goodbasis-1}. \label{fig:H1_Inbasis}
%}
%\end{figure}

From this expression we see that $H_{1}|_{S_1}$ is block diagonal in the basis \eq{phi_init_basis}, with a block for each $\vec{z},\vec{a}\in\{0,1\}^{n}$ and $j\in[M]$. Moreover, the submatrix for each block is the same. In \fig{H1_Inbasis} we illustrate some of the off-diagonal matrix elements of $H_{1}|_{S_{1}}$ for the example from \fig{step-by-step}.

Next, we present the matrix elements of $H_2$.

\begin{mdframed}[frametitle=Matrix elements of $H_{2}$]
\begin{align}
\langle k,\vec{c},\In(\vec{x}),\vec{b}|H_{2}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle & =f_{\mathrm{diag}(\vec{d},j)\cdot\delta_{j,k}\delta_{\vec{a},\vec{b}}\delta_{\vec{z},\vec{x}}\delta_{\vec{c},\vec{d}}}\label{eq:H2_formula_with_f}\\
 & \quad +\big(f_{\textrm{off-diag}}(\vec{c},\vec{d},j)\cdot\delta_{k,j-1}+f_{\textrm{off-diag}}(\vec{d},\vec{c},k)\cdot\delta_{k-1,j}\big)\delta_{\vec{a},\vec{b}}\delta_{\vec{z},\vec{x}}\nonumber 
\end{align}
where
\begin{equation}
f_{\mathrm{diag}}(\vec{d},j)=\begin{cases}
0 & d_{1}=0\text{ and }j=1,\text{ or }d_{1}=1\text{ and }j=M\\
\frac{1}{128} & d_{1}=2\text{ and }j\in\{1,M\}\\
\frac{1}{64} & \text{otherwise}
\end{cases}\label{eq:H2_diag_goodbasis-1}
\end{equation}
and 
\begin{equation}
f_{\textrm{off-diag}}(\vec{c},\vec{d},j)=\left(
\prod_{\substack{r=2\\r\notin\{s(j-1),s(j)\}}}^n \mkern-36mu\delta_{d_{r},c_{r}}\right)\cdot\begin{cases}
\frac{1}{64\sqrt{2}} & (c_{1},c_{s(j)},d_{1},d_{s(j-1)})\in\{(2,0,0,0),(1,1,2,1)\}\\
\frac{1}{64} & (c_{1},c_{s(j)},d_{1},d_{s(j-1)})=(1,0,0,1)\\
\frac{1}{128} & (c_{1},c_{s(j)},d_{1},d_{s(j-1)})=(2,1,2,0)\\
0 & \text{otherwise.}
\end{cases}\label{eq:H2_offdiag_goodbasis-1}
\end{equation}
\end{mdframed}

%\begin{figure}
%\subfloat[][$\langle j-1,\vec{c},\In(\vec{z}),\vec{a}|H_2|j,\vec{d},\In(\vec{z}),\vec{a}\rangle
%  =\frac{1}{64\sqrt{2}}$; here $j=4$ and $\vec{d}=(0,0,0)\rightarrow\vec{c}=(2,0,2)$]{\label{fig:H2_InbasisA}
%\configtrans{
%\node at (2*2.618+.31+1.7,2.75) {\huge $\times$};
%\node at (3*2.618+.31+1.7,.75) {\huge $\times$};
%\node at (4*2.618+.31+.3,5.06) {\huge $\times$};
%}{
%\node at (2*2.618+.31+1.7,2.75) {\huge $\times$};
%\foreach \yoffset in {.2,-.2}{
%  \node at (3*2.618+.31+1.1,3+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (3*2.618+.31+1.1,3) ellipse (.25 cm and .45 cm);
%}}
%
%\subfloat[][
%  $\langle j-1,\vec{c},\In(\vec{z}),\vec{a}|H_2|j,\vec{d},\In(\vec{z}),\vec{a}\rangle
%  =\frac{1}{64 \sqrt{2}}$; here $j=3$ and $\vec{d}=(2,1,2)\rightarrow\vec{c}=(1,1,1)$]{\label{fig:H2_InbasisB}
%\configtrans{
%\foreach \yoffset in {.2,-.2}{
%  \node at (3*2.618+.31+1.1,3+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (3*2.618+.31+1.1,3) ellipse (.25 cm and .45 cm);
%\node at (4*2.618+.31+.3,2.75) {\huge $\times$};
%}{
%\node at (2*2.618+.31+1.7,5.06) {\huge $\times$};
%\node at (3*2.618+.31+.3,.75) {\huge $\times$};
%\node at (4*2.618+.31+.3,2.75) {\huge $\times$};
%}}
%
%\subfloat[][
%  $\langle j-1,\vec{c},\In(\vec{z}),\vec{a}|H_2|j,\vec{d},\In(\vec{z}),\vec{a}\rangle
%  =\frac{1}{64}$; here $j=3$ and $\vec{d}=(0,1,0)\rightarrow\vec{c}=(1,1,0)$]{
%\label{fig:H2_InbasisC}
%\configtrans{
%\node at (2.618+.31+1.7,.75) {\huge $\times$};
%\node at (3*2.618+.31+.3,5.06) {\huge $\times$};
%\node at (4*2.618+.31+.3,2.75) {\huge $\times$};
%}{
%\node at (2.618+.31+1.7,.75) {\huge $\times$};
%\node at (2*2.618+.31+1.7,5.06) {\huge $\times$};
%\node at (4*2.618+.31+.3,2.75) {\huge $\times$};
%}}
%
%\subfloat[][
%  $\langle j-1,\vec{c},\In(\vec{z}),\vec{a}|H_2|j,\vec{d},\In(\vec{z}),\vec{a}\rangle
%  =\frac{1}{128}$; here $j=2$ and $\vec{d}=(2,2,0)\rightarrow\vec{c}=(2,1,2)$]{
%\label{fig:H2_InbasisD}
%\configtrans{
%\node at (2.618+.31+1.7,.75) {\huge $\times$};
%\foreach \yoffset in {.2,-.2}{
%  \node at (2*2.618+.31+1.1,4+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (2*2.618+.31+1.1,4) ellipse (.25 cm and .45 cm);
%}{
%\foreach \yoffset in {.2,-.2}{
%  \node at (2.618+.31+1.1,4+\yoffset) {\large $\times$};
%}
%\draw[line width=.1mm] (2.618+.31+1.1,4) ellipse (.25 cm and .45 cm);
%\node at (2*2.618+.31+.3,2.75) {\huge $\times$};
%}}
%\caption{
%Examples of matrix elements of $H_2$ in the basis \eq{phi_init_basis} of $S_1$. The relevant matrix elements (as indicated above) are computed using the \subfig{H2_InbasisA}, \subfig{H2_InbasisB} first, \subfig{H2_InbasisC} second, and \subfig{H2_InbasisD} third cases in equation \eq{H2_offdiag_goodbasis-1}. \label{fig:H2_Inbasis}}
%\end{figure}

This shows that $H_{2}|_{S_{1}}$ is block diagonal in the basis \eq{phi_init_basis}, with a block for
each $\vec{z},\vec{a}\in\{0,1\}^{n}$. Also note that (in contrast
with $H_{1}$) $H_{2}$ connects states with different values of $j$.
In \fig{H2_Inbasis} we illustrate some of the off-diagonal
matrix elements of $H_{2}|_{S_{1}}$, for the example from \fig{step-by-step}.

Finally, we present the matrix elements of $H_{\text{in},i}$ (for
$i\in\{n_{\text{in}}+1,\ldots,n\}$) and $H_{\text{out}}$:

\begin{mdframed}[frametitle=Matrix elements of $H_{\text{in},i}$]
For each ancilla qubit $i\in\{n_{\text{in}}+1,\ldots,n\}$, define  $j_{\min,i}=\min\left\{ j\in[M]\colon s(j)=i\right\}$ to be the index of the first gate in the circuit that involves this qubit (recall from \sec{From-circuits-to} that we consider circuits where each ancilla qubit is involved in at least one gate). The operator $H_{\text{in},i}$ is diagonal in the basis \eq{phi_init_basis}, with entries
\begin{equation}
\langle j,\vec{d},\In(\vec{z}),\vec{a}|H_{\text{in},i}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle=\begin{cases}
\frac{1}{64} & j\leq j_{\min,i},\text{ }z_{i}=1,\text{ and }d_{i}=0\\
0 & \text{otherwise.}
\end{cases}\label{eq:Hin_mat_els}
\end{equation}
\end{mdframed}

\begin{mdframed}[frametitle=Matrix elements of $H_{\text{out}}$]
Let $j_{\max}=\max\{j\in[M]\colon s(j)=2\}$ be the index of the last gate $U_{j_{\max}}$ in the circuit that acts between qubits $1$ and $2$ (the output qubit). Then
\begin{equation}
\langle k,\vec{c},\In(\vec{x}),\vec{b}|H_{\text{out}}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle=\delta_{j,k}\delta_{\vec{c},\vec{d}}\delta_{\vec{a},\vec{b}}\begin{cases}
\langle\vec{x}|U_{\mathcal{C}_X}^{\dagger}(a_{1})|0\rangle\langle0|_{2}U_{\mathcal{C}_X}(a_{1})|\vec{z}\rangle\frac{1}{64} & j\geq j_{\max}\text{ and }d_{2}=1\\
0 & \text{otherwise}.
\end{cases}\label{eq:hout_matels-1}
\end{equation}
\end{mdframed}

\subsection{Frustration-Free states}

Define the $(n-2)$-dimensional hypercubes
\begin{equation}
\mathcal{D}_{k}^{j}=\left\{ (d_{1},\ldots,d_{n})\colon d_{1}=d_{s(j)}=k,\, d_{i}\in\{0,1\}\text{ for }i\in[n]\setminus\{1,s(j)\}\right\} 
\end{equation}
for $j\in\{1,\ldots,M\}$ and $k\in\{0,1,2\}$, and the superpositions
\begin{equation}
|{\Cube_{k}(j,\vec{z},\vec{a})}\rangle=\frac{1}{\sqrt{2^{n-2}}}\sum_{\vec{d}\in\mathcal{D}_{k}^{j}}\left(-1\right)^{\sum_{i=1}^{n}d_{i}}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle
\end{equation}
for $k\in\{0,1,2\}$, $j\in[M]$, and $\vec{z},\vec{a}\in\{0,1\}^{n}.$
For each $j\in[M]$ and $\vec{z},\vec{a}\in\{0,1\}^{n}$, let
\begin{equation}
|C(j,\vec{z},\vec{a})\rangle=\frac{1}{2}|{\Cube_{0}(j,\vec{z},\vec{a})}\rangle+\frac{1}{2}|{\Cube_{1}(j,\vec{z},\vec{a})}\rangle-\frac{1}{\sqrt{2}}|{\Cube_{2}(j,\vec{z},\vec{a})}\rangle.\label{eq:cubestates-1}
\end{equation}
We prove

\begin{lemma}
\label{lem:beta_bound}The Hamiltonian $H(G_{2},G_Xoc,n)$ has nullspace $S_2$ spanned by the states
\begin{equation}
|C(j,\vec{z},\vec{a})\rangle
\end{equation}
for $j\in[M]$ and $\vec{z},\vec{a}\in\{0,1\}^{n}$. Its smallest nonzero eigenvalue is 
\begin{equation}
  \gamma(H(G_{2},G_Xoc,n)) \geq \frac{\mathcal{K}_0}{35000n}
\end{equation}
where $\mathcal{K}_0\in (0,1]$ is the absolute constant from \lem{gs_g_alpha}.
\end{lemma}

\begin{proof}
Recall from the previous section that $H_{1}|_{S_1}$ is block diagonal in the basis \eq{phi_init_basis}, with a block for each $j\in[M]$ and $\vec{z},\vec{a}\in\{0,1\}^{n}$. That is to say, $\langle k,\vec{c},\In(\vec{x}),\vec{b}|H_{1}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle$ is zero unless $\vec{a}=\vec{b}$, $k=j$, and $\vec{z}=\vec{x}$. Equation \eq{H1_goodbasis-1} gives the nonzero matrix elements within a given block, which we use to compute the frustration-free ground states of $H_{1}|_{S_{1}}$.

Looking at equation \eq{H1_goodbasis-1}, we see that the matrix for each block can be written as a sum of $n$ commuting matrices: $\frac{n-1}{64}$ times the identity matrix (case 1 in equation \eq{H1_goodbasis-1}), $n-2$ terms that each flip a single bit $i\notin\{1,s(j)\}$ of $\vec{d}$ (case 2), and a term that changes the value of the ``special'' components $d_{1}=d_{s(j)}\in\{0,1,2\}$ (case 3). Thus
\begin{equation}
\langle j,\vec{c},\In(\vec{z}),\vec{a}|H_{1}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle=\langle j,\vec{c},\In(\vec{z}),\vec{a}|\frac{1}{64}(n-1)+\frac{1}{64}\sum_{i\in[n]\setminus\{1,s(j)\}}H_{\mathrm{flip},i}+\frac{1}{64}H_{\mathrm{special},j}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle
\end{equation}
where
\begin{align}
\langle j,\vec{c},\In(\vec{z}),\vec{a}|H_{\mathrm{flip},i}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle &= \delta_{c_{i},d_{i}\oplus1} \prod_{r\in[n]\setminus\{i\}}\delta_{c_{r},d_{r}}
\end{align}
and 
\begin{equation}
\langle j,\vec{c},\In(\vec{z}),\vec{a}|H_{\mathrm{special},j}|j,\vec{d},\In(\vec{z}),\vec{a}\rangle=\begin{cases}
\frac{1}{\sqrt{2}} & \begin{aligned}
  &(c_{1},d_{1})\in\{(2,0),(0,2),(1,2),(2,1)\}\\ 
  &\text{and}\; d_{r}=c_{r}\;\text{for}\; r\in [n]\setminus\{1,s(j)\}
\end{aligned}\\
0 & \text{otherwise.}
\end{cases}
\end{equation}
Note that these $n$ matrices are mutually commuting, each eigenvalue of $H_{\mathrm{flip},i}$ is $\pm1$, and each eigenvalue of $H_{\mathrm{special},j}$ is equal to one of the eigenvalues of the matrix 
\begin{equation}
\frac{1}{\sqrt{2}}\begin{pmatrix}
0 & 0 & 1\\
0 & 0 & 1\\
1 & 1 & 0
\end{pmatrix},
\end{equation}
which are $\{-1,0,1\}$. Thus we see that the eigenvalues of $H_1|_{S_{1}}$ within a block for some $j\in [M]$ and $\vec{z},\vec{a}\in\{0,1\}^{n}$ are
\begin{equation}
  \frac{1}{64}\bigg(n-1+\sum_{i\notin\{1,s(j)\}}y_{i}+w\bigg)
  \label{eq:block_eig}
\end{equation}
where $y_{i}\in\pm1$ for each $i\in[n]\setminus\{1,s(j)\}$ and $w\in\{-1,0,1\}$. In particular, the smallest eigenvalue within the block is zero (corresponding to $y_i=w=-1$). The corresponding eigenspace is spanned by the simultaneous $-1$ eigenvectors of each $H_{\mathrm{flip},i}$ for $i\in [n]\setminus \{1,s(j)\}$ and $H_{\mathrm{special},j}$. The space of simultaneous $-1$ eigenvectors of $H_{\mathrm{flip},i}$ for $i\in [n]\setminus\{1,s(j)\}$ within the block is spanned by $\{|{\Cube_{0}(j,\vec{z},\vec{a})}\rangle, |{\Cube_{1}(j,\vec{z},\vec{a})}\rangle, |{\Cube_{2}(j,\vec{z},\vec{a})}\rangle\}$. The state $|C(j,\vec{z},\vec{a})\rangle$  is the unique superposition of these states that is a $-1$ eigenvector of $H_{\mathrm{special},j}$. Hence, for each block we obtain a unique state $|C(j,\vec{z},\vec{a})\rangle$ in the space $S_2$. Ranging over all blocks $j\in [M]$ and $\vec{z},\vec{a}\in \{0,1\}^n$, we get the basis described in the Lemma.

The smallest nonzero eigenvalue within each block is $\frac{1}{64}$ (corresponding to $y_{i}=-1$ and $w=0$ in equation \eq{block_eig}), so 
\begin{equation}
\gamma(H_{1}|_{S_{1}})=\frac{1}{64}.\label{eq:lowerbnd_H1S_alph}
\end{equation}

To get the stated lower bound, we use \lem{npl} with $H(G_{2},G_Xoc,n) = H_{A}+H_{B}$ where 
\begin{equation}
H_{A}=H(G_{1},G_Xoc,n)\qquad H_{B}=H_{1}|_{\mathcal{I}(G_{2},G_Xoc,n)}
\end{equation}
(as in equation \eq{H_G2}), along with the bounds 
\begin{equation}
\gamma(H_{A}) \geq \frac{\mathcal{K}_0}{256}\qquad\gamma(H_{B}|_{S_{1}})=\gamma(H_{1}|_{S_{1}})=\frac{1}{64}\qquad\left\Vert H_{B}\right\Vert \leq\left\Vert H_{1}\right\Vert \leq n\left\Vert h_{1}\right\Vert =2n
\end{equation}
from \lem{H_Galpha_Gtilde}, equations \eq{H1_restriction} and \eq{lowerbnd_H1S_alph}, and the fact that $\left\Vert h_{1}\right\Vert =2$ from \eq{h_E_bound}. This gives
\begin{equation}
  \gamma(H(G_2,G_Xoc,n))
  \geq \frac{\mathcal{K}_0}{64\mathcal{K}_0+256+2n\cdot64\cdot256}
  \geq \frac{\mathcal{K}_0}{35000n}
\end{equation}
where we used the facts that $\mathcal{K}_0\leq 1$ and $n \ge 1$.
\end{proof}
For each $\vec{z},\vec{a}\in\{0,1\}^{n}$ define the uniform superposition
\begin{equation}
  |\mathcal{H}(\vec{z},\vec{a})\rangle
  =\frac{1}{\sqrt{M}}\sum_{j=1}^{M}|C\left(j,\vec{z},\vec{a}\right)\rangle.
\end{equation}
that encodes (somewhat elaborately) the history of the computation that consists of applying either $U_{\mathcal{C}_X}$ or $U_{\mathcal{C}_X}^{*}$ to the state $|\vec{z}\rangle$. The first bit of $\vec{a}$ determines whether the circuit $\mathcal{C}_{X}$ or its complex conjugate is applied. 

\begin{lemma}
\label{lem:HG3}
The Hamiltonian $H(G_{3},G_Xoc,n)$ has nullspace $S_3$ spanned by the states
\begin{equation}
  |\mathcal{H}(\vec{z},\vec{a})\rangle
\end{equation}
for $\vec{z},\vec{a}\in\{0,1\}^{n}$. Its smallest nonzero eigenvalue is 
\begin{equation}
  \gamma(H(G_{3},G_Xoc,n)) \geq \frac{\mathcal{K}_0}{10^7 n^{2}M^{2}}
\end{equation}
where $\mathcal{K}_0\in (0,1]$ is the absolute constant from \lem{gs_g_alpha}.
\end{lemma}

\begin{proof}
Recall that
\begin{equation}
H(G_{3},G_Xoc,n)=H(G_{2},G_Xoc,n)+H_{2}|_{\mathcal{I}(G_{3},G_Xoc,n)}
\end{equation}
with both terms on the right-hand side positive semidefinite. To solve for the nullspace of $H(G_{3},G_Xoc,n)$, it suffices to restrict our attention to the space
\begin{equation}
  S_{2}=\spn\{ |C(j,\vec{z},\vec{a})\rangle\colon
    j\in[M],\;\vec{z},\vec{a}\in\{0,1\}^{n}\}
  \label{eq:S_beta_basis}
\end{equation}
of states in the nullspace of $H(G_{2},G_Xoc,n)$. We begin by computing the matrix elements of $H_{2}$ in the basis for $S_{2}$ given above. We use equations \eq{H2_formula_with_f} and \eq{cubestates-1} to compute the diagonal matrix elements: 
\begin{align}
\langle C\left(j,\vec{z},\vec{a}\right)|H_{2}|C\left(j,\vec{z},\vec{a}\right)\rangle= & \frac{1}{4}\langle{\Cube_{0}(j,\vec{z},\vec{a})}|H_{2}|{\Cube_{0}(j,\vec{z},\vec{a})}\rangle+\frac{1}{4}\langle{\Cube_{1}(j,\vec{z},\vec{a})}\rangle|H_{2}|{\Cube_{1}(j,\vec{z},\vec{a})}\rangle\\
 & +\frac{1}{2}\langle{\Cube_{2}(j,\vec{z},\vec{a})}|H_{2}|{\Cube_{2}(j,\vec{z},\vec{a})}\rangle\\
= & \begin{cases}
0+\frac{1}{256}+\frac{1}{256} & j=1\\
\frac{1}{256}+\frac{1}{256}+\frac{1}{128} & j\in\{2,\ldots,M-1\}\\
\frac{1}{256}+0+\frac{1}{256} & j=M
\end{cases}\\
= & \begin{cases}
\frac{1}{128} & j\in\{1,M\} \\
\frac{1}{64} & j\in\{2,\ldots,M-1\}.
\end{cases}\label{eq:diag_C_mat_els}
\end{align}
In the second line we used equation \eq{H2_diag_goodbasis-1}. Looking at equation \eq{H2_formula_with_f}, we see that the only nonzero off-diagonal matrix elements of $H_{2}$ in this basis are of the form 
\begin{equation}
\langle C(j-1,\vec{z},\vec{a})|H_{2}|C(j,\vec{z},\vec{a})\rangle\quad
\text{or}\quad\langle C(j,\vec{z},\vec{a})|H_{2}|C(j-1,\vec{z},\vec{a})\rangle
=\langle C(j-1,\vec{z},\vec{a})|H_{2}|C(j,\vec{z},\vec{a})\rangle^{*}
\end{equation}
for $j\in\{2,\ldots,M\}$, $\vec{z},\vec{a}\in\{0,1\}^{n}$. To compute these matrix elements we first use equation \eq{H2_offdiag_goodbasis-1} to evaluate 
\begin{equation}
\langle{\Cube_{w}(j-1,\vec{z},\vec{a})}|H_{2}|{\Cube_{v}(j,\vec{z},\vec{a})}\rangle
\end{equation}
for $v,w\in\{0,1,2\}$ and $j\in\{2,\ldots,M\}$. For example, using the second case of equation \eq{H2_offdiag_goodbasis-1}, we get
\begin{align}
\langle{\Cube_{1}\left(j-1,\vec{z},\vec{a}\right)}|H_{2}|{\Cube_{0}\left(j,\vec{z},\vec{a}\right)}\rangle & = 
 \frac{1}{2^{n-2}}\sum_{\vec{d}\in\mathcal{D}_{0}^{j}}\; \sum_{\vec{c}\in\mathcal{D}_{1}^{j-1}} \!\!(-1)^{\sum_{i\in[n]} (c_i +d_i)}\langle j-1,\vec{c},\text{In}(\vec{z}),\vec{a}|H_2|j,\vec{d},\text{In}(\vec{z}),\vec{a}\rangle \\
& = \frac{1}{2^{n-2}}\sum_{\vec{d}\in\mathcal{D}_{0}^{j}:d_{s(j-1)}=1}\!\!(-1)\cdot\frac{1}{64}=-\frac{1}{128}.
\end{align}
To go from the first to the second line we used the fact that, for each $\vec{d}\in\mathcal{D}_{0}^{j}$ with $d_{s(j-1)}=1$, there is one $\vec{c}\in\mathcal{D}_{1}^{j-1}$ for which $\langle j-1,\vec{c},\text{In}(\vec{z}),\vec{a}|H_2|j,\vec{d},\text{In}(\vec{z}),\vec{a}\rangle=\frac{1}{64}$ (with all other such matrix elements equal to zero). This $\vec{c}$ satisfies $c_1=c_{s(j-1)}=1$ and $c_{s(j)}=0$, with all other bits equal to those of $\vec{d}$, so 
\begin{equation}
(-1)^{\sum_{i=1}^{n}\left(c_{i}+d_{i}\right)}=(-1)^{c_{1}+c_{s(j)}+c_{s(j-1)}+d_{1}+d_{s(j)}+d_{s(j-1)}}=-1
\end{equation}
for each nonzero term in the sum.

We perform a similar calculation using cases 1, 3, and 4 in equation \eq{H2_offdiag_goodbasis-1} to obtain
\begin{equation}
\langle{\Cube_{w}(j-1,\vec{z},\vec{a})}|H_{2}|{\Cube_{v}(j,\vec{z},\vec{a})}\rangle=\begin{cases}
-\frac{1}{128} & (w,v)=(1,0)\\
\frac{1}{128\sqrt{2}} & (w,v)\in\{(2,0),(1,2)\}\\
-\frac{1}{256} & (w,v)=(2,2)\\
0 & \text{otherwise.}
\end{cases}
\end{equation}
Hence 
\begin{align}
 & \langle C\left(j-1,\vec{z},\vec{a}\right)|H_{2}|C\left(j,\vec{z},\vec{a}\right)\rangle\\
 &\quad =\frac{1}{4}\langle{\Cube_{1}\left(j-1,\vec{z},\vec{a}\right)}|H_{2}|{\Cube_{0}\left(j,\vec{z},\vec{a}\right)}\rangle-\frac{1}{2\sqrt{2}}\langle{\Cube_{2}\left(j-1,\vec{z},\vec{a}\right)}|H_{2}|{\Cube_{0}\left(j,\vec{z},\vec{a}\right)}\rangle\\
 &\qquad +\frac{1}{2}\langle{\Cube_{2}\left(j-1,\vec{z},\vec{a}\right)}|H_{2}|{\Cube_{2}\left(j,\vec{z},\vec{a}\right)}\rangle-\frac{1}{2\sqrt{2}}\langle{\Cube_{1}\left(j-1,\vec{z},\vec{a}\right)}|H_{2}|{\Cube_{2}\left(j,\vec{z},\vec{a}\right)}\rangle\\
 &\quad =-\frac{1}{128}.
\end{align}
Combining this with equation \eq{diag_C_mat_els}, we see that $H_{2}|_{S_{2}}$ is block diagonal in the basis \eq{S_beta_basis}, with a block for each pair of $n$-bit strings $\vec{z},\vec{a}\in\{0,1\}^{n}$. Each of the $2^{2n}$ blocks is equal to the $M\times M$ matrix
\begin{equation}
  \frac{1}{128}
  \begin{pmatrix}
    1 & -1 & 0 & 0 & \cdots & 0  \\
    -1 & 2 & -1 & 0 & \cdots & 0  \\
    0 & -1 & 2 & -1 & \ddots & \vdots \\
    0 & 0 & -1 & \ddots & \ddots & 0 \\
    \vdots & \vdots & \ddots & \ddots & 2 & -1 \\
    0 & 0 & \cdots & 0 & -1 & 1  
  \end{pmatrix}.
\end{equation}
This matrix is just $\frac{1}{128}$ times the Laplacian of a path of length $M$, whose spectrum is well known. In particular, it has a unique eigenvector with eigenvalue zero (the all-ones vector) and its eigenvalue gap is $2(1-\cos (\frac{\pi}{M}))\geq \frac{4}{M^2}$. Thus for each of the $2^{2n}$ blocks there is an eigenvector of $H_{2}|_{S_{2}}$ with eigenvalue $0$, equal to the uniform superposition $|\mathcal{H}(\vec{z},\vec{a})\rangle$ over the $M$ states in the block. Furthermore, the smallest nonzero eigenvalue within each block is at least $\frac{1}{32M^{2}}$. Hence
\begin{equation}
  \gamma(H_{2}|_{S_{2}}) \geq \frac{1}{32M^{2}}.\label{eq:gamma_HB}
\end{equation}
To get the stated lower bound on $\gamma(H(G_{3},G_Xoc,n))$, we apply \lem{npl} with 
\begin{align}
  H_{A} &= H(G_{2},G_Xoc,n) \qquad H_{B}=H_{2}|_{\mathcal{I}(G_{3},G_Xoc,n)}
\end{align}
and 
\begin{equation}
  \gamma(H_{A}) \geq \frac{\mathcal{K}_0}{35000 n} \qquad
  \gamma(H_{B}|_{S_{2}}) = \gamma(H_{2}|_{S_{2}}) 
  \geq \frac{1}{32 M^{2}} \qquad
  \|H_{B}\| \leq \|H_{2}\| \leq n \|h_{2}\| = 2n
\label{eq:gamma_HA}
\end{equation}
from \lem{beta_bound}, equation \eq{gamma_HB}, and the fact that $\left\Vert h_{2}\right\Vert =2$ from \eq{h_E_bound}. This gives 
\begin{align}
  \gamma(H(G_3,G_Xoc,n)) 
  &\geq \frac{\mathcal{K}_0}{32M^2\mathcal{K}_0+35000n +2n(35000n)(32M^2)} \\
  &\geq \frac{\mathcal{K}_0}{M^2 n^2(32+35000+70000\cdot32)}
   \geq \frac{\mathcal{K}_0}{10^7 M^2 n^2}. \qedhere
\end{align}
\end{proof}

\begin{lemma}
\label{lem:G_IV}The nullspace $S_4$ of $H(G_{4},G_Xoc,n)$ is spanned by
the states 
\begin{equation}
|\mathcal{H}\left(\vec{z},\vec{a}\right)\rangle\quad\text{where}\quad\vec{z}=z_{1}z_{2}\ldots z_{n_{\text{in}}}\underbrace{00\ldots0}_{n-n_{\text{in}}}\label{eq:history_states_zero_init}
\end{equation}
for $\vec{a}\in\{0,1\}^{n}$ and $z_{1},\ldots,z_{n_{\text{in}}}\in\{0,1\}$.
Its smallest nonzero eigenvalue satisfies
\begin{equation}
\gamma(H(G_{4},G_Xoc,n)) \geq \frac{\mathcal{K}_0}{10^{10} M^3n^3}
\end{equation}
where $\mathcal{K}_0\in (0,1]$ is the absolute constant from \lem{gs_g_alpha}.
\end{lemma}

\begin{proof}
Using equation \eq{Hin_mat_els}, we find
\begin{align}
\langle C(k,\vec{x},\vec{b})|H_{\text{in},i}|C(j,\vec{z},\vec{a})\rangle
&=\delta_{k,j} \delta_{\vec{x},\vec{z}}\delta_{\vec{a},\vec{b}}\bigg(\frac{1}{4}\langle {\Cube_0(j,\vec{z},\vec{a})}|H_{\text{in},i}|{\Cube_0(j,\vec{z},\vec{a})}\rangle\\
&\quad+\frac{1}{4}\langle {\Cube_1(j,\vec{z},\vec{a})}|H_{\text{in},i}| {\Cube_1(j,\vec{z},\vec{a})}\rangle \\
&\quad+\frac{1}{2}\langle {\Cube_2(j,\vec{z},\vec{a})}|H_{\text{in},i}| {\Cube_2(j,\vec{z},\vec{a})}\rangle\bigg)\\
&=\delta_{k,j} \delta_{\vec{x},\vec{z}}\delta_{\vec{a},\vec{b}}\left(\frac{1}{64}\delta_{z_i,1}\right)\begin{cases}
\frac{1}{4}\cdot\frac{1}{2}+\frac{1}{4}\cdot\frac{1}{2}+\frac{1}{2}\cdot\frac{1}{2} & j<j_{\min,i}\\
\frac{1}{4}+0+0 & j=j_{\min,i}\\
0+0+0 & j>j_{\min,i}
\end{cases}
\end{align}
for each $i\in\{n_{\text{in}}+1,\ldots,n\}$. Hence 
\begin{equation}
\langle\mathcal{H}(\vec{x},\vec{b})|\sum_{i=n_{\text{in}}+1}^{n}H_{\text{in},i}|\mathcal{H}(\vec{z},\vec{a})\rangle=\frac{1}{M}\delta_{\vec{x},\vec{z}}\delta_{\vec{a},\vec{b}}\sum_{i=n_{\text{in}}+1}^{n}\frac{1}{64}\left(\frac{j_{\min,i}-1}{2}+\frac{1}{4}\right)\delta_{z_{i},1}.
\end{equation}
Therefore
\begin{equation}
\sum_{i=n_{\text{in}}+1}^{n}H_{\text{in},i}\big|_{S_{3}}
\end{equation}
is diagonal in the basis $\{|\mathcal{H}(\vec{z},\vec{a})\rangle\colon\vec{z},\vec{a}\in\{0,1\}^{n}\}$. The zero eigenvectors are given by equation \eq{history_states_zero_init}, and the smallest nonzero eigenvalue is
\begin{equation}
\gamma\left(\sum_{i=n_{\text{in}}+1}^{n}H_{\text{in},i}\big|_{S_{3}}\right)\geq\frac{1}{256M}.\label{eq:lbnd_Hinj}
\end{equation}
since $j_{\min,i}\geq1$. To get the stated lower bound we now apply \lem{npl} with 
\begin{align}
H_{A} & =H(G_{3},G_Xoc,n)\qquad H_{B}=\sum_{i=n_{\text{in}}+1}^{n}H_{\text{in},i}\big|_{\mathcal{I}(G_{4},G_Xoc,n)}
\end{align}
and
\begin{equation}
  \gamma(H_{A}) \geq \frac{\mathcal{K}_0}{10^7 M^{2}n^{2}} \qquad
  \gamma(H_{B}|_{S_{3}})\geq\frac{1}{256M} \qquad 
  \left\Vert H_{B}\right\Vert 
    \leq n\left\Vert \sum_{i=n_{\text{in}}+1}^{n}h_{\text{in},i}\right\Vert = n
\end{equation}
where we used \lem{HG3}, equation \eq{lbnd_Hinj}, and the fact that $\left\Vert \sum_{i=n_{\text{in}}+1}^{n}h_{\text{in},i}\right\Vert =1$ (from equation \eq{h_S_bound}. This gives
\begin{align}
\gamma \left(H(G_4,G_Xoc,n)\right)
&\geq \frac{\mathcal{K}_0}{256M\mathcal{K}_0+10^7n^2M^2+n(256M)(10^7n^2M^2)} \\
&\geq \frac{\mathcal{K}_0}{(M^3n^3)(256+10^7+256\cdot 10^7)}
 \geq \frac{\mathcal{K}_0}{10^{10} M^3n^3}. \qedhere
\end{align}
\end{proof}






\subsection{Completeness and Soundness}

Well fuck.


\section{Discussion and open problems}

While these results generalized the problem of the Bose-Hubbard model to arbitrary interactions between bosons, it leaves open the related question of fermions.  I would expect that our proof would naturally extend to fermions as well, but the extensions where too extensive to finish in time for this thesis.

Making the eventual graph regular.

Remove the restriction to fixed particle number.  Currently, this corresponds to 

\biblio

\end{document}