\begin{tikzpicture}[yscale=1]
%\path[use as bounding box](-5.5,-3) rectangle (10,10.5); 


% Connections between the i/o unitaries and the identity separators
\foreach \xshift / \xscale in {-3.5/ 1, 5/-1}{
\foreach \yshift in {2.7, -1.7}{
\begin{scope}[shift = {(\xshift, \yshift)},xscale = \xscale]
  \draw[black, looseness = 1] (0,2.34) to [out=0, in = 180] (1,   3.75);
  \draw[black, looseness=1]   (0,2.13) to [out = 0, in = 180] (1, 2.65);
  \draw[black, looseness= 1]  (0,1.72) to [out = 0, in = 180] (1, 1.55);
  \draw[black, looseness = 1] (0,1.51) to [out = 0, in = 180] (1, 0.45);
\end{scope}
}}

% Left Connections between W and identity seperators
\foreach \l        /\r in {
	      6.45  /5.93,
	      5.35  /3.73,
	      4.25  /1.53,
	      3.15  /-0.67,
	      2.05  /5.51,
	      0.95  /1.11,
	      -0.15  /3.31,
	      -1.25  /-1.09
              } 
{   
 \draw[looseness=.66,line width=4pt,color=white] (-1.5,\l) to [out=0,in=180] (0,\r);
 \draw[looseness=.66] (-1.5,\l) to [out=0,in=180] (0,\r); 
}


% Right Connections between W and identity seperators
\foreach \l        /\r in {
              5.93  /6.45,
              5.51  /2.05,
              3.73  /5.35,
              3.31  /-0.15,
              1.53  /4.25,
              1.11  /-1.25,     
              -0.67/3.15,
              -1.09/0.95
              } 
{   
 \draw[looseness=.66,line width=4pt,color=white] (1.5,\l) to [out=0,in=180] (3,\r);
 \draw[looseness=.66] (1.5,\l) to [out=0,in=180] (3,\r); 
}


%  Edges between identity and preventing two-particle states

\draw[color = black]   (-2 cm, -3.4875 cm)  to[out = 180,in=0] (-3 cm, -3.65);
\draw[color = black] (-2 cm, -2.8625 cm)  to[out = 180,in=0] (-3 cm, -2.55);

\draw[color = black]   (3.5 cm, -3.4875 cm)  to[out = 0,in=180] (4.5 cm, -3.65);
\draw[color = black]   (3.5 cm, -2.8625 cm)  to[out = 0,in=180] (4.5 cm, -2.55);

\draw[color = black]  (-3cm, 8.85cm) to[out=0, in=180] (-2cm, 9.4375 cm);
\draw[color = black]  (4.5cm, 8.85cm) to[out=180, in=0] (3.5cm, 9.4375 cm);

\draw[color = black]  (-3cm, 7.75cm) to[out=0,in=180] (-0.5cm, 7.75cm) to[out=0, in=180] (2cm, 8.8125 cm);
\draw[color = white, line width=4pt]  (4.5cm, 7.75cm)  to[out=180, in=0] (2cm, 7.75cm) to[out=180, in=0](-0.5cm, 8.8125 cm);
\draw[color = black]  (4.5cm, 7.75cm)  to[out=180, in=0] (2cm, 7.75cm) to[out=180, in=0](-0.5cm, 8.8125 cm);

\draw[color = black] (-5cm , 4.83 cm) to[out=180, in=180] (-4cm, 8.85cm);
\draw[color = white, line width=4pt] (-5cm , 4.21 cm) to[out=180, in=180] (-4cm, 7.75cm);
\draw[color = black] (-5cm , 4.21 cm) to[out=180, in=180] (-4cm, 7.75cm);

\draw[color = black] (6.5cm , 4.83 cm) to[out=0, in=0] (5.5cm, 8.85cm);
\draw[color = white, line width=4pt] (6.5cm , 4.21 cm) to[out=0, in=0] (5.5cm, 7.75cm);
\draw[color = black] (6.5cm , 4.21 cm) to[out=0, in=0] (5.5cm, 7.75cm);

\draw[color = black] (-5cm , 0.43 cm) to[out=180, in=180] (-4cm, -2.55cm);
\draw[color = white, line width=4pt] (-5cm , -0.19 cm) to[out=180, in=180] (-4cm, -3.65cm);
\draw[color = black] (-5cm , -0.19 cm) to[out=180, in=180] (-4cm, -3.65cm);

\draw[color = black] (6.5cm , 0.43 cm) to[out=0, in=0] (5.5cm, -2.55cm);
\draw[color = white, line width=4pt] (6.5cm , -0.19 cm) to[out=0, in=0] (5.5cm, -3.65cm);
\draw[color = black] (6.5cm , -0.19 cm) to[out=0, in=0] (5.5cm, -3.65cm);



%  The four Unitaries used for input/output 
\foreach \xshift / \yshift /\xscale / \lab / \unitary in 
  {5  /-.4   /1  /4  /1,
   5  /4   /1  /2  /1,
  -5  /-.4   /1  /3  /1,
  -5 /4   /1  /1  /\tilde U
}
{ 
\begin{scope}[shift={(\xshift,\yshift)},xscale=\xscale]
  \draw[rounded corners=0.75mm,thick] (0,0) rectangle (1.5 cm, 1.25cm);
  \node at (.75,.625) {\huge$\unitary$};   
  \node at (.75,1.5) {\large\lab};
  \foreach \y in {.21,.42,.83,1.04}
	{   
		\foreach \x /\color in {0/black,1.5/gray}
			{    
				\draw[fill=\color,draw=\color] (\x cm, \y cm) circle (.66mm);  
			}
	} 
\end{scope}
}


% Identity elements splitting the four i/o unitaries from the W-gadgets

\setcounter{mycount}{9}
\foreach \xshift in { -2.5,  3}
{
\foreach \yshift in {6,4.9,3.8,...,-2}{

\begin{scope}[shift = {(\xshift,\yshift)}]
  \draw[rounded corners = 0.75mm,thick] (0,0) rectangle (1 cm, .6cm);
  \node at (.5cm , .3 cm) {$1$};
  \node at (.5cm , .8 cm) {$\arabic{mycount}$};
  \stepcounter{mycount}
  \draw[fill = black, draw=black] (0 cm, .15 cm) circle (.66mm);
  \draw[fill = black, draw=black] (0 cm, .45 cm) circle (.66mm);
  \draw[fill = gray,  draw =gray ] (1 cm, .45 cm) circle (.66mm);  
  
  % Self-loops on the second input node
  \draw[looseness=50,draw = black] (0cm, .14 cm) to [out = 210, in = 150] (0cm, .16cm);
\end{scope}
}}

% Identity operators preventing two-particle states

\draw[rounded corners=0.75mm,thick] (-2,8.5) rectangle (-0.5 cm, 9.75cm);
\node at (-1.25,9.125) {\huge$1$};   
\node at (-1.25,10) {\large$5$};
\draw[fill = black, draw = black] (-2 cm, 9.4375 cm) circle (.66mm);
\draw[fill = gray, draw = gray]    (-.5cm, 8.8125 cm) circle (.66mm);

\draw[rounded corners=0.75mm,thick] (2,8.5) rectangle (3.5 cm, 9.75cm);
\node at (2.75,9.125) {\huge$1$};   
\node at (2.75,10) {\large$6$};
\draw[fill = gray, draw = gray] (3.5 cm, 9.4375 cm) circle (.66mm);
\draw[fill = black, draw = black]    (2cm, 8.8125 cm) circle (.66mm);


% Identity operators preventing two-particle state scaling

\draw[rounded corners=0.75mm,thick] (-2,-3.8) rectangle (-0.5 cm, -2.55cm);
\node at (-1.25,-3.125) {\huge$1$};   
\node at (-1.25,-2.3) {\large$7$};
\draw[fill = black, draw = black] (-2 cm, -3.4875 cm) circle (.66mm);
\draw[fill = black, draw = black] (-2 cm, -2.8625 cm) circle (.66mm);

\draw[rounded corners=0.75mm,thick] (2,-3.8) rectangle (3.5 cm, -2.55cm);
\node at (2.75,-3.125) {\huge$1$};   
\node at (2.75,-2.3) {\large$8$};
\draw[fill = black, draw = black] (3.5 cm, -3.4875 cm) circle (.66mm);
\draw[fill = black, draw = black] (3.5 cm, -2.8625 cm) circle (.66mm);m);


% Identity elements separating  identity preventing unwanted two-particle states
\foreach \xshift in { -4,  4.5}
{
\foreach \yshift in {8.4,7.3,-3, -4.1}{

\begin{scope}[shift = {(\xshift,\yshift)}]
  \draw[rounded corners = 0.75mm,thick] (0,0) rectangle (1 cm, .6cm);
  \node at (.5cm , .3 cm) {$1$};
  \node at (.5cm , .8 cm) {$\arabic{mycount}$};
  \stepcounter{mycount}
  \draw[fill = black, draw=black] (0 cm, .15 cm) circle (.66mm);
  \draw[fill = black, draw=black] (0 cm, .45 cm) circle (.66mm);
  \draw[fill = gray,  draw =gray ] (1 cm, .45 cm) circle (.66mm);  
  
  % Self-loops on the second input node
  \draw[looseness=50,color = black] (0cm, .14 cm) to [out = 210, in = 150] (0cm, .16cm);
\end{scope}
}}




  % Each W Gadget
\foreach \yshift/\from in {-1.35/11,0.85 /10,3.05/01,5.25/00}
{ 
\begin{scope}[yshift=\yshift cm] 
 \draw[rounded corners=0.75mm,thick] (0,0) rectangle (1.5cm,.93cm); 
 \node at (.75,.465) {$W$};   
\node at (.75,1.2) {$\from$};
  \foreach \x/\color in {0/black,1.5/gray}
	{   
		\foreach \y in {0.26,.67}
		{   
			 \draw[fill=\color,draw=\color] (\x,\y) circle (.66mm); 
		 }
	}
\end{scope}
}

\node at (-5.25, 5.1) {\small$\alpha$};
\node at (-5.25, 4.5) {\small$\beta$};

\node at (-5.25, 0.6) {\small$\gamma$};
\node at (-5.25, 0)   {\small$\delta$};


\node at (6.75, 5.1) {\small$\epsilon$};
\node at (6.75, 4.5) {\small$\zeta$};

\node at (6.75, 0.6) {\small$\eta$};
\node at (6.75, 0)   {\small$\theta$};

\end{tikzpicture}
\label{fig:GVucnot_complete}